package com.walgreens.batch.query;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

public class EmailReportQuery {

	private static final Logger logger = LoggerFactory
			.getLogger(EmailReportQuery.class);

	public static String getReport1AggregateOrderPlaced() {

		logger.info(" Start execution getReport1AggregateOrderPlaced() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append("WITH ");
		query.append("YESTERDAY_TMP AS (");
		query.append(" select ORDER_ORIGIN_TYPE,sum(FINAL_PRICE) \"Yesterday\",0 \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from OM_ORDER where ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE ),");
		query.append(" LAST_YR_SAME_DAY_TMP AS (");
		query.append(" select ORDER_ORIGIN_TYPE,0 \"Yesterday\",sum(FINAL_PRICE) \"LstYrSmDay\",0 \"LstYrSmDate\"");
		query.append(" from OM_ORDER where ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE ),");
		query.append(" LAST_YR_SAME_DATE_TMP AS (");
		query.append(" select ORDER_ORIGIN_TYPE,0 \"Yesterday\",0 \"LstYrSmDay\",sum(FINAL_PRICE) \"LstYrSmDate\"");
		query.append(" from OM_ORDER where ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE ),");
		query.append(" ALL_DAYS_TMP AS ( select * from YESTERDAY_TMP union select * from LAST_YR_SAME_DAY_TMP union select * from LAST_YR_SAME_DATE_TMP ),");
		query.append(" CHANNEL_BREAKUP_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\",");
		query.append(" CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\"");
		query.append(" from (  select ORDER_ORIGIN_TYPE,sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\",");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\",");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\",");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\"");
		query.append(" from ALL_DAYS_TMP group by ORDER_ORIGIN_TYPE ) order by \"SORTORDER2\" ),");
		query.append(" TOTAL_AGGR_TMP AS (  select 'TOTAL' \"ORDER_ORIGIN_TYPE\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\",");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\",");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\",");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\",");
		query.append(" 0 \"SORTORDER2\" from CHANNEL_BREAKUP_TMP order by \"SORTORDER2\",ORDER_ORIGIN_TYPE  ),");
		query.append(" ALL_DISPLAY_TMP AS (    select * from TOTAL_AGGR_TMP union select * from CHANNEL_BREAKUP_TMP  )");
		query.append(" select ORDER_ORIGIN_TYPE,ROUND(\"Yesterday\",2) as \"Yesterday\",ROUND(\"LstYrSmDay\",2) as \"LstYrSmDay\",ROUND(\"LstYrSmDate\",2) as \"LstYrSmDate\",ROUND(\"SameDayYOY%\",2) as \"SameDayYOY%\",ROUND(\"SameDateYOY%\",2) as \"SameDateYOY%\",\"SORTORDER2\" from ALL_DISPLAY_TMP order by \"SORTORDER2\"");
		logger.info(" Finish execution getReport1AggregateOrderPlaced() method in EmailReportQuery.class ");
		return query.toString();
	}

	public static String getReport1AggregateOrderSold() {
		logger.info(" Start execution getReport1AggregateOrderSold() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" WITH YESTERDAY_TMP AS ( select ORDER_ORIGIN_TYPE,sum(SOLD_AMOUNT) \"Yesterday\",0 \"LstYrSmDay\",0 \"LstYrSmDate\"");
		query.append(" from OM_ORDER where ORDER_SOLD_DTTM >= TO_DATE(? ,'DD-MON-YYYY') and ORDER_SOLD_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY')-195 and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM')");
		query.append(" group by ORDER_ORIGIN_TYPE ),");
		query.append(" LAST_YR_SAME_DAY_TMP AS ( select ORDER_ORIGIN_TYPE,0 \"Yesterday\",sum(SOLD_AMOUNT) \"LstYrSmDay\",0 \"LstYrSmDate\"");
		query.append(" from OM_ORDER where ORDER_SOLD_DTTM >= TO_DATE(?, 'DD-MON-YYYY') and ORDER_SOLD_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY')-195 and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE ),");
		query.append(" LAST_YR_SAME_DATE_TMP AS ( select ORDER_ORIGIN_TYPE,0 \"Yesterday\",0 \"LstYrSmDay\",sum(SOLD_AMOUNT) \"LstYrSmDate\"");
		query.append(" from OM_ORDER where ORDER_SOLD_DTTM >= TO_DATE(?,'DD-MON-YYYY') and ORDER_SOLD_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY')-195 and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE ),");
		query.append(" ALL_DAYS_TMP AS ( select * from YESTERDAY_TMP union select * from LAST_YR_SAME_DAY_TMP union select * from LAST_YR_SAME_DATE_TMP ),");
		query.append(" CHANNEL_BREAKUP_TMP AS ( select ORDER_ORIGIN_TYPE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\",");
		query.append(" CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\"");
		query.append(" from ( select ORDER_ORIGIN_TYPE,sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\",");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\",");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\",");
		query.append("  case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\"");
		query.append(" from ALL_DAYS_TMP  group by ORDER_ORIGIN_TYPE ) order by \"SORTORDER2\" ),");
		query.append(" TOTAL_AGGR_TMP AS (  select 'TOTAL' \"ORDER_ORIGIN_TYPE\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\",");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\",");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\",");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\",");
		query.append("  0 \"SORTORDER2\" from CHANNEL_BREAKUP_TMP order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ), ");
		query.append("  ALL_DISPLAY_TMP AS ( select * from TOTAL_AGGR_TMP  union select * from CHANNEL_BREAKUP_TMP)   ");
		query.append(" select ORDER_ORIGIN_TYPE,ROUND(\"Yesterday\",2) as \"Yesterday\",ROUND(\"LstYrSmDay\",2) as \"LstYrSmDay\",ROUND(\"LstYrSmDate\",2) as \"LstYrSmDate\",ROUND(\"SameDayYOY%\",2) as \"SameDayYOY%\",ROUND(\"SameDateYOY%\",2) as \"SameDateYOY%\",\"SORTORDER2\" from ALL_DISPLAY_TMP  order by \"SORTORDER2\" ");
		logger.info(" Finish execution getReport1AggregateOrderSold() method in EmailReportQuery.class ");
		return query.toString();
	}

	public static String getReport1AggregateOrderPlacedCount() {
		logger.info(" Start execution getReport1AggregateOrderPlacedCount() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" WITH YESTERDAY_TMP AS ( select ORDER_ORIGIN_TYPE,count(1) \"Yesterday\",0 \"LstYrSmDay\",0 \"LstYrSmDate\"");
		query.append(" from OM_ORDER where ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE ),");
		query.append(" LAST_YR_SAME_DAY_TMP AS ( select ORDER_ORIGIN_TYPE,0 \"Yesterday\",count(1) \"LstYrSmDay\",0 \"LstYrSmDate\"");
		query.append(" from OM_ORDER where ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE ),");
		query.append(" LAST_YR_SAME_DATE_TMP AS ( select ORDER_ORIGIN_TYPE,0 \"Yesterday\",0 \"LstYrSmDay\",count(1) \"LstYrSmDate\"");
		query.append(" from OM_ORDER where ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append("group by ORDER_ORIGIN_TYPE ),");
		query.append(" ALL_DAYS_TMP AS (select * from YESTERDAY_TMP union select * from LAST_YR_SAME_DAY_TMP union select * from LAST_YR_SAME_DATE_TMP),");
		query.append(" CHANNEL_BREAKUP_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\",");
		query.append(" CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\"");
		query.append(" from (select ORDER_ORIGIN_TYPE,sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\",");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\",");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\",");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\"");
		query.append(" from ALL_DAYS_TMP group by ORDER_ORIGIN_TYPE ) order by \"SORTORDER2\" ),");
		query.append(" TOTAL_AGGR_TMP AS ( select 'TOTAL' \"ORDER_ORIGIN_TYPE\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\",");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\",");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\",");
		query.append(" 0 \"SORTORDER2\" from CHANNEL_BREAKUP_TMP order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ), ");
		query.append(" ALL_DISPLAY_TMP AS ( select * from TOTAL_AGGR_TMP union select * from CHANNEL_BREAKUP_TMP )");
		query.append(" select ORDER_ORIGIN_TYPE,ROUND(\"Yesterday\",2) as \"Yesterday\",ROUND(\"LstYrSmDay\",2) as \"LstYrSmDay\",ROUND(\"LstYrSmDate\",2) as \"LstYrSmDate\",ROUND(\"SameDayYOY%\",2) as \"SameDayYOY%\",ROUND(\"SameDateYOY%\",2) as \"SameDateYOY%\",\"SORTORDER2\" from ALL_DISPLAY_TMP  order by \"SORTORDER2\"");
		logger.info(" Finish execution getReport1AggregateOrderPlacedCount() method in EmailReportQuery.class ");
		return query.toString();
	}

	public static String getReport1AggregateOrderSoldCount() {
		logger.info(" Start execution getReport1AggregateOrderSoldCount() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" WITH YESTERDAY_TMP AS ( select ORDER_ORIGIN_TYPE,count(1) \"Yesterday\",0 \"LstYrSmDay\",0 \"LstYrSmDate\"");
		query.append(" from OM_ORDER where ORDER_SOLD_DTTM >= TO_DATE(?, 'DD-MON-YYYY')  and ORDER_SOLD_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY')-195 and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE ),");
		query.append(" LAST_YR_SAME_DAY_TMP AS ( select ORDER_ORIGIN_TYPE,0 \"Yesterday\",count(1) \"LstYrSmDay\",0 \"LstYrSmDate\"");
		query.append(" from OM_ORDER where ORDER_SOLD_DTTM >= TO_DATE(?, 'DD-MON-YYYY')  and ORDER_SOLD_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_PLACED_DTTM >= TO_DATE(?,'DD-MON-YYYY')-195 and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE ),");
		query.append(" LAST_YR_SAME_DATE_TMP AS ( select ORDER_ORIGIN_TYPE,0 \"Yesterday\",0 \"LstYrSmDay\",count(1) \"LstYrSmDate\"");
		query.append(" from OM_ORDER where ORDER_SOLD_DTTM >= TO_DATE(?, 'DD-MON-YYYY')  and ORDER_SOLD_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY')-195 and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE ),");
		query.append(" ALL_DAYS_TMP AS ( select * from YESTERDAY_TMP union select * from LAST_YR_SAME_DAY_TMP union select * from LAST_YR_SAME_DATE_TMP ),");
		query.append(" CHANNEL_BREAKUP_TMP AS ( select ORDER_ORIGIN_TYPE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\",");
		query.append(" CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\"");
		query.append(" from (select ORDER_ORIGIN_TYPE,sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\",");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\",");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\",");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\"");
		query.append(" from ALL_DAYS_TMP group by ORDER_ORIGIN_TYPE ) order by \"SORTORDER2\" ),");
		query.append(" TOTAL_AGGR_TMP AS (select 'TOTAL' \"ORDER_ORIGIN_TYPE\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\",");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\",");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\",");
		query.append(" 0 \"SORTORDER2\" from CHANNEL_BREAKUP_TMP order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ), ");
		query.append(" ALL_DISPLAY_TMP AS ( select * from TOTAL_AGGR_TMP union select * from CHANNEL_BREAKUP_TMP )");
		query.append(" select ORDER_ORIGIN_TYPE,ROUND(\"Yesterday\",2) as \"Yesterday\",ROUND(\"LstYrSmDay\",2) as \"LstYrSmDay\",ROUND(\"LstYrSmDate\",2) as \"LstYrSmDate\",ROUND(\"SameDayYOY%\",2) as \"SameDayYOY%\",ROUND(\"SameDateYOY%\",2) as \"SameDateYOY%\",\"SORTORDER2\" from ALL_DISPLAY_TMP  order by \"SORTORDER2\" ");
		logger.info(" Finish execution getReport1AggregateOrderSoldCount() method in EmailReportQuery.class ");
		return query.toString();
	}

	public static String getYesterdayDate() {
		logger.info(" Start execution getYesterdayDate() method in EmailReportQuery.class ");
		StringBuffer buffer = new StringBuffer();
		buffer.append(" select SYS_CALENDAR_ID,to_CHAR(TO_DATE(\"DAY_DESC\", 'yyyy-mm-dd'), 'dd-MON-yyyy') as DATEWITHOUTTIME,");
		buffer.append(" (to_CHAR(TO_DATE(\"DAY_DESC\", 'yyyy-mm-dd'), 'dd-MON-yyyy') || ' 11:59:59 PM') as DATEWITHTIME");
		buffer.append(" from OM_CALENDAR where \"DAY_DESC\"=to_char(to_date(sysdate)-1,'yyyy-mm-dd')");
		logger.info(" Finish execution getYesterdayDate() method in EmailReportQuery.class ");
		return buffer.toString();
	}
	
	public static String getTodayDate() {
		logger.info(" Start execution getYesterdayDate() method in EmailReportQuery.class ");
		StringBuffer buffer = new StringBuffer();
		buffer.append(" select SYS_CALENDAR_ID,to_CHAR(TO_DATE(\"DAY_DESC\", 'yyyy-mm-dd'), 'dd-MON-yyyy') as DATEWITHOUTTIME,");
		buffer.append(" (to_CHAR(TO_DATE(\"DAY_DESC\", 'yyyy-mm-dd'), 'dd-MON-yyyy') || ' 11:59:59 PM') as DATEWITHTIME");
		buffer.append(" from OM_CALENDAR where \"DAY_DESC\"=to_char(to_date(sysdate-(90/1440)),'yyyy-mm-dd')");
		logger.info(" Finish execution getcurrentDate() method in EmailReportQuery.class ");
		return buffer.toString();
	}

	public static String getLastYearSameDay() {
		logger.info(" Start execution getLastYearSameDay() method in EmailReportQuery.class ");
		StringBuffer buffer = new StringBuffer();
		buffer.append(" select DAY_LY_DAY_CAL_ID,to_char(CAST(DAY_LY_DAY_DT as DATE), 'dd-MON-yyyy') as DATEWITHOUTTIME , (to_char(CAST(DAY_LY_DAY_DT as DATE), 'dd-MON-yyyy') || ' 11:59:59 PM')  as DATEWITHTIME ");
		buffer.append(" from OM_CALENDAR where \"DAY_DESC\"=to_char(to_date(sysdate)-1,'yyyy-mm-dd')");
		logger.info(" Finish execution getLastYearSameDay() method in EmailReportQuery.class ");
		return buffer.toString();
	}
	
	public static String getLastYearTodaySameDay() {
		logger.info(" Start execution getLastYearSameDay() method in EmailReportQuery.class ");
		StringBuffer buffer = new StringBuffer();
		buffer.append(" select DAY_LY_DAY_CAL_ID,to_char(CAST(DAY_LY_DAY_DT as DATE), 'dd-MON-yyyy') as DATEWITHOUTTIME , (to_char(CAST(DAY_LY_DAY_DT as DATE) , 'dd-MON-yyyy') || ' 11:59:59 PM')  as DATEWITHTIME ");
		buffer.append(" from OM_CALENDAR where \"DAY_DESC\"=to_char(to_date(sysdate -(90/1440)),'yyyy-mm-dd')");
		logger.info(" Finish execution getLastYearSameDay() method in EmailReportQuery.class ");
		return buffer.toString();
	}

	public static String getLastYearSameDate() {
		logger.info(" Start execution getLastYearSameDate() method in EmailReportQuery.class ");
		StringBuffer buffer = new StringBuffer();
		buffer.append("select DATE_LY_DATE_CAL_ID,to_char(CAST(DATE_LY_DATE_DT as DATE), 'dd-MON-yyyy') as DATEWITHOUTTIME , (to_char(CAST(DATE_LY_DATE_DT as DATE) , 'dd-MON-yyyy') || ' 11:59:59 PM')  as DATEWITHTIME");
		buffer.append(" from OM_CALENDAR where \"DAY_DESC\"=to_char(to_date(sysdate)-1,'yyyy-mm-dd')");
		logger.info(" Finish execution getLastYearSameDate() method in EmailReportQuery.class ");
		return buffer.toString();
	}
	
	public static String getLastYearTodaySameDate() {
		logger.info(" Start execution getLastYearSameDate() method in EmailReportQuery.class ");
		StringBuffer buffer = new StringBuffer();
		buffer.append("select DATE_LY_DATE_CAL_ID,to_char(CAST(DATE_LY_DATE_DT as DATE), 'dd-MON-yyyy') as DATEWITHOUTTIME , (to_char(CAST(DATE_LY_DATE_DT as DATE) , 'dd-MON-yyyy') || ' 11:59:59 PM')  as DATEWITHTIME");
		buffer.append(" from OM_CALENDAR where \"DAY_DESC\"=to_char(to_date(sysdate -(90/1440)),'yyyy-mm-dd')");
		logger.info(" Finish execution getLastYearSameDate() method in EmailReportQuery.class ");
		return buffer.toString();
	}

	public static String getLastWeek() {
		logger.info(" Start execution getLastWeek() method in EmailReportQuery.class ");
		StringBuffer buffer = new StringBuffer();
		
		buffer.append("  With ");
		buffer.append("  LAST_WEEK AS ( ");
		buffer.append(" select (CASE AD_WK_NBR WHEN 1 THEN AD_YR_NBR-1 ELSE AD_YR_NBR END) AS LW_AD_YR_NBR,  ");
		buffer.append(" (CASE AD_WK_NBR WHEN 1 THEN 12 ELSE AD_WK_NBR-1 END) AS LW_AD_WK_NBR  ");
		buffer.append(" from  OM_CALENDAR where DAY_DESC =to_char(to_date(sysdate),'yyyy-mm-dd')  ");
		buffer.append(" )  ");
		buffer.append(" select distinct AD_WK_NBR, AD_YR_NBR, to_char(AD_WK_BEGIN_DT ,'dd-MON-yyyy') as DATEWITHOUTTIME,  ");
	    buffer.append(" (to_CHAR(AD_WK_END_DT, 'dd-MON-yyyy') || ' 11:59:59 PM') as DATEWITHTIME    ");
		buffer.append(" from  OM_CALENDAR, LAST_WEEK where AD_WK_NBR=LW_AD_WK_NBR and AD_YR_NBR=LW_AD_YR_NBR  ");
		logger.info(" Finish execution getLastWeek() method in EmailReportQuery.class ");
		return buffer.toString();
	}

	public static String getLastYearSameWeek() {
		logger.info(" Start execution getLastYearSameWeek() method in EmailReportQuery.class ");
		StringBuffer buffer = new StringBuffer();
		
		buffer.append("With ");
		buffer.append(" LAST_WEEK AS ( ");
		buffer.append(" select (CASE AD_WK_NBR WHEN 1 THEN AD_YR_NBR-2 ELSE AD_YR_NBR-1 END) AS LW_AD_YR_NBR, ");
		buffer.append(" (CASE AD_WK_NBR WHEN 1 THEN 12 ELSE AD_WK_NBR-1 END) AS LW_AD_WK_NBR ");
		buffer.append(" from  OM_CALENDAR where DAY_DESC =to_char(to_date(sysdate),'yyyy-mm-dd') ");
		buffer.append( ") ");
		buffer.append(" select distinct AD_WK_NBR, AD_YR_NBR, to_char(AD_WK_BEGIN_DT ,'dd-MON-yyyy') as DATEWITHOUTTIME, ");
		buffer.append(" (to_CHAR(AD_WK_END_DT, 'dd-MON-yyyy') || ' 11:59:59 PM') as DATEWITHTIME  ");
		buffer.append(" from  OM_CALENDAR, LAST_WEEK where AD_WK_NBR=LW_AD_WK_NBR and AD_YR_NBR=LW_AD_YR_NBR ");
		logger.info(" Finish execution getLastYearSameWeek() method in EmailReportQuery.class ");
		return buffer.toString();
	}

	public static String getLastMonth() {
		logger.info(" Start execution getLastMonth() method in EmailReportQuery.class ");
		StringBuffer buffer = new StringBuffer();
		buffer.append("With ");
		buffer.append("  LAST_MONTH AS (  ");
		buffer.append(" select (CASE CAL_MNTH_NBR_CAL_YR WHEN 1 THEN CAL_YR_NBR-1 ELSE CAL_YR_NBR END) AS YTD_CAL_YR_NBR,  ");
		buffer.append(" (CASE CAL_MNTH_NBR_CAL_YR WHEN 1 THEN 12 ELSE CAL_MNTH_NBR_CAL_YR-1 END) AS YTD_CAL_MNTH_NBR_CAL_YR   ");
		buffer.append(" from  OM_CALENDAR where DAY_DESC =to_char(to_date(sysdate),'yyyy-mm-dd') ) ");
		buffer.append("select distinct CAL_MNTH_NBR_CAL_YR, CAL_YR_NBR, to_char(CAL_MNTH_BEGIN_DT ,'dd-MON-yyyy') as DATEWITHOUTTIME, ");
		buffer.append("(to_CHAR(CAL_MNTH_END_DT, 'dd-MON-yyyy') || ' 11:59:59 PM') as DATEWITHTIME ");
		buffer.append("from  OM_CALENDAR, LAST_MONTH  where CAL_MNTH_NBR_CAL_YR=YTD_CAL_MNTH_NBR_CAL_YR and CAL_YR_NBR=YTD_CAL_YR_NBR ");
		logger.info(" Finish execution getLastMonth() method in EmailReportQuery.class ");
		return buffer.toString();
	}

	public static String getLastYearSameMonth() {
		logger.info(" Start execution getLastYearSameMonth() method in EmailReportQuery.class ");
		StringBuffer buffer = new StringBuffer();
		buffer.append("With ");
		buffer.append("  LAST_MONTH AS (  ");
		buffer.append(" select (CASE CAL_MNTH_NBR_CAL_YR WHEN 1 THEN CAL_YR_NBR-2 ELSE CAL_YR_NBR-1 END) AS YTD_CAL_YR_NBR,  ");
		buffer.append(" (CASE CAL_MNTH_NBR_CAL_YR WHEN 1 THEN 12 ELSE CAL_MNTH_NBR_CAL_YR-1 END) AS   ");
		buffer.append(" YTD_CAL_MNTH_NBR_CAL_YR from  OM_CALENDAR where DAY_DESC =to_char(to_date(sysdate),'yyyy-mm-dd') )");
		buffer.append("select distinct CAL_MNTH_NBR_CAL_YR, CAL_YR_NBR, to_char(CAL_MNTH_BEGIN_DT ,'dd-MON-yyyy') as DATEWITHOUTTIME, ");
		buffer.append("(to_CHAR(CAL_MNTH_END_DT, 'dd-MON-yyyy') || ' 11:59:59 PM') as DATEWITHTIME ");
		buffer.append("from  OM_CALENDAR, LAST_MONTH  where CAL_MNTH_NBR_CAL_YR=YTD_CAL_MNTH_NBR_CAL_YR and CAL_YR_NBR=YTD_CAL_YR_NBR ");
		logger.info(" Finish execution getLastYearSameMonth() method in EmailReportQuery.class ");
		return buffer.toString();
	}

	public static String getReport6EquipmentQuery() {
		logger.info(" Start execution getReport6EquipmentQuery() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" select OM_EQUIPMENT_TYPE.EQUIPMENT_TYPE_DESC \"EquipmentDescription\", round(sum(OM_EQUIPMENT_DWNT_HISTORY.DAILY_DURATION)/60,2) \"Downtime\"");
		query.append(" from OM_EQUIPMENT_DWNT_HISTORY,OM_EQUIPMENT_INSTANCE,OM_EQUIPMENT_TYPE");
		query.append(" where OM_EQUIPMENT_DWNT_HISTORY.SYS_EQUIPIMENT_INSTANCE_ID=OM_EQUIPMENT_INSTANCE.SYS_EQUIPMENT_INSTANCE_ID");
		query.append(" and OM_EQUIPMENT_INSTANCE.SYS_EQUIPMENT_TYPE_ID=OM_EQUIPMENT_TYPE.SYS_EQUIPMENT_TYPE_ID");
		query.append(" and OM_EQUIPMENT_DWNT_HISTORY.DAILY_DWNT_START >= TO_DATE(?,'DD-MON-YYYY') and OM_EQUIPMENT_DWNT_HISTORY.DAILY_DWNT_START <= to_date(?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by OM_EQUIPMENT_TYPE.EQUIPMENT_TYPE_DESC");
		logger.info(" Finish execution getReport6EquipmentQuery() method in EmailReportQuery.class ");
		return query.toString();
	}

	public static String getReport6MachineQuery() {
		logger.info(" Start execution getReport6MachineQuery() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" select OM_MACHINE_TYPE.MACHINE_DESC \"MachineDescription\", round(sum(OM_MACHINE_DWNT_HISTORY.DAILY_DURATION)/60,2) \"Downtime\"");
		query.append(" from OM_MACHINE_DWNT_HISTORY,OM_MACHINE_INSTANCE,OM_MACHINE_TYPE");
		query.append(" where OM_MACHINE_DWNT_HISTORY.SYS_MACHINE_INSTANCE_ID = OM_MACHINE_INSTANCE.SYS_MACHINE_INSTANCE_ID");
		query.append(" and OM_MACHINE_INSTANCE.SYS_MACHINE_TYPE_ID = OM_MACHINE_TYPE.SYS_MACHINE_TYPE_ID");
		query.append(" and OM_MACHINE_DWNT_HISTORY.DAILY_DWNT_START >= TO_DATE(?, 'DD-MON-YYYY') and OM_MACHINE_DWNT_HISTORY.DAILY_DWNT_START <= to_date(?, 'DD-MON-YYYY HH:MI:SS AM' )");
		query.append(" group by OM_MACHINE_TYPE.MACHINE_DESC order by OM_MACHINE_TYPE.MACHINE_DESC");
		logger.info(" Finish execution getReport6MachineQuery() method in EmailReportQuery.class ");
		return query.toString();
	}

	public static String getReport3AtleastOneOrderProcessed() {
		logger.info(" Start execution getReport3AtleastOneOrderProcessed() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" WITH ");
		query.append(" YESTERDAY_TEMP AS ( ");
		query.append(" select count(distinct(sys_OWNING_LOC_ID)) AS Yesterday, 0 AS LstYrSmDay, 0 AS LstYrSmDate from OM_ORDER ");
		query.append(" where ORDER_PLACED_DTTM >=  TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and sys_SRC_VENDOR_ID IS NOT NULL ");
		query.append(" ), ");
		query.append(" LASTYEARSAMEDAY_TEMP AS ( ");
		query.append(" select 0 AS Yesterday, count(distinct(sys_OWNING_LOC_ID)) AS LstYrSmDay , 0 AS LstYrSmDate from OM_ORDER ");
		query.append(" where ORDER_PLACED_DTTM >=  TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and sys_SRC_VENDOR_ID IS NOT NULL ");
		query.append(" ), ");
		query.append(" LASTYEARSAMEDATE_TEMP AS ( ");
		query.append(" select 0 AS Yesterday, 0 AS LstYrSmDay , count(distinct(sys_OWNING_LOC_ID)) AS LstYrSmDate  from OM_ORDER ");
		query.append(" where ORDER_PLACED_DTTM >=  TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and sys_SRC_VENDOR_ID IS NOT NULL ");
		query.append(" ), ");
		query.append(" ALL_DISPLAY_TEMP AS ");
		query.append(" ( ");
		query.append(" SELECT * FROM YESTERDAY_TEMP ");
		query.append(" UNION ");
		query.append(" SELECT * FROM LASTYEARSAMEDAY_TEMP ");
		query.append(" UNION ");
		query.append(" SELECT * FROM LASTYEARSAMEDATE_TEMP ");
		query.append(" ), ");
		query.append(" TOTAL_AGGREGRATE as ");
		query.append(" ( ");
		query.append(" select SUM(Yesterday) as Yesterday , sum(LstYrSmDay) as LstYrSmDay ,sum (LstYrSmDate) as LstYrSmDate , ");
		query.append(" (100*((SUM(Yesterday) - sum(LstYrSmDay)) /sum(LstYrSmDay))) as \"SameDayYOY%\", ");
		query.append(" (100*((SUM(Yesterday) - sum(LstYrSmDate)) /sum(LstYrSmDate))) as \"SameDateYOY%\" from ALL_DISPLAY_TEMP ");
		query.append(" ) ");
		query.append(" SELECT Yesterday, LstYrSmDay, LstYrSmDate, ROUND(\"SameDayYOY%\", 2) as \"SameDayYOY%\", ");
				query.append("ROUND(\"SameDateYOY%\", 2) as \"SameDateYOY%\" FROM TOTAL_AGGREGRATE");
		logger.info(" Finish execution getReport3AtleastOneOrderProcessed() method in EmailReportQuery.class ");
		return query.toString();
	}
	
	// Calendar id is hardcoded
	public static String getReport3CountOfOrder() {
		logger.info(" Start execution getReport3CountOfOrder() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" WITH ");
		query.append(" VENDOR_TMP AS (         ");
		query.append(" select sys_vendor_id,DESCRIPTION vendor_name,AFFILIATE_CD AFFILIATE from OM_VENDOR where vendor_type='SOURCE' and sub_type_cd IN ('INTERNET','MOBILE','KIOSK')  ");
		query.append(" ),  ");
		query.append(" YESTERDAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE,count(1) \"Yesterday\",0 \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,VENDOR_TMP where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+)  ");
		query.append(" and ORDER_PLACED_DTTM >=  TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE ");
		query.append("  ), ");
		query.append(" LAST_YR_SAME_DAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE ,0 \"Yesterday\",count(1) \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,VENDOR_TMP where sys_SRC_VENDOR_ID=SYS_VENDOR_ID(+)  ");
		query.append(" and ORDER_PLACED_DTTM >=  TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");
		query.append(" ),  ");
		query.append(" LAST_YR_SAME_DATE_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE,0 \"Yesterday\",0 \"LstYrSmDay\",count(1) \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,VENDOR_TMP where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+)  ");
		query.append(" and ORDER_PLACED_DTTM >=  TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");
		query.append(" ), ");
		query.append(" ALL_DAYS_TMP AS ( ");
		query.append(" select * from YESTERDAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DATE_TMP ");
		query.append(" ), ");
		query.append(" CHANNEL_BREAKUP_TMP AS (   ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\",  ");
		query.append(" 20 \"SORT_ORDER_CHNL\" ");
		query.append(" from ( ");
		query.append(" select ORDER_ORIGIN_TYPE, SYS_VENDOR_ID,VENDOR_NAME,AFFILIATE, sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\" ");
		query.append(" from ALL_DAYS_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE ");
		query.append(" ) order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ), ");
		query.append(" CHANNEL_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID,'-----TOTAL-----' \"VENDOR_NAME\", -1 \"AFFILIATE\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\" ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ),  ");
		query.append(" TOTAL_AGGR_TMP AS (     ");
		query.append(" select '-----TOTAL-----' \"ORDER_ORIGIN_TYPE\",0 SYS_VENDOR_ID,'' \"VENDOR_NAME\", -1 \"AFFILIATE\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" 0 \"SORTORDER2\",5 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_AGGR_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name    ");
		query.append(" ), ");
		query.append(" AFFILIATE_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID, ");
		query.append(" CASE CHANNEL_BREAKUP_TMP.AFFILIATE WHEN 1 THEN '-----TOTAL AFFILIATE-----' ELSE '-----TOTAL WALGREENS-----' END \"VENDOR_NAME\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",15 \"SORT_ORDER_CHNL\", CHANNEL_BREAKUP_TMP.AFFILIATE ");
		query.append(" from CHANNEL_BREAKUP_TMP, OM_VENDOR where CHANNEL_BREAKUP_TMP.SYS_VENDOR_ID=OM_VENDOR.SYS_VENDOR_ID  ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\",CHANNEL_BREAKUP_TMP.AFFILIATE ");
		query.append(" ),  ");
		query.append(" ALL_DISPLAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from TOTAL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from CHANNEL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from CHANNEL_BREAKUP_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",AFFILIATE from AFFILIATE_AGGR_TMP         ");
		query.append(" ), ");
		query.append(" HIDE_TMP AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'Mobile' and \"SORT_ORDER_CHNL\"=20     ");
		query.append(" ), ");
		query.append(" HIDE_TMP1 AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'Kiosk' and \"SORT_ORDER_CHNL\"<>10     ");
		query.append(" ), ");
		query.append(" HIDE_TMP2 AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'In-Store' and \"SORT_ORDER_CHNL\"<>10     ");
		query.append(" ), ");
		query.append(" DISPLAY_TMP AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP   ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP1   ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP2   ");
		query.append(" )  ");
		query.append(" select ORDER_ORIGIN_TYPE,vendor_name,\"SORTORDER2\",\"SORT_ORDER_CHNL\",\"SORT_ORDER_CHNL2\",\"AFFILIATE\", ");
		query.append(" \"Yesterday\" \"Yesterday\", \"LstYrSmDay\" \"LstYrSmDay\",ROUND(\"SameDayYOY%\", 2) \"SameDayYOY%\", ");
		query.append(" \"LstYrSmDate\" \"LstYrSmDate\",ROUND(\"SameDateYOY%\", 2) \"SameDateYOY%\" from DISPLAY_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"SORT_ORDER_CHNL2\",AFFILIATE,vendor_name ");
		logger.info(" Finish execution getReport3CountOfOrder() method in EmailReportQuery.class ");
		return query.toString();
	}

	// Calendar id is hardcoded
	public static String getReport3PlacedOrderRevenue() {
		logger.info(" Start execution getReport3PlacedOrderRevenue() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" WITH ");
		query.append(" VENDOR_TMP AS (         ");
		query.append(" select sys_vendor_id,DESCRIPTION as vendor_name,AFFILIATE_CD as  AFFILIATE from OM_VENDOR where vendor_type='SOURCE'  and sub_type_cd IN ('INTERNET','MOBILE','KIOSK') ");
		query.append(" ),  ");
		query.append(" YESTERDAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE ,sum(FINAL_PRICE) \"Yesterday\",0 \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,VENDOR_TMP where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+)  ");
		query.append(" and ORDER_PLACED_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE ,0 \"Yesterday\",sum(FINAL_PRICE) \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,VENDOR_TMP where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+)  ");
		query.append(" and ORDER_PLACED_DTTM >=  TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DATE_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE ,0 \"Yesterday\",0 \"LstYrSmDay\",sum(FINAL_PRICE) \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,VENDOR_TMP where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+)  ");
		query.append(" and ORDER_PLACED_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");
		query.append(" ), ");
		query.append(" ALL_DAYS_TMP AS ( ");
		query.append(" select * from YESTERDAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DATE_TMP ");
		query.append(" ), ");
		query.append(" CHANNEL_BREAKUP_TMP AS (   ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\",  ");
		query.append(" 20 \"SORT_ORDER_CHNL\" ");
		query.append(" from ( ");
		query.append(" select ORDER_ORIGIN_TYPE, SYS_VENDOR_ID,VENDOR_NAME,AFFILIATE, sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\" ");
		query.append(" from ALL_DAYS_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE ");
		query.append(" ) order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ), ");
		query.append(" CHANNEL_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID,'-----TOTAL-----' \"VENDOR_NAME\", -1 \"AFFILIATE\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\" ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ),  ");
		query.append(" TOTAL_AGGR_TMP AS (     ");
		query.append(" select '-----TOTAL-----' \"ORDER_ORIGIN_TYPE\",0 SYS_VENDOR_ID,'' \"VENDOR_NAME\", -1 \"AFFILIATE\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" 0 \"SORTORDER2\",5 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_AGGR_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name    ");
		query.append(" ), ");
		query.append(" AFFILIATE_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID, ");
		query.append(" CASE CHANNEL_BREAKUP_TMP.AFFILIATE WHEN 1 THEN '-----TOTAL AFFILIATE-----' ELSE '-----TOTAL WALGREENS-----' END \"VENDOR_NAME\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",15 \"SORT_ORDER_CHNL\", CHANNEL_BREAKUP_TMP.AFFILIATE ");
		query.append(" from CHANNEL_BREAKUP_TMP, OM_VENDOR where CHANNEL_BREAKUP_TMP.SYS_VENDOR_ID=OM_VENDOR.SYS_VENDOR_ID  ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\",CHANNEL_BREAKUP_TMP.AFFILIATE ");
		query.append(" ),     ");
		query.append(" ALL_DISPLAY_TMP AS (               ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from TOTAL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from CHANNEL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from CHANNEL_BREAKUP_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",AFFILIATE from AFFILIATE_AGGR_TMP         ");
		query.append(" ), ");
		query.append(" HIDE_TMP AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'Mobile' and \"SORT_ORDER_CHNL\"=20     ");
		query.append(" ), ");
		query.append(" HIDE_TMP1 AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'Kiosk' and \"SORT_ORDER_CHNL\"<>10     ");
		query.append(" ), ");
		query.append(" HIDE_TMP2 AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'In-Store' and \"SORT_ORDER_CHNL\"<>10     ");
		query.append(" ), ");
		query.append(" DISPLAY_TMP AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP   ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP1   ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP2   ");
		query.append(" )        ");
		query.append(" select ORDER_ORIGIN_TYPE,vendor_name,\"SORTORDER2\",\"SORT_ORDER_CHNL\",\"SORT_ORDER_CHNL2\",\"AFFILIATE\", ");
		query.append(" \"Yesterday\" \"Yesterday($)\",  ");
		query.append(" \"LstYrSmDay\" \"LstYrSmDay($)\",ROUND(\"SameDayYOY%\", 2) as \"SameDayYOY%\",\"LstYrSmDate\" \"LstYrSmDate($)\",ROUND(\"SameDateYOY%\", 2) as \"SameDateYOY%\" from DISPLAY_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"SORT_ORDER_CHNL2\",AFFILIATE,vendor_name ");
		logger.info(" Finish execution getReport3PlacedOrderRevenue() method in EmailReportQuery.class ");
		return query.toString();
	}

	// Calendar id is hardcoded
	public static String getReport3AnticipatedDollarValue() {
		logger.info(" Start execution getReport3AnticipatedDollarValue() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" WITH ");
		query.append(" VENDOR_TMP AS (         ");
		query.append(" select sys_vendor_id,DESCRIPTION as vendor_name, AFFILIATE_CD AFFILIATE from OM_VENDOR where vendor_type='SOURCE'  and sub_type_cd IN ('INTERNET','MOBILE','KIOSK') ");
		query.append(" ),  ");
		query.append(" YESTERDAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE ,sum(TOTAL_ORDER_DISCOUNT) \"Yesterday\",0 \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,VENDOR_TMP where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+)  ");
		query.append(" and ORDER_PLACED_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE ,0 \"Yesterday\",sum(TOTAL_ORDER_DISCOUNT) \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,VENDOR_TMP where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+)  ");
		query.append(" and ORDER_PLACED_DTTM >=  TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DATE_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE ,0 \"Yesterday\",0 \"LstYrSmDay\",sum(TOTAL_ORDER_DISCOUNT) \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,VENDOR_TMP where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+)  ");
		query.append(" and ORDER_PLACED_DTTM >=  TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");
		query.append(" ), ");
		query.append(" ALL_DAYS_TMP AS ( ");
		query.append(" select * from YESTERDAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DATE_TMP ");
		query.append(" ), ");
		query.append(" CHANNEL_BREAKUP_TMP AS (   ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\",  ");
		query.append(" 20 \"SORT_ORDER_CHNL\" ");
		query.append(" from ( ");
		query.append(" select ORDER_ORIGIN_TYPE, SYS_VENDOR_ID,VENDOR_NAME,AFFILIATE, sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\" ");
		query.append(" from ALL_DAYS_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE ");
		query.append(" ) order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ), ");
		query.append(" CHANNEL_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID,'-----TOTAL-----' \"VENDOR_NAME\", -1 \"AFFILIATE\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\" ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ),  ");
		query.append(" TOTAL_AGGR_TMP AS (     ");
		query.append(" select '-----TOTAL-----' \"ORDER_ORIGIN_TYPE\",0 SYS_VENDOR_ID,'' \"VENDOR_NAME\", -1 \"AFFILIATE\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" 0 \"SORTORDER2\",5 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_AGGR_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name    ");
		query.append(" ), ");
		query.append(" AFFILIATE_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID, ");
		query.append(" CASE CHANNEL_BREAKUP_TMP.AFFILIATE WHEN 1 THEN '-----TOTAL AFFILIATE-----' ELSE '-----TOTAL WALGREENS-----' END \"VENDOR_NAME\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",15 \"SORT_ORDER_CHNL\", CHANNEL_BREAKUP_TMP.AFFILIATE ");
		query.append(" from CHANNEL_BREAKUP_TMP, OM_VENDOR where CHANNEL_BREAKUP_TMP.SYS_VENDOR_ID=OM_VENDOR.SYS_VENDOR_ID  ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\",CHANNEL_BREAKUP_TMP.AFFILIATE ");
		query.append(" ),     ");
		query.append(" ALL_DISPLAY_TMP AS (               ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from TOTAL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from CHANNEL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from CHANNEL_BREAKUP_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",AFFILIATE from AFFILIATE_AGGR_TMP         ");
		query.append(" ), ");
		query.append(" HIDE_TMP AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'Mobile' and \"SORT_ORDER_CHNL\"=20     ");
		query.append(" ), ");
		query.append(" HIDE_TMP1 AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'Kiosk' and \"SORT_ORDER_CHNL\"<>10     ");
		query.append(" ), ");
		query.append(" HIDE_TMP2 AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'In-Store' and \"SORT_ORDER_CHNL\"<>10     ");
		query.append(" ), ");
		query.append(" DISPLAY_TMP AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP   ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP1   ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP2   ");
		query.append(" )        ");
		query.append(" select ORDER_ORIGIN_TYPE,vendor_name,\"SORTORDER2\",\"SORT_ORDER_CHNL\",\"SORT_ORDER_CHNL2\",\"AFFILIATE\", ");
		query.append(" ROUND(\"Yesterday\", 2)  \"Yesterday($)\", ROUND(\"LstYrSmDay\", 2) \"LstYrSmDay($)\",ROUND(\"SameDayYOY%\", 2) \"SameDayYOY%\", ");
		query.append(" ROUND(\"LstYrSmDate\", 2)  \"LstYrSmDate($)\",ROUND(\"SameDateYOY%\", 2) \"SameDateYOY%\" from DISPLAY_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"SORT_ORDER_CHNL2\",AFFILIATE,vendor_name   ");
		logger.info(" Finish execution getReport3AnticipatedDollarValue() method in EmailReportQuery.class ");
		return query.toString();
	}

	public static String getReport3AvgRevenuePerOrder() {
		logger.info(" Start execution getReport3AvgRevenuePerOrder() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" WITH ");
		query.append(" VENDOR_TMP AS (     ");    
		query.append("	select sys_vendor_id,DESCRIPTION vendor_name, AFFILIATE_CD AFFILIATE from OM_VENDOR where vendor_type='SOURCE' and sub_type_cd IN ('INTERNET','MOBILE','KIOSK') ");
		query.append(" ),  ");
		query.append(" YESTERDAY_TMP AS ( ");
		query.append("	 select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,");
		query.append("	 vendor_name,nvl(AFFILIATE,0) as AFFILIATE ,AVG(FINAL_PRICE) \"Yesterday\",0 \"LstYrSmDay\",0 \"LstYrSmDate\" ,"); 
		query.append("	 COUNT(SYS_ORDER_ID) \"YesterdayCount\",0 \"LstYrSmDayCount\",0 \"LstYrSmDateCount\"");
		query.append("	 from OM_ORDER,VENDOR_TMP where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+)  ");
		query.append("	 and ORDER_PLACED_DTTM >=  TO_DATE( ?, 'DD-MON-YYYY')  and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM')  ");
		query.append("	 group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");
		query.append(" ),		 ");
		query.append(" LAST_YR_SAME_DAY_TMP AS ( ");
		query.append("	 select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0)");
		query.append("	 as AFFILIATE ,0 \"Yesterday\",AVG(FINAL_PRICE) \"LstYrSmDay\",0 \"LstYrSmDate\" ,  0 \"YesterdayCount\",COUNT(SYS_ORDER_ID) \"LstYrSmDayCount\",0 \"LstYrSmDateCount\" ");
		query.append("	 from OM_ORDER,VENDOR_TMP where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+) "); 
		query.append("	 and ORDER_PLACED_DTTM >=  TO_DATE( ?, 'DD-MON-YYYY')  and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM')  ");
		query.append("	 group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DATE_TMP AS ( ");
		query.append("	 select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) ");
		query.append("	 as AFFILIATE ,0 \"Yesterday\",0 \"LstYrSmDay\",AVG(FINAL_PRICE) \"LstYrSmDate\" , 0 \"YesterdayCount\",0 \"LstYrSmDayCount\",COUNT(SYS_ORDER_ID) \"LstYrSmDateCount\" ");
		query.append("	 from OM_ORDER,VENDOR_TMP where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+)  ");
		query.append("	 and ORDER_PLACED_DTTM >=  TO_DATE( ?, 'DD-MON-YYYY')  and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM')  ");
		query.append("	 group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");
		query.append(" ), ");
		query.append(" ALL_DAYS_TMP AS ( ");
		query.append("	 select * from YESTERDAY_TMP ");
		query.append("	 union ");
		query.append("	 select * from LAST_YR_SAME_DAY_TMP ");
		query.append("	 union ");
		query.append("	 select * from LAST_YR_SAME_DATE_TMP ");
		query.append(" ), ");
		query.append(" CHANNEL_BREAKUP_TMP AS (   ");
		query.append("	 select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE,\"Yesterday\", \"LstYrSmDay\",");
		query.append("	 case \"LstYrSmDay\" WHEN 0 THEN 0 ELSE (100*(\"Yesterday\" - \"LstYrSmDay\")/\"LstYrSmDay\") END \"SameDayYOY%\",");
		query.append("	 \"LstYrSmDate\", ");
		query.append("	 case \"LstYrSmDate\" WHEN 0 THEN 0 ELSE (100*(\"Yesterday\" - \"LstYrSmDate\")/\"LstYrSmDate\") END \"SameDateYOY%\" , ");
		query.append("	 \"YesterdayCount\", \"LstYrSmDayCount\",\"LstYrSmDateCount\", ");
		query.append("	 CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\",  ");
		query.append("	 20 \"SORT_ORDER_CHNL\"  ");
		query.append("	 from (  ");
		query.append("		 select ORDER_ORIGIN_TYPE, SYS_VENDOR_ID,VENDOR_NAME,AFFILIATE,  ");
		query.append("		 SUM(\"Yesterday\") \"Yesterday\", SUM(\"LstYrSmDay\") \"LstYrSmDay\", SUM(\"LstYrSmDate\") \"LstYrSmDate\",  ");
		query.append("		 SUM(\"YesterdayCount\") \"YesterdayCount\", SUM(\"LstYrSmDayCount\")  \"LstYrSmDayCount\", SUM(\"LstYrSmDateCount\") \"LstYrSmDateCount\" ");
		query.append("		 from ALL_DAYS_TMP  ");
		query.append("		 group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");
		query.append("	 ) order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name  ");
		query.append(" ),  		  ");
		query.append(" CHANNEL_AGGR_TMP AS (  ");
		query.append("	 select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID,'-----TOTAL-----' \"VENDOR_NAME\", -1 \"AFFILIATE\", ");
		query.append("	 CASE SUM(\"YesterdayCount\") WHEN 0 THEN 0 ELSE (SUM(\"Yesterday\" * \"YesterdayCount\")/SUM(\"YesterdayCount\")) END \"Yesterday\",  ");
		query.append("	 CASE SUM(\"LstYrSmDayCount\") WHEN 0 THEN 0 ELSE (SUM(\"LstYrSmDay\" * \"LstYrSmDayCount\")/SUM(\"LstYrSmDayCount\")) END \"LstYrSmDay\",  ");
		query.append("	 0 \"SameDayYOY%\",  ");
		query.append("	 CASE SUM(\"LstYrSmDateCount\") WHEN 0 THEN 0 ELSE (SUM(\"LstYrSmDate\" * \"LstYrSmDateCount\")/SUM(\"LstYrSmDateCount\")) END \"LstYrSmDate\", "); 
		query.append("	 0 \"SameDateYOY%\",  ");
		query.append("	 SUM(\"YesterdayCount\") \"YesterdayCount\", SUM(\"LstYrSmDayCount\")  \"LstYrSmDayCount\", SUM(\"LstYrSmDateCount\") \"LstYrSmDateCount\", ");
		query.append("	 \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\"  ");
		query.append("	 from CHANNEL_BREAKUP_TMP  ");
		query.append("	 group by ORDER_ORIGIN_TYPE,\"SORTORDER2\"  ");
		query.append("	 order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name  ");
		query.append(" ), ");
		query.append(" CHANNEL_AGGR_PERC_TMP AS (  ");
		query.append("	 select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID,'-----TOTAL-----' \"VENDOR_NAME\", -1 \"AFFILIATE\", ");
		query.append("	 \"Yesterday\", \"LstYrSmDay\",  ");
		query.append("	 CASE \"LstYrSmDay\" WHEN 0 THEN 0 ELSE (100*(\"Yesterday\" - \"LstYrSmDay\")/\"LstYrSmDay\") END \"SameDayYOY%\",  ");
		query.append("	 \"LstYrSmDate\",  ");
		query.append("	 CASE \"LstYrSmDate\" WHEN 0 THEN 0 ELSE (100*(\"Yesterday\" - \"LstYrSmDate\")/\"LstYrSmDate\") END  \"SameDateYOY%\",  ");
		query.append("	 \"YesterdayCount\", \"LstYrSmDayCount\", \"LstYrSmDateCount\", \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\"  ");
		query.append("	 from CHANNEL_AGGR_TMP  ");
		query.append("	 order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name  ");
		query.append(" ),   ");
		query.append(" TOTAL_AGGR_TMP AS (      ");
		query.append("	 select '-----TOTAL-----' \"ORDER_ORIGIN_TYPE\",0 SYS_VENDOR_ID,'' \"VENDOR_NAME\", -1 \"AFFILIATE\", ");
		query.append("	 (CASE SUM(\"YesterdayCount\") WHEN 0 THEN 0 ELSE (SUM(\"Yesterday\" * \"YesterdayCount\")/SUM(\"YesterdayCount\")) END) \"Yesterday\", ");
		query.append("	 (CASE SUM(\"LstYrSmDayCount\") WHEN 0 THEN 0 ELSE (SUM(\"LstYrSmDay\" * \"LstYrSmDayCount\")/SUM(\"LstYrSmDayCount\")) END) \"LstYrSmDay\", ");
		query.append("	 0 \"SameDayYOY%\",  ");
		query.append("	 (CASE SUM(\"LstYrSmDateCount\") WHEN 0 THEN 0 ELSE (SUM(\"LstYrSmDate\" * \"LstYrSmDateCount\")/SUM(\"LstYrSmDateCount\")) END) \"LstYrSmDate\", ");
		query.append("	 0 \"SameDateYOY%\",  ");
		query.append("	 SUM(\"YesterdayCount\") \"YesterdayCount\", SUM(\"LstYrSmDayCount\") \"LstYrSmDayCount\", SUM(\"LstYrSmDateCount\") \"LstYrSmDateCount\", ");
		query.append("	 0 \"SORTORDER2\",5 \"SORT_ORDER_CHNL\"  ");
		query.append("	 from CHANNEL_AGGR_PERC_TMP  ");
		query.append("	 order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name     ");
		query.append(" ),  ");
		query.append(" TOTAL_AGGR_PERC_TMP AS (   ");   
		query.append("	 select '-----TOTAL-----' \"ORDER_ORIGIN_TYPE\",0 SYS_VENDOR_ID,'' \"VENDOR_NAME\", -1 \"AFFILIATE\", ");
		query.append("	 \"Yesterday\", ");
		query.append("	 \"LstYrSmDay\", ");
		query.append("	 CASE \"LstYrSmDay\" WHEN 0 THEN 0 ELSE (100*(\"Yesterday\" - \"LstYrSmDay\")/\"LstYrSmDay\") END \"SameDayYOY%\",  ");
		query.append("	 \"LstYrSmDate\", ");
		query.append("	 CASE \"LstYrSmDate\" WHEN 0 THEN 0 ELSE (100*(\"Yesterday\" - \"LstYrSmDate\")/\"LstYrSmDate\") END \"SameDateYOY%\",  ");
		query.append("	 \"YesterdayCount\", \"LstYrSmDayCount\", \"LstYrSmDateCount\", 0 \"SORTORDER2\",5 \"SORT_ORDER_CHNL\"  ");
		query.append("	 from TOTAL_AGGR_TMP  ");
		query.append("	 order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name     ");
		query.append(" ), ");
		query.append(" AFFILIATE_AGGR_TMP AS (  ");
		query.append("	 select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID,  ");
		query.append("	 CASE CHANNEL_BREAKUP_TMP.AFFILIATE WHEN 1 THEN '-----TOTAL AFFILIATE-----' ELSE '-----TOTAL WALGREENS-----' END \"VENDOR_NAME\", ");
		query.append("	 CASE SUM(\"YesterdayCount\") WHEN 0 THEN 0 ELSE (SUM(\"Yesterday\" * \"YesterdayCount\")/SUM(\"YesterdayCount\")) END \"Yesterday\",  ");
		query.append("	 CASE SUM(\"LstYrSmDayCount\") WHEN 0 THEN 0 ELSE (SUM(\"LstYrSmDay\" * \"LstYrSmDayCount\")/SUM(\"LstYrSmDayCount\")) END \"LstYrSmDay\",  ");
		query.append("	 0 \"SameDayYOY%\",  ");
		query.append("	 CASE SUM(\"LstYrSmDateCount\") WHEN 0 THEN 0 ELSE (SUM(\"LstYrSmDate\" * \"LstYrSmDateCount\")/SUM(\"LstYrSmDateCount\")) END \"LstYrSmDate\",  ");
		query.append("	 0 \"SameDateYOY%\",  ");
		query.append("	 SUM(\"YesterdayCount\") \"YesterdayCount\", SUM(\"LstYrSmDayCount\")  \"LstYrSmDayCount\", SUM(\"LstYrSmDateCount\") \"LstYrSmDateCount\", ");
		query.append("	 \"SORTORDER2\",15 \"SORT_ORDER_CHNL\", CHANNEL_BREAKUP_TMP.AFFILIATE \"AFFILIATE\" ");
		query.append("	 from CHANNEL_BREAKUP_TMP, OM_VENDOR where CHANNEL_BREAKUP_TMP.SYS_VENDOR_ID=OM_VENDOR.SYS_VENDOR_ID   ");
		query.append("	 group by ORDER_ORIGIN_TYPE,\"SORTORDER2\",CHANNEL_BREAKUP_TMP.AFFILIATE  ");
		query.append(" ), ");
		query.append(" AFFILIATE_AGGR_PERC_TMP AS (  ");
		query.append("	 select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID, \"VENDOR_NAME\", ROUND(\"Yesterday\",2) \"Yesterday\", ROUND(\"LstYrSmDay\",2) \"LstYrSmDay\",  ");
		query.append("	 CASE \"LstYrSmDay\" WHEN 0 THEN 0 ELSE ROUND(100*(\"Yesterday\" - \"LstYrSmDay\")/\"LstYrSmDay\",2) END \"SameDayYOY%\",  ");
		query.append("	 ROUND(\"LstYrSmDate\",2) \"LstYrSmDate\",  ");
		query.append("	 CASE \"LstYrSmDate\" WHEN 0 THEN 0 ELSE ROUND(100*(\"Yesterday\" - \"LstYrSmDate\")/\"LstYrSmDate\",2) END \"SameDateYOY%\", ");
		query.append("	 \"YesterdayCount\", \"LstYrSmDayCount\", \"LstYrSmDateCount\", \"SORTORDER2\",15 \"SORT_ORDER_CHNL\", \"AFFILIATE\" ");
		query.append("	 from AFFILIATE_AGGR_TMP  ");
		query.append(" ), ");
		query.append(" ALL_DISPLAY_TMP AS (         ");         
		query.append("	 select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\",  ");
		query.append("	 \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",\"AFFILIATE\",\"YesterdayCount\", \"LstYrSmDayCount\", \"LstYrSmDateCount\"  ");
		query.append("	 from TOTAL_AGGR_PERC_TMP  ");
		query.append("	 UNION  ");
		query.append("	 select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\",  ");
		query.append("	 \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",\"AFFILIATE\",\"YesterdayCount\", \"LstYrSmDayCount\", \"LstYrSmDateCount\"  ");
		query.append("	 from CHANNEL_AGGR_PERC_TMP  ");
		query.append("	 UNION  ");
		query.append("	 select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\",  ");
		query.append("	 \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",\"AFFILIATE\",\"YesterdayCount\", \"LstYrSmDayCount\", \"LstYrSmDateCount\"  ");
		query.append("	 from CHANNEL_BREAKUP_TMP  ");
		query.append("	 UNION  ");
		query.append("	 select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\",  ");
		query.append("	 \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",\"AFFILIATE\",\"YesterdayCount\", \"LstYrSmDayCount\", \"LstYrSmDateCount\"  ");
		query.append("	 from AFFILIATE_AGGR_PERC_TMP          ");
		query.append(" ),  ");
		query.append(" HIDE_TMP AS (  ");
		query.append("	 select * from ALL_DISPLAY_TMP  ");
		query.append("	 where (ORDER_ORIGIN_TYPE = 'Mobile' and \"SORT_ORDER_CHNL\"=20) ");
		query.append("	 OR (ORDER_ORIGIN_TYPE = 'Kiosk' and \"SORT_ORDER_CHNL\"<>10)    ");  
		query.append("	 OR (ORDER_ORIGIN_TYPE = 'In-Store' and \"SORT_ORDER_CHNL\"<>10)     ");
		query.append("	 OR (ORDER_ORIGIN_TYPE is NULL) ");
		query.append(" ),  ");
		query.append(" DISPLAY_TMP AS (  ");
		query.append("	 select * from ALL_DISPLAY_TMP  ");
		query.append("	 MINUS  ");
		query.append("	 select * from HIDE_TMP ");
		query.append(" )         ");
		query.append(" select ORDER_ORIGIN_TYPE,VENDOR_NAME,ROUND(\"Yesterday\", 2) \"Yesterday($)\",  "); 
		query.append(" ROUND(\"LstYrSmDay\", 2) \"LstYrSmDay($)\",ROUND(\"SameDayYOY%\", 2) \"SameDayYOY%\", ");
		query.append(" ROUND(\"LstYrSmDate\", 2) \"LstYrSmDate($)\", ROUND(\"SameDateYOY%\", 2) \"SameDateYOY%\", ");
		query.append(" \"YesterdayCount\", \"LstYrSmDayCount\", \"LstYrSmDateCount\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",\"SORT_ORDER_CHNL2\",\"AFFILIATE\" ");
		query.append(" from DISPLAY_TMP order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"SORT_ORDER_CHNL2\",AFFILIATE,VENDOR_NAME ");
		logger.info(" Finish execution getReport3AvgRevenuePerOrder() method in EmailReportQuery.class ");
		return query.toString();
	}

	public static String getReport3PercentOrderNotReady() {
		logger.info(" Start execution getReport3PercentOrderNotReady() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append("WITH  ");
		query.append(" VENDOR_TMP AS (         "); 
		query.append(" select sys_vendor_id, DESCRIPTION vendor_name,AFFILIATE_CD AFFILIATE from OM_VENDOR where vendor_type='SOURCE'  and sub_type_cd IN ('INTERNET','MOBILE','KIOSK') ");
		query.append(" ),   ");
		query.append(" YESTERDAY_MISS_TMP AS (  ");
		query.append("	 select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID, ");
		query.append("	 vendor_name,nvl(AFFILIATE,0) as AFFILIATE, count(1) \"Yesterday\",0 \"LstYrSmDay\",0 \"LstYrSmDate\"  ");
		query.append("	 from OM_ORDER, VENDOR_TMP where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+)   ");
		query.append("	 and ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY')-31 and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append("	 and PROMISE_DELIVERY_DTTM >=  TO_DATE( ?, 'DD-MON-YYYY') and PROMISE_DELIVERY_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM')  ");
		query.append("	 and (  (ORDER_COMPLETED_DTTM IS NOT NULL and ORDER_COMPLETED_DTTM != TO_DATE('01-JAN-0001','DD-MON-YYYY')    ");
		query.append("	 and ORDER_COMPLETED_DTTM>PROMISE_DELIVERY_DTTM) OR  ( (ORDER_COMPLETED_DTTM IS NULL or ORDER_COMPLETED_DTTM = TO_DATE('01-JAN-0001','DD-MON-YYYY')) ");
		query.append("	 and (ORDER_SOLD_DTTM IS NOT NULL and ORDER_SOLD_DTTM>PROMISE_DELIVERY_DTTM )))  ");
		query.append("	 group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,VENDOR_NAME,AFFILIATE   ");
		query.append(" ),  ");
		query.append(" LAST_YR_SAME_DAY_MISS_TMP AS (  ");
		query.append("	 select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID, ");
		query.append("	 vendor_name,nvl(AFFILIATE,0) as AFFILIATE ,0 \"Yesterday\",count(1) \"LstYrSmDay\",0 \"LstYrSmDate\"  ");
		query.append("	 from OM_ORDER, VENDOR_TMP where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+)   ");
		query.append("	 and ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY')-31 and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM')  ");
		query.append("	 and PROMISE_DELIVERY_DTTM >=  TO_DATE( ?, 'DD-MON-YYYY') and PROMISE_DELIVERY_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append("	 and (  (ORDER_COMPLETED_DTTM IS NOT NULL and ORDER_COMPLETED_DTTM != TO_DATE('01-JAN-0001','DD-MON-YYYY')    ");
		query.append("	 and ORDER_COMPLETED_DTTM>PROMISE_DELIVERY_DTTM) OR  ( (ORDER_COMPLETED_DTTM IS NULL or ORDER_COMPLETED_DTTM = TO_DATE('01-JAN-0001','DD-MON-YYYY')) ");
		query.append("	 and (ORDER_SOLD_DTTM IS NOT NULL and ORDER_SOLD_DTTM>PROMISE_DELIVERY_DTTM )))  ");
		query.append("	 group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,VENDOR_NAME,AFFILIATE   ");
		query.append(" ),   ");
		query.append(" LAST_YR_SAME_DATE_MISS_TMP AS (  ");
		query.append("	 select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID, ");
		query.append("	 vendor_name,nvl(AFFILIATE,0) as AFFILIATE ,0 \"Yesterday\",0 \"LstYrSmDay\",count(1) \"LstYrSmDate\"  ");
		query.append("	 from OM_ORDER, VENDOR_TMP where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+)   ");
		query.append("	 and ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY')-31 and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM')  ");
		query.append("	 and PROMISE_DELIVERY_DTTM >=  TO_DATE( ?, 'DD-MON-YYYY') and PROMISE_DELIVERY_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append("	 and (  (ORDER_COMPLETED_DTTM IS NOT NULL and ORDER_COMPLETED_DTTM != TO_DATE('01-JAN-0001','DD-MON-YYYY')    ");
		query.append("	 and ORDER_COMPLETED_DTTM>PROMISE_DELIVERY_DTTM) OR  ( (ORDER_COMPLETED_DTTM IS NULL or ORDER_COMPLETED_DTTM = TO_DATE('01-JAN-0001','DD-MON-YYYY')) ");
		query.append("	 and (ORDER_SOLD_DTTM IS NOT NULL and ORDER_SOLD_DTTM>PROMISE_DELIVERY_DTTM )))  ");
		query.append("	 group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,VENDOR_NAME,AFFILIATE  ");
		query.append(" ),          ");
		query.append(" YESTERDAY_TOTAL_TMP AS (  ");
		query.append("	 select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID, ");
		query.append("	 vendor_name,nvl(AFFILIATE,0) as AFFILIATE,count(1) \"Yesterday\",0 \"LstYrSmDay\",0 \"LstYrSmDate\"  ");
		query.append("	 from OM_ORDER, VENDOR_TMP where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+)   ");
		query.append("	 and ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY')-31 and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM')  ");
		query.append("	 and PROMISE_DELIVERY_DTTM >=  TO_DATE( ?, 'DD-MON-YYYY') and PROMISE_DELIVERY_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append("	 group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,VENDOR_NAME,AFFILIATE   ");
		query.append(" ),  ");
		query.append(" LAST_YR_SAME_DAY_TOTAL_TMP AS (  ");
		query.append("	 select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID, ");
		query.append("	 vendor_name,nvl(AFFILIATE,0) as AFFILIATE,0 \"Yesterday\",count(1) \"LstYrSmDay\",0 \"LstYrSmDate\"  ");
		query.append("	 from OM_ORDER, VENDOR_TMP where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+)   ");
		query.append("	 and ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY')-31 and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM')  ");
		query.append("	 and PROMISE_DELIVERY_DTTM >=  TO_DATE( ?, 'DD-MON-YYYY') and PROMISE_DELIVERY_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append("	 group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,VENDOR_NAME,AFFILIATE   ");
		query.append(" ),  ");
		query.append(" LAST_YR_SAME_DATE_TOTAL_TMP AS (  ");
		query.append("	 select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID, ");
		query.append("	 vendor_name,nvl(AFFILIATE,0) as AFFILIATE,0 \"Yesterday\",0 \"LstYrSmDay\",count(1) \"LstYrSmDate\"  ");
		query.append("	 from OM_ORDER, VENDOR_TMP where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+)   ");
		query.append("	 and ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY' )-31 and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM')  ");
		query.append("	 and PROMISE_DELIVERY_DTTM >=  TO_DATE( ?, 'DD-MON-YYYY')  and PROMISE_DELIVERY_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM')  ");
		query.append("	 group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,VENDOR_NAME,AFFILIATE   ");
		query.append(" ),  ");
		query.append(" ALL_DAYS_MISS_TMP AS (  ");
		query.append("	 select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN ' ' ELSE VENDOR_NAME END VENDOR_NAME,  ");
		query.append("	 AFFILIATE,sum(\"Yesterday\") \"Yesterday\",sum(\"LstYrSmDay\") \"LstYrSmDay\",sum(\"LstYrSmDate\") \"LstYrSmDate\"  ");
		query.append("	 from (  ");
		query.append("		 select * from YESTERDAY_MISS_TMP  ");
		query.append("		 union  ");
		query.append("		 select * from LAST_YR_SAME_DAY_MISS_TMP  ");
		query.append("		 union  ");
		query.append("		 select * from LAST_YR_SAME_DATE_MISS_TMP  ");
		query.append("	 ) group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,VENDOR_NAME,AFFILIATE  order by ORDER_ORIGIN_TYPE,VENDOR_NAME ");
		query.append(" ),  ");
		query.append(" ALL_DAYS_TOTAL_TMP AS (  ");
		query.append("	 select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN ' ' ELSE VENDOR_NAME END VENDOR_NAME,  ");
		query.append("	 AFFILIATE,sum(\"Yesterday\") \"Yesterday\",sum(\"LstYrSmDay\") \"LstYrSmDay\",sum(\"LstYrSmDate\") \"LstYrSmDate\"  ");
		query.append("	 from (  ");
		query.append("		 select * from YESTERDAY_TOTAL_TMP  ");
		query.append("		 union  ");
		query.append("		 select * from LAST_YR_SAME_DAY_TOTAL_TMP  ");
		query.append("		 union  ");
		query.append("		 select * from LAST_YR_SAME_DATE_TOTAL_TMP  ");
		query.append("	 ) group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,VENDOR_NAME,AFFILIATE  order by ORDER_ORIGIN_TYPE,VENDOR_NAME ");
		query.append(" ), ");
		query.append(" CHANNEL_BREAKUP_TMP AS (    ");
		query.append("	 select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,VENDOR_NAME,AFFILIATE,\"Yesterday\", \"LstYrSmDay\",  ");
		query.append("	 case \"LstYrSmDay\" WHEN 0 THEN 0 ELSE (100*(\"Yesterday\" - \"LstYrSmDay\")/\"LstYrSmDay\") END \"SameDayYOY%\",  ");
		query.append("	 \"LstYrSmDate\",  ");
		query.append("	 case \"LstYrSmDate\" WHEN 0 THEN 0 ELSE (100*(\"Yesterday\" - \"LstYrSmDate\")/\"LstYrSmDate\") END \"SameDateYOY%\",  ");
		query.append("	 YstdTot , LySmDyTot , LySmDtTot , YstdMiss , LySmDyMiss , LySmDtMiss , ");
		query.append("	 CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\",  "); 
		query.append("	 20 \"SORT_ORDER_CHNL\"  ");
		query.append("	 from (      ");
		query.append("		 select ALL_DAYS_TOTAL_TMP.ORDER_ORIGIN_TYPE,ALL_DAYS_TOTAL_TMP.SYS_VENDOR_ID, ALL_DAYS_TOTAL_TMP.VENDOR_NAME,ALL_DAYS_TOTAL_TMP.AFFILIATE,  ");
		query.append("		 CASE nvl(ALL_DAYS_TOTAL_TMP.\"Yesterday\",0) WHEN 0 THEN 0 ELSE (100*nvl(ALL_DAYS_MISS_TMP.\"Yesterday\",0)/ALL_DAYS_TOTAL_TMP.\"Yesterday\") END \"Yesterday\",  ");
		query.append("		 CASE nvl(ALL_DAYS_TOTAL_TMP.\"LstYrSmDay\",0) WHEN 0 THEN 0 ELSE (100*nvl(ALL_DAYS_MISS_TMP.\"LstYrSmDay\",0)/ALL_DAYS_TOTAL_TMP.\"LstYrSmDay\") END \"LstYrSmDay\",  ");
		query.append("		 CASE nvl(ALL_DAYS_TOTAL_TMP.\"LstYrSmDate\",0) WHEN 0 THEN 0 ELSE (100*nvl(ALL_DAYS_MISS_TMP.\"LstYrSmDate\",0)/ALL_DAYS_TOTAL_TMP.\"LstYrSmDate\") END \"LstYrSmDate\", ");
		query.append("		 NVL(ALL_DAYS_TOTAL_TMP.\"Yesterday\",0) AS YstdTot , NVL(ALL_DAYS_TOTAL_TMP.\"LstYrSmDay\",0) AS LySmDyTot , NVL(ALL_DAYS_TOTAL_TMP.\"LstYrSmDate\",0) AS LySmDtTot , ");
		query.append("		 NVL(ALL_DAYS_MISS_TMP.\"Yesterday\",0) AS YstdMiss , NVL(ALL_DAYS_MISS_TMP.\"LstYrSmDay\",0) AS LySmDyMiss , NVL(ALL_DAYS_MISS_TMP.\"LstYrSmDate\",0) AS LySmDtMiss  ");
		query.append("		 from ALL_DAYS_MISS_TMP RIGHT OUTER JOIN ALL_DAYS_TOTAL_TMP  ");
		query.append("		 on ALL_DAYS_MISS_TMP.ORDER_ORIGIN_TYPE=ALL_DAYS_TOTAL_TMP.ORDER_ORIGIN_TYPE  ");
		query.append("		 and ALL_DAYS_MISS_TMP.VENDOR_NAME=ALL_DAYS_TOTAL_TMP.VENDOR_NAME  ");
		query.append("	) order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,VENDOR_NAME       ");
		query.append(" ),          ");
		query.append(" CHANNEL_AGGR_TMP AS (  ");
		query.append("	 select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID,'-----TOTAL-----' \"VENDOR_NAME\", -1 \"AFFILIATE\", ");
		query.append("	 CASE SUM(YstdTot) WHEN 0 THEN 0 ELSE (100*SUM(YstdMiss)/SUM(YstdTot)) END \"Yesterday\",  ");
		query.append("	 CASE SUM(LySmDyTot) WHEN 0 THEN 0 ELSE (100*SUM(LySmDyMiss)/SUM(LySmDyTot)) END \"LstYrSmDay\",  ");
		query.append("	 0 \"SameDayYOY%\",  ");
		query.append("	 CASE SUM(LySmDtTot) WHEN 0 THEN 0 ELSE (100*SUM(LySmDtMiss)/SUM(LySmDtTot)) END \"LstYrSmDate\",  ");
		query.append("	 0 \"SameDateYOY%\",  ");
		query.append("	 SUM(YstdTot) YstdTot, SUM(LySmDyTot) LySmDyTot, SUM(LySmDtTot) LySmDtTot,  ");
		query.append("	 SUM(YstdMiss) YstdMiss, SUM(LySmDyMiss) LySmDyMiss, SUM(LySmDtMiss) LySmDtMiss, ");
		query.append("	 \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\"  ");
		query.append("	 from CHANNEL_BREAKUP_TMP  ");
		query.append("	 group by ORDER_ORIGIN_TYPE,\"SORTORDER2\"  ");
		query.append("	 order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name  ");
		query.append(" ), ");
		query.append(" CHANNEL_AGGR_PERC_TMP AS (  ");
		query.append("	 select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID,'-----TOTAL-----' \"VENDOR_NAME\", -1 \"AFFILIATE\", ");
		query.append("	 \"Yesterday\", \"LstYrSmDay\",  ");
		query.append("	 CASE \"LstYrSmDay\" WHEN 0 THEN 0 ELSE (100*(\"Yesterday\" - \"LstYrSmDay\")/\"LstYrSmDay\") END \"SameDayYOY%\",  ");
		query.append("	 \"LstYrSmDate\",  ");
		query.append("	 CASE \"LstYrSmDate\" WHEN 0 THEN 0 ELSE (100*(\"Yesterday\" - \"LstYrSmDate\")/\"LstYrSmDate\") END  \"SameDateYOY%\",  ");
		query.append("	 YstdTot , LySmDyTot , LySmDtTot , YstdMiss , LySmDyMiss , LySmDtMiss , \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\"  ");
		query.append("	 from CHANNEL_AGGR_TMP  ");
		query.append("	 order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name  ");
		query.append(" ),   ");
		query.append(" TOTAL_AGGR_TMP AS (      ");
		query.append("	 select '-----TOTAL-----' \"ORDER_ORIGIN_TYPE\",0 SYS_VENDOR_ID,'' \"VENDOR_NAME\", -1 \"AFFILIATE\", ");
		query.append("	 CASE SUM(YstdTot) WHEN 0 THEN 0 ELSE (100*SUM(YstdMiss)/SUM(YstdTot)) END \"Yesterday\",  ");
		query.append("	 CASE SUM(LySmDyTot) WHEN 0 THEN 0 ELSE (100*SUM(LySmDyMiss)/SUM(LySmDyTot)) END \"LstYrSmDay\",  ");
		query.append("	 0 \"SameDayYOY%\",  ");
		query.append("	 CASE SUM(LySmDtTot) WHEN 0 THEN 0 ELSE (100*SUM(LySmDtMiss)/SUM(LySmDtTot)) END \"LstYrSmDate\",  ");
		query.append("	 0 \"SameDateYOY%\",  ");
		query.append("	 SUM(YstdTot) YstdTot, SUM(LySmDyTot) LySmDyTot, SUM(LySmDtTot) LySmDtTot,  ");
		query.append("	 SUM(YstdMiss) YstdMiss, SUM(LySmDyMiss) LySmDyMiss, SUM(LySmDtMiss) LySmDtMiss, ");
		query.append("	 0 \"SORTORDER2\",5 \"SORT_ORDER_CHNL\"  ");
		query.append("	 from CHANNEL_AGGR_PERC_TMP  ");
		query.append("	 order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name     ");
		query.append(" ),  ");
		query.append(" TOTAL_AGGR_PERC_TMP AS (      ");
		query.append("	 select '-----TOTAL-----' \"ORDER_ORIGIN_TYPE\",0 SYS_VENDOR_ID,'' \"VENDOR_NAME\", -1 \"AFFILIATE\", ");
		query.append("	 \"Yesterday\", \"LstYrSmDay\", ");
		query.append("	 CASE \"LstYrSmDay\" WHEN 0 THEN 0 ELSE (100*(\"Yesterday\" - \"LstYrSmDay\")/\"LstYrSmDay\") END \"SameDayYOY%\",  ");
		query.append("	 \"LstYrSmDate\", ");
		query.append("	 CASE \"LstYrSmDate\" WHEN 0 THEN 0 ELSE (100*(\"Yesterday\" - \"LstYrSmDate\")/\"LstYrSmDate\") END \"SameDateYOY%\",  ");
		query.append("	 YstdTot , LySmDyTot , LySmDtTot , YstdMiss , LySmDyMiss , LySmDtMiss , 0 \"SORTORDER2\",5 \"SORT_ORDER_CHNL\"  ");
		query.append("	 from TOTAL_AGGR_TMP  ");
		query.append("	 order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name     ");
		query.append(" ), ");
		query.append(" AFFILIATE_AGGR_TMP AS (  ");
		query.append("	 select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID,  ");
		query.append("	 CASE CHANNEL_BREAKUP_TMP.AFFILIATE WHEN 1 THEN '-----TOTAL AFFILIATE-----' ELSE '-----TOTAL WALGREENS-----' END \"VENDOR_NAME\", ");
		query.append("	 CASE SUM(YstdTot) WHEN 0 THEN 0 ELSE (100*SUM(YstdMiss)/SUM(YstdTot)) END \"Yesterday\",  ");
		query.append("	 CASE SUM(LySmDyTot) WHEN 0 THEN 0 ELSE (100*SUM(LySmDyMiss)/SUM(LySmDyTot)) END \"LstYrSmDay\",  ");
		query.append("	 0 \"SameDayYOY%\",  ");
		query.append("	 CASE SUM(LySmDtTot) WHEN 0 THEN 0 ELSE (100*SUM(LySmDtMiss)/SUM(LySmDtTot)) END \"LstYrSmDate\",  ");
		query.append("	 0 \"SameDateYOY%\",  ");
		query.append("	 SUM(YstdTot) YstdTot, SUM(LySmDyTot) LySmDyTot, SUM(LySmDtTot) LySmDtTot,  ");
		query.append("	 SUM(YstdMiss) YstdMiss, SUM(LySmDyMiss) LySmDyMiss, SUM(LySmDtMiss) LySmDtMiss, ");
		query.append("	 \"SORTORDER2\",15 \"SORT_ORDER_CHNL\", CHANNEL_BREAKUP_TMP.AFFILIATE \"AFFILIATE\" ");
		query.append("	 from CHANNEL_BREAKUP_TMP, OM_VENDOR where CHANNEL_BREAKUP_TMP.SYS_VENDOR_ID=OM_VENDOR.SYS_VENDOR_ID   ");
		query.append("	 group by ORDER_ORIGIN_TYPE,\"SORTORDER2\",CHANNEL_BREAKUP_TMP.AFFILIATE  ");
		query.append(" ), ");
		query.append(" AFFILIATE_AGGR_PERC_TMP AS (  ");
		query.append("	 select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID, \"VENDOR_NAME\", ROUND(\"Yesterday\",2) \"Yesterday\", ROUND(\"LstYrSmDay\",2) \"LstYrSmDay\",  ");
		query.append("	 CASE \"LstYrSmDay\" WHEN 0 THEN 0 ELSE ROUND(100*(\"Yesterday\" - \"LstYrSmDay\")/\"LstYrSmDay\",2) END \"SameDayYOY%\",  ");
		query.append("	 ROUND(\"LstYrSmDate\",2) \"LstYrSmDate\",  ");
		query.append("	 CASE \"LstYrSmDate\" WHEN 0 THEN 0 ELSE ROUND(100*(\"Yesterday\" - \"LstYrSmDate\")/\"LstYrSmDate\",2) END \"SameDateYOY%\", ");
		query.append("	 YstdTot , LySmDyTot , LySmDtTot , YstdMiss , LySmDyMiss , LySmDtMiss, \"SORTORDER2\",15 \"SORT_ORDER_CHNL\", \"AFFILIATE\" ");
		query.append("	 from AFFILIATE_AGGR_TMP  ");
		query.append(" ), ");
		query.append(" ALL_DISPLAY_TMP AS (     ");             
		query.append("	 select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\",  ");
		query.append("	 \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",\"AFFILIATE\",YstdTot , LySmDyTot , LySmDtTot , YstdMiss , LySmDyMiss , LySmDtMiss  ");
		query.append("	 from TOTAL_AGGR_PERC_TMP  ");
		query.append("	 UNION  ");
		query.append("	 select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\",  ");
		query.append("	 \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",\"AFFILIATE\",YstdTot , LySmDyTot , LySmDtTot , YstdMiss , LySmDyMiss , LySmDtMiss  ");
		query.append("	 from CHANNEL_AGGR_PERC_TMP  ");
		query.append("	 UNION  ");
		query.append("	 select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\",  ");
		query.append("	 \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",\"AFFILIATE\",YstdTot , LySmDyTot , LySmDtTot , YstdMiss , LySmDyMiss , LySmDtMiss  ");
		query.append("	 from CHANNEL_BREAKUP_TMP  ");
		query.append("	 UNION  ");
		query.append("	 select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\",  ");
		query.append("	 \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",\"AFFILIATE\",YstdTot , LySmDyTot , LySmDtTot , YstdMiss , LySmDyMiss , LySmDtMiss ");
		query.append("	 from AFFILIATE_AGGR_PERC_TMP          ");
		query.append(" ),  ");
		query.append(" HIDE_TMP AS (  ");
		query.append("	 select * from ALL_DISPLAY_TMP  ");
		query.append("	 where (ORDER_ORIGIN_TYPE = 'Mobile' and \"SORT_ORDER_CHNL\"=20) ");
		query.append("	 OR (ORDER_ORIGIN_TYPE = 'Kiosk' and \"SORT_ORDER_CHNL\"<>10)      ");
		query.append("	 OR (ORDER_ORIGIN_TYPE = 'In-Store' and \"SORT_ORDER_CHNL\"<>10)    "); 
		query.append("	 OR (ORDER_ORIGIN_TYPE is NULL) ");
		query.append(" ),  ");
		query.append(" DISPLAY_TMP AS (  ");
		query.append("	 select * from ALL_DISPLAY_TMP  ");
		query.append("	 MINUS  ");
		query.append("	 select * from HIDE_TMP ");
		query.append(" )         ");
		query.append(" select ORDER_ORIGIN_TYPE,VENDOR_NAME,ROUND(\"Yesterday\", 2) \"Yesterday($)\",  ");
		query.append(" ROUND(\"LstYrSmDay\", 2) \"LstYrSmDay($)\",ROUND(\"SameDayYOY%\", 2) \"SameDayYOY%\",  ");
		query.append(" ROUND(\"LstYrSmDate\", 2) \"LstYrSmDate($)\", ROUND(\"SameDateYOY%\", 2) \"SameDateYOY%\", ");
		query.append(" YstdTot , LySmDyTot , LySmDtTot , YstdMiss , LySmDyMiss , LySmDtMiss, ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",\"SORT_ORDER_CHNL2\",\"AFFILIATE\" ");
		query.append(" from DISPLAY_TMP order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"SORT_ORDER_CHNL2\",AFFILIATE,VENDOR_NAME ");
		logger.info(" Finish execution getReport3PercentOrderNotReady() method in EmailReportQuery.class ");
		return query.toString();
	}

	public static String getReport3AvgNoPrint() {
		logger.info(" Start execution getReport3AvgNoPrint() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append("	WITH  ");
		query.append(" VENDOR_TMP AS (      ");   
		query.append("	select sys_vendor_id,DESCRIPTION vendor_name,AFFILIATE_CD AFFILIATE from OM_VENDOR where vendor_type='SOURCE'  and sub_type_cd IN ('INTERNET','MOBILE','KIOSK') "); 
		query.append(" ),  ");
		query.append(" YESTERDAY_TMP AS ( ");
		query.append("	 select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID, ");
		query.append("	 vendor_name,nvl(AFFILIATE,0) as AFFILIATE, ");
		query.append("	 SUM(OM_ORDER_LINE_ATTRIBUTE.PRINTED_QTY) \"Yesterday\",0 \"LstYrSmDay\",0 \"LstYrSmDate\",  ");
		query.append("	 COUNT(DISTINCT (OM_ORDER.SYS_ORDER_ID)) \"YesterdayCount\",0 \"LstYrSmDayCount\", 0 \"LstYrSmDateCount\"  ");
		query.append("	 from OM_ORDER,VENDOR_TMP,OM_ORDER_LINE,OM_ORDER_LINE_ATTRIBUTE where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+)   ");
		query.append("	 and OM_ORDER.SYS_ORDER_ID=OM_ORDER_LINE.SYS_ORDER_ID and OM_ORDER_LINE.SYS_ORDER_LINE_ID=OM_ORDER_LINE_ATTRIBUTE.SYS_ORDER_LINE_ID ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM and OM_ORDER_LINE.ORDER_PLACED_DTTM = OM_ORDER_LINE_ATTRIBUTE.ORDER_PLACED_DTTM ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM >=  TO_DATE( ?, 'DD-MON-YYYY') and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append("	 group by OM_ORDER.SYS_ORDER_ID,ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DAY_TMP AS ( ");
		query.append("	 select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID, ");
		query.append("	 vendor_name,nvl(AFFILIATE,0) as AFFILIATE, ");
		query.append("	 0 \"Yesterday\",SUM(OM_ORDER_LINE_ATTRIBUTE.PRINTED_QTY) \"LstYrSmDay\",0 \"LstYrSmDate\", ");
		query.append("	 0 \"YesterdayCount\",COUNT(DISTINCT (OM_ORDER.SYS_ORDER_ID)) \"LstYrSmDayCount\", 0 \"LstYrSmDateCount\" ");
		query.append("	 from OM_ORDER,VENDOR_TMP,OM_ORDER_LINE,OM_ORDER_LINE_ATTRIBUTE where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+)  ");
		query.append("	 and OM_ORDER.SYS_ORDER_ID=OM_ORDER_LINE.SYS_ORDER_ID and OM_ORDER_LINE.SYS_ORDER_LINE_ID=OM_ORDER_LINE_ATTRIBUTE.SYS_ORDER_LINE_ID ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM and OM_ORDER_LINE.ORDER_PLACED_DTTM = OM_ORDER_LINE_ATTRIBUTE.ORDER_PLACED_DTTM ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM >=  TO_DATE( ?, 'DD-MON-YYYY') and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append("	 group by OM_ORDER.SYS_ORDER_ID,ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");		 
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DATE_TMP AS ( ");
		query.append("	 select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,");
		query.append("	 vendor_name,nvl(AFFILIATE,0) as AFFILIATE,");
		query.append("	 0 \"Yesterday\",0 \"LstYrSmDay\",SUM(OM_ORDER_LINE_ATTRIBUTE.PRINTED_QTY) \"LstYrSmDate\", ");
		query.append("	 0 \"YesterdayCount\",0 \"LstYrSmDayCount\", COUNT(DISTINCT (OM_ORDER.SYS_ORDER_ID)) \"LstYrSmDateCount\" ");
		query.append("	 from OM_ORDER,VENDOR_TMP,OM_ORDER_LINE,OM_ORDER_LINE_ATTRIBUTE where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+)  ");
		query.append("	 and OM_ORDER.SYS_ORDER_ID=OM_ORDER_LINE.SYS_ORDER_ID and OM_ORDER_LINE.SYS_ORDER_LINE_ID=OM_ORDER_LINE_ATTRIBUTE.SYS_ORDER_LINE_ID ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM and OM_ORDER_LINE.ORDER_PLACED_DTTM = OM_ORDER_LINE_ATTRIBUTE.ORDER_PLACED_DTTM ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM >=  TO_DATE( ?, 'DD-MON-YYYY') and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append("	 group by OM_ORDER.SYS_ORDER_ID,ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  	");	 
		query.append(" ), ");
		query.append(" ALL_DAYS_TMP AS ( ");
		query.append("	 select * from YESTERDAY_TMP ");
		query.append("	 union ");
		query.append("	 select * from LAST_YR_SAME_DAY_TMP ");
		query.append("	 union ");
		query.append("	 select * from LAST_YR_SAME_DATE_TMP ");
		query.append(" ),");
		query.append(" CHANNEL_BREAKUP_TMP AS (   ");
		query.append("	 select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE,\"Yesterday\", \"LstYrSmDay\",");
		query.append("	 case \"LstYrSmDay\" WHEN 0 THEN 0 ELSE (100*(\"Yesterday\" - \"LstYrSmDay\")/\"LstYrSmDay\") END \"SameDayYOY%\",");
		query.append("	 \"LstYrSmDate\",");
		query.append("	 case \"LstYrSmDate\" WHEN 0 THEN 0 ELSE (100*(\"Yesterday\" - \"LstYrSmDate\")/\"LstYrSmDate\") END \"SameDateYOY%\" ,");
		query.append("	 \"YesterdayCount\", \"LstYrSmDayCount\",\"LstYrSmDateCount\",");
		query.append("	 CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\",");  
		query.append("	 20 \"SORT_ORDER_CHNL\" ");
		query.append("	 from ( ");
		query.append("		 select ORDER_ORIGIN_TYPE, SYS_VENDOR_ID,VENDOR_NAME,AFFILIATE, ");
		query.append("  CASE SUM(\"YesterdayCount\") WHEN 0 THEN 0 ELSE SUM(\"Yesterday\")/SUM(\"YesterdayCount\") END \"Yesterday\" , ");
		query.append("  CASE SUM(\"LstYrSmDayCount\") WHEN 0 THEN 0 ELSE SUM(\"LstYrSmDay\")/SUM(\"LstYrSmDayCount\") END \"LstYrSmDay\" , ");
		query.append("  CASE SUM(\"LstYrSmDateCount\") WHEN 0 THEN 0 ELSE SUM(\"LstYrSmDate\")/SUM(\"LstYrSmDateCount\") END \"LstYrSmDate\" , ");
		query.append("	SUM(\"YesterdayCount\") \"YesterdayCount\", SUM(\"LstYrSmDayCount\")  \"LstYrSmDayCount\", SUM(\"LstYrSmDateCount\") \"LstYrSmDateCount\" ");
		query.append("	from ALL_DAYS_TMP ");
		query.append("	group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE ");
		query.append("	 ) order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ),  		"); 
		query.append(" CHANNEL_AGGR_TMP AS ( ");
		query.append("	 select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID,'-----TOTAL-----' \"VENDOR_NAME\", -1 \"AFFILIATE\", ");
		query.append("	 CASE SUM(\"YesterdayCount\") WHEN 0 THEN 0 ELSE (SUM(\"Yesterday\" * \"YesterdayCount\")/SUM(\"YesterdayCount\")) END \"Yesterday\", ");
		query.append("	 CASE SUM(\"LstYrSmDayCount\") WHEN 0 THEN 0 ELSE (SUM(\"LstYrSmDay\" * \"LstYrSmDayCount\")/SUM(\"LstYrSmDayCount\")) END \"LstYrSmDay\", ");
		query.append("	 0 \"SameDayYOY%\", ");
		query.append("	 CASE SUM(\"LstYrSmDateCount\") WHEN 0 THEN 0 ELSE (SUM(\"LstYrSmDate\" * \"LstYrSmDateCount\")/SUM(\"LstYrSmDateCount\")) END \"LstYrSmDate\", ");
		query.append("	 0 \"SameDateYOY%\", ");
		query.append("	 SUM(\"YesterdayCount\") \"YesterdayCount\", SUM(\"LstYrSmDayCount\")  \"LstYrSmDayCount\", SUM(\"LstYrSmDateCount\") \"LstYrSmDateCount\",");
		query.append("	 \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\" ");
		query.append("	 from CHANNEL_BREAKUP_TMP ");
		query.append("	 group by ORDER_ORIGIN_TYPE,\"SORTORDER2\" ");
		query.append("	 order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ), ");
		query.append(" CHANNEL_AGGR_PERC_TMP AS ( ");
		query.append("	 select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID,'-----TOTAL-----' \"VENDOR_NAME\", -1 \"AFFILIATE\", ");
		query.append("	 \"Yesterday\", \"LstYrSmDay\",  ");
		query.append("	 CASE \"LstYrSmDay\" WHEN 0 THEN 0 ELSE (100*(\"Yesterday\" - \"LstYrSmDay\")/\"LstYrSmDay\") END \"SameDayYOY%\",  ");
		query.append("	 \"LstYrSmDate\", ");
		query.append("	 CASE \"LstYrSmDate\" WHEN 0 THEN 0 ELSE (100*(\"Yesterday\" - \"LstYrSmDate\")/\"LstYrSmDate\") END  \"SameDateYOY%\", ");
		query.append("	 \"YesterdayCount\", \"LstYrSmDayCount\", \"LstYrSmDateCount\", \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\"  ");
		query.append("	 from CHANNEL_AGGR_TMP ");
		query.append("	 order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ),  ");
		query.append(" TOTAL_AGGR_TMP AS (     ");
		query.append("	 select '-----TOTAL-----' \"ORDER_ORIGIN_TYPE\",0 SYS_VENDOR_ID,'' \"VENDOR_NAME\", -1 \"AFFILIATE\",");
		query.append("	 (CASE SUM(\"YesterdayCount\") WHEN 0 THEN 0 ELSE (SUM(\"Yesterday\" * \"YesterdayCount\")/SUM(\"YesterdayCount\")) END) \"Yesterday\", ");
		query.append("	 (CASE SUM(\"LstYrSmDayCount\") WHEN 0 THEN 0 ELSE (SUM(\"LstYrSmDay\" * \"LstYrSmDayCount\")/SUM(\"LstYrSmDayCount\")) END) \"LstYrSmDay\", ");
		query.append("	 0 \"SameDayYOY%\", ");
		query.append("	 (CASE SUM(\"LstYrSmDateCount\") WHEN 0 THEN 0 ELSE (SUM(\"LstYrSmDate\" * \"LstYrSmDateCount\")/SUM(\"LstYrSmDateCount\")) END) \"LstYrSmDate\", ");
		query.append("	 0 \"SameDateYOY%\", ");
		query.append("	 SUM(\"YesterdayCount\") \"YesterdayCount\", SUM(\"LstYrSmDayCount\") \"LstYrSmDayCount\", SUM(\"LstYrSmDateCount\") \"LstYrSmDateCount\", ");
		query.append("	 0 \"SORTORDER2\",5 \"SORT_ORDER_CHNL\"  ");
		query.append("	 from CHANNEL_AGGR_PERC_TMP  ");
		query.append("	 order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name    ");
		query.append(" ), ");
		query.append(" TOTAL_AGGR_PERC_TMP AS (     ");
		query.append("	 select '-----TOTAL-----' \"ORDER_ORIGIN_TYPE\",0 SYS_VENDOR_ID,'' \"VENDOR_NAME\", -1 \"AFFILIATE\", ");
		query.append("	 \"Yesterday\",  ");
		query.append("	 \"LstYrSmDay\",  ");
		query.append("	 CASE \"LstYrSmDay\" WHEN 0 THEN 0 ELSE (100*(\"Yesterday\" - \"LstYrSmDay\")/\"LstYrSmDay\") END \"SameDayYOY%\",  ");
		query.append("	 \"LstYrSmDate\", ");
		query.append("	 CASE \"LstYrSmDate\" WHEN 0 THEN 0 ELSE (100*(\"Yesterday\" - \"LstYrSmDate\")/\"LstYrSmDate\") END \"SameDateYOY%\", ");
		query.append("	 \"YesterdayCount\", \"LstYrSmDayCount\", \"LstYrSmDateCount\", 0 \"SORTORDER2\",5 \"SORT_ORDER_CHNL\" ");
		query.append("	 from TOTAL_AGGR_TMP ");
		query.append("	 order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name    ");
		query.append(" ), ");
		query.append(" AFFILIATE_AGGR_TMP AS ( ");
		query.append("	 select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID, ");
		query.append("	 CASE CHANNEL_BREAKUP_TMP.AFFILIATE WHEN 1 THEN '-----TOTAL AFFILIATE-----' ELSE '-----TOTAL WALGREENS-----' END \"VENDOR_NAME\", ");
		query.append("	 CASE SUM(\"YesterdayCount\") WHEN 0 THEN 0 ELSE (SUM(\"Yesterday\" * \"YesterdayCount\")/SUM(\"YesterdayCount\")) END \"Yesterday\", ");
		query.append("	 CASE SUM(\"LstYrSmDayCount\") WHEN 0 THEN 0 ELSE (SUM(\"LstYrSmDay\" * \"LstYrSmDayCount\")/SUM(\"LstYrSmDayCount\")) END \"LstYrSmDay\", ");
		query.append("	 0 \"SameDayYOY%\", ");
		query.append("	 CASE SUM(\"LstYrSmDateCount\") WHEN 0 THEN 0 ELSE (SUM(\"LstYrSmDate\" * \"LstYrSmDateCount\")/SUM(\"LstYrSmDateCount\")) END \"LstYrSmDate\",  ");
		query.append("	 0 \"SameDateYOY%\", ");
		query.append("	 SUM(\"YesterdayCount\") \"YesterdayCount\", SUM(\"LstYrSmDayCount\")  \"LstYrSmDayCount\", SUM(\"LstYrSmDateCount\") \"LstYrSmDateCount\", ");
		query.append("	 \"SORTORDER2\",15 \"SORT_ORDER_CHNL\", CHANNEL_BREAKUP_TMP.AFFILIATE \"AFFILIATE\" ");
		query.append("	 from CHANNEL_BREAKUP_TMP, OM_VENDOR where CHANNEL_BREAKUP_TMP.SYS_VENDOR_ID=OM_VENDOR.SYS_VENDOR_ID   ");
		query.append("	 group by ORDER_ORIGIN_TYPE,\"SORTORDER2\",CHANNEL_BREAKUP_TMP.AFFILIATE ");
		query.append(" ),");
		query.append(" AFFILIATE_AGGR_PERC_TMP AS ( ");
		query.append("	 select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID, \"VENDOR_NAME\", ROUND(\"Yesterday\",2) \"Yesterday\", ROUND(\"LstYrSmDay\",2) \"LstYrSmDay\", ");
		query.append("	 CASE \"LstYrSmDay\" WHEN 0 THEN 0 ELSE ROUND(100*(\"Yesterday\" - \"LstYrSmDay\")/\"LstYrSmDay\",2) END \"SameDayYOY%\",  ");
		query.append("	 ROUND(\"LstYrSmDate\",2) \"LstYrSmDate\", ");
		query.append("	 CASE \"LstYrSmDate\" WHEN 0 THEN 0 ELSE ROUND(100*(\"Yesterday\" - \"LstYrSmDate\")/\"LstYrSmDate\",2) END \"SameDateYOY%\", ");
		query.append("	 \"YesterdayCount\", \"LstYrSmDayCount\", \"LstYrSmDateCount\", \"SORTORDER2\",15 \"SORT_ORDER_CHNL\", \"AFFILIATE\" ");
		query.append("	 from AFFILIATE_AGGR_TMP ");
		query.append(" ), ");
		query.append(" ALL_DISPLAY_TMP AS (      ");            
		query.append("	 select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\",  ");
		query.append("	 \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",\"AFFILIATE\",\"YesterdayCount\", \"LstYrSmDayCount\", \"LstYrSmDateCount\"  ");
		query.append("	 from TOTAL_AGGR_PERC_TMP  ");
		query.append("	 UNION ");
		query.append("	 select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append("	 \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",\"AFFILIATE\",\"YesterdayCount\", \"LstYrSmDayCount\", \"LstYrSmDateCount\" ");
		query.append("	 from CHANNEL_AGGR_PERC_TMP ");
		query.append("	 UNION ");
		query.append("	 select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append("	 \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",\"AFFILIATE\",\"YesterdayCount\", \"LstYrSmDayCount\", \"LstYrSmDateCount\" ");
		query.append("	 from CHANNEL_BREAKUP_TMP ");
		query.append("	 UNION ");
		query.append("	 select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append("	 \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",\"AFFILIATE\",\"YesterdayCount\", \"LstYrSmDayCount\", \"LstYrSmDateCount\" ");
		query.append("	 from AFFILIATE_AGGR_PERC_TMP         ");
		query.append(" ), ");
		query.append(" HIDE_TMP AS ( ");
		query.append("	 select * from ALL_DISPLAY_TMP ");
		query.append("	 where (ORDER_ORIGIN_TYPE = 'Mobile' and \"SORT_ORDER_CHNL\"=20) ");
		query.append("	 OR (ORDER_ORIGIN_TYPE = 'Kiosk' and \"SORT_ORDER_CHNL\"<>10)     ");
		query.append("	 OR (ORDER_ORIGIN_TYPE = 'In-Store' and \"SORT_ORDER_CHNL\"<>10)  ");  
		query.append("	 OR (ORDER_ORIGIN_TYPE is NULL) ");
		query.append(" ), ");
		query.append(" DISPLAY_TMP AS ( ");
		query.append("	 select * from ALL_DISPLAY_TMP ");
		query.append("	 MINUS ");
		query.append("	 select * from HIDE_TMP ");
		query.append(" )        ");
		query.append(" select ORDER_ORIGIN_TYPE,VENDOR_NAME,ROUND(\"Yesterday\", 2) \"Yesterday($)\",  ");
		query.append(" ROUND(\"LstYrSmDay\", 2) \"LstYrSmDay($)\",ROUND(\"SameDayYOY%\", 2) \"SameDayYOY%\", ");
		query.append(" ROUND(\"LstYrSmDate\", 2) \"LstYrSmDate($)\", ROUND(\"SameDateYOY%\", 2) \"SameDateYOY%\", ");
		query.append(" \"YesterdayCount\", \"LstYrSmDayCount\", \"LstYrSmDateCount\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",\"SORT_ORDER_CHNL2\",\"AFFILIATE\" ");
		query.append(" from DISPLAY_TMP order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"SORT_ORDER_CHNL2\",AFFILIATE,VENDOR_NAME ");
		logger.info(" Finish execution getReport3AvgNoPrint() method in EmailReportQuery.class ");
		return query.toString();
	}

	public static String getReport3TotalNoPrint() {
		logger.info(" Start execution getReport3TotalNoPrint() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" WITH ");
		query.append(" VENDOR_TMP AS (         ");
		query.append(" select sys_vendor_id,DESCRIPTION vendor_name,AFFILIATE_CD AFFILIATE from OM_VENDOR where vendor_type='SOURCE'  and sub_type_cd IN ('INTERNET','MOBILE','KIOSK') ");
		query.append(" ),  ");
		query.append(" YESTERDAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE,sum(OM_ORDER_LINE_ATTRIBUTE.PRINTED_QTY) \"Yesterday\",0 \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,VENDOR_TMP,OM_ORDER_LINE,OM_ORDER_LINE_ATTRIBUTE where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+)  ");
		query.append(" and OM_ORDER.SYS_ORDER_ID=OM_ORDER_LINE.SYS_ORDER_ID and OM_ORDER_LINE.SYS_ORDER_LINE_ID=OM_ORDER_LINE_ATTRIBUTE.SYS_ORDER_LINE_ID ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM and OM_ORDER_LINE.ORDER_PLACED_DTTM = OM_ORDER_LINE_ATTRIBUTE.ORDER_PLACED_DTTM ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >=  TO_DATE( ?, 'DD-MON-YYYY') and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE,0 \"Yesterday\",sum(OM_ORDER_LINE_ATTRIBUTE.PRINTED_QTY) \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,VENDOR_TMP,OM_ORDER_LINE,OM_ORDER_LINE_ATTRIBUTE where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+)  ");
		query.append(" and OM_ORDER.SYS_ORDER_ID=OM_ORDER_LINE.SYS_ORDER_ID and OM_ORDER_LINE.SYS_ORDER_LINE_ID=OM_ORDER_LINE_ATTRIBUTE.SYS_ORDER_LINE_ID ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM and OM_ORDER_LINE.ORDER_PLACED_DTTM = OM_ORDER_LINE_ATTRIBUTE.ORDER_PLACED_DTTM ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >=  TO_DATE( ?, 'DD-MON-YYYY') and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DATE_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE,0 \"Yesterday\",0 \"LstYrSmDay\",sum(OM_ORDER_LINE_ATTRIBUTE.PRINTED_QTY) \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,VENDOR_TMP,OM_ORDER_LINE,OM_ORDER_LINE_ATTRIBUTE where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+)  ");
		query.append(" and OM_ORDER.SYS_ORDER_ID=OM_ORDER_LINE.SYS_ORDER_ID and OM_ORDER_LINE.SYS_ORDER_LINE_ID=OM_ORDER_LINE_ATTRIBUTE.SYS_ORDER_LINE_ID ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM and OM_ORDER_LINE.ORDER_PLACED_DTTM = OM_ORDER_LINE_ATTRIBUTE.ORDER_PLACED_DTTM ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");
		query.append(" ), ");
		query.append(" ALL_DAYS_TMP AS ( ");
		query.append(" select * from YESTERDAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DATE_TMP ");
		query.append(" ), ");
		query.append(" CHANNEL_BREAKUP_TMP AS (   ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\",  ");
		query.append(" 20 \"SORT_ORDER_CHNL\" ");
		query.append(" from ( ");
		query.append(" select ORDER_ORIGIN_TYPE, SYS_VENDOR_ID,VENDOR_NAME,AFFILIATE, sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\" ");
		query.append(" from ALL_DAYS_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE ");
		query.append(" ) order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ), ");
		query.append(" CHANNEL_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID,'-----TOTAL-----' \"VENDOR_NAME\", -1 \"AFFILIATE\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\" ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ),  ");
		query.append(" TOTAL_AGGR_TMP AS (     ");
		query.append(" select '-----TOTAL-----' \"ORDER_ORIGIN_TYPE\",0 SYS_VENDOR_ID,'' \"VENDOR_NAME\", -1 \"AFFILIATE\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" 0 \"SORTORDER2\",5 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_AGGR_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name    ");
		query.append(" ), ");
		query.append(" AFFILIATE_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID, ");
		query.append(" CASE CHANNEL_BREAKUP_TMP.AFFILIATE WHEN 1 THEN '-----TOTAL AFFILIATE-----' ELSE '-----TOTAL WALGREENS-----' END \"VENDOR_NAME\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",15 \"SORT_ORDER_CHNL\", CHANNEL_BREAKUP_TMP.AFFILIATE ");
		query.append(" from CHANNEL_BREAKUP_TMP, OM_VENDOR where CHANNEL_BREAKUP_TMP.SYS_VENDOR_ID=OM_VENDOR.SYS_VENDOR_ID  ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\",CHANNEL_BREAKUP_TMP.AFFILIATE ");
		query.append(" ),     ");
		query.append(" ALL_DISPLAY_TMP AS (               ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from TOTAL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from CHANNEL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from CHANNEL_BREAKUP_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",AFFILIATE from AFFILIATE_AGGR_TMP         ");
		query.append(" ), ");
		query.append(" HIDE_TMP AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'Mobile' and \"SORT_ORDER_CHNL\"=20     ");
		query.append(" ), ");
		query.append(" HIDE_TMP1 AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'Kiosk' and \"SORT_ORDER_CHNL\"<>10     ");
		query.append(" ), ");
		query.append(" HIDE_TMP2 AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'In-Store' and \"SORT_ORDER_CHNL\"<>10     ");
		query.append(" ), ");
		query.append(" DISPLAY_TMP AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP   ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP1   ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP2   ");
		query.append(" )        ");
		query.append(" select ORDER_ORIGIN_TYPE,vendor_name,\"SORTORDER2\",\"SORT_ORDER_CHNL\",\"SORT_ORDER_CHNL2\",\"AFFILIATE\", ");
		query.append(" \"Yesterday\" \"Yesterday\", \"LstYrSmDay\" \"LstYrSmDay\",ROUND(\"SameDayYOY%\", 2) \"SameDayYOY%\", ");
		query.append(" \"LstYrSmDate\" \"LstYrSmDate\",ROUND(\"SameDateYOY%\", 2) \"SameDateYOY%\" from DISPLAY_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"SORT_ORDER_CHNL2\",AFFILIATE,vendor_name ");
		logger.info(" Finish execution getReport3TotalNoPrint() method in EmailReportQuery.class ");
		return query.toString();
	}

	public static String getReport4TotalQuantity() {
		logger.info(" Start execution getReport4TotalQuantity() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" WITH ");
		query.append(" VENDOR_TMP AS (         ");
		query.append(" select sys_vendor_id, DESCRIPTION as vendor_name,AFFILIATE_CD AFFILIATE from OM_VENDOR where vendor_type='SOURCE' and sub_type_cd IN ('INTERNET','MOBILE','KIOSK')   ");
		query.append(" ),  ");
		query.append(" YESTERDAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE,count(1) \"Yesterday\",0 \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,VENDOR_TMP,OM_ORDER_ATTRIBUTE where sys_SRC_VENDOR_ID=SYS_VENDOR_ID(+) and OM_ORDER_ATTRIBUTE.SYS_ORDER_ID=OM_ORDER.SYS_ORDER_ID ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_ATTRIBUTE.ORDER_PLACED_DTTM ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= to_date(?, 'DD-MON-YYYY')-195 and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and OM_ORDER.ORDER_CANCELLED_DTTM >= to_date(?, 'DD-MON-YYYY') and OM_ORDER.ORDER_CANCELLED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_COMPLETED_DTTM IS NOT NULL and ORDER_COMPLETED_DTTM != TO_DATE('01-JAN-0001','DD-MON-YYYY') and STATUS=?  ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE,0 \"Yesterday\",count(1) \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,VENDOR_TMP,OM_ORDER_ATTRIBUTE where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+) and OM_ORDER_ATTRIBUTE.sys_ORDER_ID=OM_ORDER.SYS_ORDER_ID ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_ATTRIBUTE.ORDER_PLACED_DTTM ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= to_date(?, 'DD-MON-YYYY')-195 and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and OM_ORDER.ORDER_CANCELLED_DTTM >= to_date(?, 'DD-MON-YYYY') and OM_ORDER.ORDER_CANCELLED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_COMPLETED_DTTM IS NOT NULL and ORDER_COMPLETED_DTTM != TO_DATE('01-JAN-0001','DD-MON-YYYY') and STATUS=?  ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DATE_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE,0 \"Yesterday\",0 \"LstYrSmDay\",count(1) \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,VENDOR_TMP,om_order_attribute where sys_SRC_VENDOR_ID=SYS_VENDOR_ID(+) and om_order_attribute.SYS_ORDER_ID=OM_ORDER.SYS_ORDER_ID ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_ATTRIBUTE.ORDER_PLACED_DTTM ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= to_date(?, 'DD-MON-YYYY')-195 and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and OM_ORDER.ORDER_CANCELLED_DTTM >= to_date(?, 'DD-MON-YYYY') and OM_ORDER.ORDER_CANCELLED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_COMPLETED_DTTM IS NOT NULL and ORDER_COMPLETED_DTTM != TO_DATE('01-JAN-0001','DD-MON-YYYY') and STATUS=?  ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");
		query.append(" ), ");
		query.append(" ALL_DAYS_TMP AS ( ");
		query.append(" select * from YESTERDAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DATE_TMP ");
		query.append(" ), ");
		query.append(" CHANNEL_BREAKUP_TMP AS (   ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\",  ");
		query.append(" 20 \"SORT_ORDER_CHNL\" ");
		query.append(" from ( ");
		query.append(" select ORDER_ORIGIN_TYPE, SYS_VENDOR_ID,VENDOR_NAME,AFFILIATE, sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\" ");
		query.append(" from ALL_DAYS_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE ");
		query.append(" ) order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ), ");
		query.append(" CHANNEL_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID,'-----TOTAL-----' \"VENDOR_NAME\", -1 \"AFFILIATE\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\" ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ),  ");
		query.append(" TOTAL_AGGR_TMP AS (     ");
		query.append(" select '-----TOTAL-----' \"ORDER_ORIGIN_TYPE\",0 SYS_VENDOR_ID,'' \"VENDOR_NAME\", -1 \"AFFILIATE\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" 0 \"SORTORDER2\",5 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_AGGR_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name    ");
		query.append(" ), ");
		query.append(" AFFILIATE_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID, ");
		query.append(" CASE CHANNEL_BREAKUP_TMP.AFFILIATE WHEN 1 THEN '-----TOTAL AFFILIATE-----' ELSE '-----TOTAL WALGREENS-----' END \"VENDOR_NAME\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",15 \"SORT_ORDER_CHNL\", CHANNEL_BREAKUP_TMP.AFFILIATE ");
		query.append(" from CHANNEL_BREAKUP_TMP, OM_VENDOR where CHANNEL_BREAKUP_TMP.SYS_VENDOR_ID=OM_VENDOR.SYS_VENDOR_ID  ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\",CHANNEL_BREAKUP_TMP.AFFILIATE ");
		query.append(" ),     ");
		query.append(" ALL_DISPLAY_TMP AS (               ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from TOTAL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from CHANNEL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from CHANNEL_BREAKUP_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",AFFILIATE from AFFILIATE_AGGR_TMP         ");
		query.append(" ), ");
		query.append(" HIDE_TMP AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'Mobile' and \"SORT_ORDER_CHNL\"=20     ");
		query.append(" ), ");
		query.append(" HIDE_TMP1 AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'Kiosk' and \"SORT_ORDER_CHNL\"<>10     ");
		query.append(" ), ");
		query.append(" HIDE_TMP2 AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'In-Store' and \"SORT_ORDER_CHNL\"<>10     ");
		query.append(" ), ");
		query.append(" DISPLAY_TMP AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP   ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP1   ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP2   ");
		query.append(" )        ");
		query.append(" select ORDER_ORIGIN_TYPE,vendor_name,\"SORTORDER2\",\"SORT_ORDER_CHNL\",\"SORT_ORDER_CHNL2\",\"AFFILIATE\", ");
		query.append(" \"Yesterday\" \"Yesterday\", \"LstYrSmDay\" \"LstYrSmDay\",ROUND(\"SameDayYOY%\", 2) \"SameDayYOY%\", ");
		query.append(" \"LstYrSmDate\" \"LstYrSmDate\",ROUND(\"SameDateYOY%\", 2) \"SameDateYOY%\" from DISPLAY_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"SORT_ORDER_CHNL2\",AFFILIATE,vendor_name       ");
		logger.info(" Finish execution getReport4TotalQuantity() method in EmailReportQuery.class ");
		return query.toString();
	}

	public static String getReport4TotalLost() {
		logger.info(" Start execution getReport4TotalLost() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" WITH ");
		query.append(" VENDOR_TMP AS (         ");
		query.append(" select sys_vendor_id, DESCRIPTION as vendor_name,AFFILIATE_CD AFFILIATE from OM_VENDOR where vendor_type='SOURCE' and sub_type_cd IN ('INTERNET','MOBILE','KIOSK')  ");
		query.append(" ),  ");
		query.append(" YESTERDAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE,sum(ORIGINAL_ORDER_PRICE) \"Yesterday\",0 \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,VENDOR_TMP,OM_ORDER_ATTRIBUTE where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+) and OM_ORDER_ATTRIBUTE.SYS_ORDER_ID=OM_ORDER.SYS_ORDER_ID ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_ATTRIBUTE.ORDER_PLACED_DTTM ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= to_date(?, 'DD-MON-YYYY')-195 and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and OM_ORDER.ORDER_CANCELLED_DTTM >= to_date(?, 'DD-MON-YYYY') and OM_ORDER.ORDER_CANCELLED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_COMPLETED_DTTM IS NOT NULL and ORDER_COMPLETED_DTTM != TO_DATE('01-JAN-0001','DD-MON-YYYY') and STATUS=?  ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE,0 \"Yesterday\",sum(ORIGINAL_ORDER_PRICE) \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,VENDOR_TMP,OM_ORDER_ATTRIBUTE where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+) and OM_ORDER_ATTRIBUTE.SYS_ORDER_ID=OM_ORDER.SYS_ORDER_ID ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_ATTRIBUTE.ORDER_PLACED_DTTM ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= to_date(?, 'DD-MON-YYYY')-195 and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and OM_ORDER.ORDER_CANCELLED_DTTM >= to_date(?, 'DD-MON-YYYY') and OM_ORDER.ORDER_CANCELLED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_COMPLETED_DTTM IS NOT NULL and ORDER_COMPLETED_DTTM != TO_DATE('01-JAN-0001','DD-MON-YYYY') and STATUS=?  ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DATE_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE,0 \"Yesterday\",0 \"LstYrSmDay\",sum(ORIGINAL_ORDER_PRICE) \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,VENDOR_TMP,OM_ORDER_ATTRIBUTE where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+) and OM_ORDER_ATTRIBUTE.SYS_ORDER_ID=OM_ORDER.SYS_ORDER_ID ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_ATTRIBUTE.ORDER_PLACED_DTTM ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= to_date(?, 'DD-MON-YYYY')-195 and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and OM_ORDER.ORDER_CANCELLED_DTTM >= to_date(?, 'DD-MON-YYYY') and OM_ORDER.ORDER_CANCELLED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_COMPLETED_DTTM IS NOT NULL and ORDER_COMPLETED_DTTM != TO_DATE('01-JAN-0001','DD-MON-YYYY') and STATUS=?  ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");
		query.append(" ), ");
		query.append(" ALL_DAYS_TMP AS ( ");
		query.append(" select * from YESTERDAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DATE_TMP ");
		query.append(" ), ");
		query.append(" CHANNEL_BREAKUP_TMP AS (   ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\",  ");
		query.append(" 20 \"SORT_ORDER_CHNL\" ");
		query.append(" from ( ");
		query.append(" select ORDER_ORIGIN_TYPE, SYS_VENDOR_ID,VENDOR_NAME,AFFILIATE, sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\" ");
		query.append(" from ALL_DAYS_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE ");
		query.append(" ) order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ), ");
		query.append(" CHANNEL_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID,'-----TOTAL-----' \"VENDOR_NAME\", -1 \"AFFILIATE\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\" ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ),  ");
		query.append(" TOTAL_AGGR_TMP AS (     ");
		query.append(" select '-----TOTAL-----' \"ORDER_ORIGIN_TYPE\",0 SYS_VENDOR_ID,'' \"VENDOR_NAME\", -1 \"AFFILIATE\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" 0 \"SORTORDER2\",5 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_AGGR_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name    ");
		query.append(" ), ");
		query.append(" AFFILIATE_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID, ");
		query.append(" CASE CHANNEL_BREAKUP_TMP.AFFILIATE WHEN 1 THEN '-----TOTAL AFFILIATE-----' ELSE '-----TOTAL WALGREENS-----' END \"VENDOR_NAME\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",15 \"SORT_ORDER_CHNL\", CHANNEL_BREAKUP_TMP.AFFILIATE ");
		query.append(" from CHANNEL_BREAKUP_TMP, OM_VENDOR where CHANNEL_BREAKUP_TMP.SYS_VENDOR_ID=OM_VENDOR.SYS_VENDOR_ID  ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\",CHANNEL_BREAKUP_TMP.AFFILIATE ");
		query.append(" ),     ");
		query.append(" ALL_DISPLAY_TMP AS (               ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from TOTAL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from CHANNEL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from CHANNEL_BREAKUP_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",AFFILIATE from AFFILIATE_AGGR_TMP         ");
		query.append(" ), ");
		query.append(" HIDE_TMP AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'Mobile' and \"SORT_ORDER_CHNL\"=20     ");
		query.append(" ), ");
		query.append(" HIDE_TMP1 AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'Kiosk' and \"SORT_ORDER_CHNL\"<>10     ");
		query.append(" ), ");
		query.append(" HIDE_TMP2 AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'In-Store' and \"SORT_ORDER_CHNL\"<>10     ");
		query.append(" ), ");
		query.append(" DISPLAY_TMP AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP   ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP1   ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP2   ");
		query.append(" )        ");
		query.append(" select ORDER_ORIGIN_TYPE,vendor_name,\"SORTORDER2\",\"SORT_ORDER_CHNL\",\"SORT_ORDER_CHNL2\",\"AFFILIATE\", ");
		query.append(" \"Yesterday\" \"Yesterday\", \"LstYrSmDay\" \"LstYrSmDay\",ROUND(\"SameDayYOY%\", 2) \"SameDayYOY%\", ");
		query.append(" \"LstYrSmDate\" \"LstYrSmDate\",ROUND(\"SameDateYOY%\", 2) \"SameDateYOY%\" from DISPLAY_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"SORT_ORDER_CHNL2\",AFFILIATE,vendor_name       ");
		logger.info(" Finish execution getReport4TotalLost() method in EmailReportQuery.class ");
		return query.toString();
	}

	public static String getReport4TotalCost() {
		logger.info(" Start execution getReport4TotalCost() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" WITH ");
		query.append(" VENDOR_TMP AS (         ");
		query.append(" select sys_vendor_id, DESCRIPTION as vendor_name,AFFILIATE_CD AFFILIATE from OM_VENDOR where vendor_type='SOURCE' and sub_type_cd IN ('INTERNET','MOBILE','KIOSK')  ");
		query.append(" ),  ");
		query.append(" YESTERDAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE,sum(COST) \"Yesterday\",0 \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,VENDOR_TMP,OM_ORDER_ATTRIBUTE where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+) and OM_ORDER_ATTRIBUTE.SYS_ORDER_ID=OM_ORDER.SYS_ORDER_ID ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_ATTRIBUTE.ORDER_PLACED_DTTM ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= to_date(?, 'DD-MON-YYYY')-195 and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and OM_ORDER.ORDER_CANCELLED_DTTM >= to_date(?, 'DD-MON-YYYY') and OM_ORDER.ORDER_CANCELLED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_COMPLETED_DTTM IS NOT NULL and ORDER_COMPLETED_DTTM != TO_DATE('01-JAN-0001','DD-MON-YYYY') and STATUS=?  ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE,0 \"Yesterday\",sum(COST) \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,VENDOR_TMP,OM_ORDER_ATTRIBUTE where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+) and OM_ORDER_ATTRIBUTE.SYS_ORDER_ID=OM_ORDER.SYS_ORDER_ID ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_ATTRIBUTE.ORDER_PLACED_DTTM ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= to_date(?, 'DD-MON-YYYY')-195 and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and OM_ORDER.ORDER_CANCELLED_DTTM >= to_date(?, 'DD-MON-YYYY') and OM_ORDER.ORDER_CANCELLED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_COMPLETED_DTTM IS NOT NULL and ORDER_COMPLETED_DTTM != TO_DATE('01-JAN-0001','DD-MON-YYYY') and STATUS=?  ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DATE_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE,0 \"Yesterday\",0 \"LstYrSmDay\",sum(COST) \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,VENDOR_TMP,OM_ORDER_ATTRIBUTE where sys_SRC_VENDOR_ID=SYS_VENDOR_ID(+) and OM_ORDER_ATTRIBUTE.SYS_ORDER_ID=OM_ORDER.SYS_ORDER_ID ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_ATTRIBUTE.ORDER_PLACED_DTTM ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= to_date(?, 'DD-MON-YYYY')-195 and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and OM_ORDER.ORDER_CANCELLED_DTTM >= to_date(?, 'DD-MON-YYYY') and OM_ORDER.ORDER_CANCELLED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_COMPLETED_DTTM IS NOT NULL and ORDER_COMPLETED_DTTM != TO_DATE('01-JAN-0001','DD-MON-YYYY') and STATUS=?  ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");
		query.append(" ), ");
		query.append(" ALL_DAYS_TMP AS ( ");
		query.append(" select * from YESTERDAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DATE_TMP ");
		query.append(" ), ");
		query.append(" CHANNEL_BREAKUP_TMP AS (   ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\",  ");
		query.append(" 20 \"SORT_ORDER_CHNL\" ");
		query.append(" from ( ");
		query.append(" select ORDER_ORIGIN_TYPE, SYS_VENDOR_ID,VENDOR_NAME,AFFILIATE, sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\" ");
		query.append(" from ALL_DAYS_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE ");
		query.append(" ) order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ), ");
		query.append(" CHANNEL_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID,'-----TOTAL-----' \"VENDOR_NAME\", -1 \"AFFILIATE\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\" ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ),  ");
		query.append(" TOTAL_AGGR_TMP AS (     ");
		query.append(" select '-----TOTAL-----' \"ORDER_ORIGIN_TYPE\",0 SYS_VENDOR_ID,'' \"VENDOR_NAME\", -1 \"AFFILIATE\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" 0 \"SORTORDER2\",5 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_AGGR_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name    ");
		query.append(" ), ");
		query.append(" AFFILIATE_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID, ");
		query.append(" CASE CHANNEL_BREAKUP_TMP.AFFILIATE WHEN 1 THEN '-----TOTAL AFFILIATE-----' ELSE '-----TOTAL WALGREENS-----' END \"VENDOR_NAME\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",15 \"SORT_ORDER_CHNL\", CHANNEL_BREAKUP_TMP.AFFILIATE ");
		query.append(" from CHANNEL_BREAKUP_TMP, OM_VENDOR where CHANNEL_BREAKUP_TMP.SYS_VENDOR_ID=OM_VENDOR.SYS_VENDOR_ID  ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\",CHANNEL_BREAKUP_TMP.AFFILIATE ");
		query.append(" ),     ");
		query.append(" ALL_DISPLAY_TMP AS (               ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from TOTAL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from CHANNEL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from CHANNEL_BREAKUP_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",AFFILIATE from AFFILIATE_AGGR_TMP         ");
		query.append(" ), ");
		query.append(" HIDE_TMP AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'Mobile' and \"SORT_ORDER_CHNL\"=20     ");
		query.append(" ), ");
		query.append(" HIDE_TMP1 AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'Kiosk' and \"SORT_ORDER_CHNL\"<>10     ");
		query.append(" ), ");
		query.append(" HIDE_TMP2 AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'In-Store' and \"SORT_ORDER_CHNL\"<>10     ");
		query.append(" ), ");
		query.append(" DISPLAY_TMP AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP   ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP1   ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP2   ");
		query.append(" )        ");
		query.append(" select ORDER_ORIGIN_TYPE,vendor_name,\"SORTORDER2\",\"SORT_ORDER_CHNL\",\"SORT_ORDER_CHNL2\",\"AFFILIATE\", ");
		query.append(" \"Yesterday\" \"Yesterday\", \"LstYrSmDay\" \"LstYrSmDay\",ROUND(\"SameDayYOY%\", 2) \"SameDayYOY%\", ");
		query.append(" \"LstYrSmDate\" \"LstYrSmDate\",ROUND(\"SameDateYOY%\", 2) \"SameDateYOY%\" from DISPLAY_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"SORT_ORDER_CHNL2\",AFFILIATE,vendor_name ");
		logger.info(" Finish execution getReport4TotalCost() method in EmailReportQuery.class ");
		return query.toString();
	}

	public static String getReport5OrderPlaced() {
		logger.info(" Start execution getReport5OrderPlaced() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" WITH ");
		query.append(" VENDOR_TMP AS (         ");
		query.append(" select sys_vendor_id,DESCRIPTION as vendor_name,AFFILIATE_CD as AFFILIATE from OM_VENDOR where vendor_type='SOURCE'  and sub_type_cd IN ('INTERNET','MOBILE','KIOSK')  ");
		query.append(" ),  ");
		query.append(" YESTERDAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE,count(1) \"Yesterday\",0 \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,VENDOR_TMP,OM_ORDER_LINE,OM_PRODUCT_CATEGORY_TYPE,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append(" OM_PRODUCT_CATEGORY_LVL1,OM_PRODUCT_CATEGORY_LVL2 ");
		query.append(" where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+) and OM_ORDER_LINE.SYS_ORDER_ID=OM_ORDER.SYS_ORDER_ID  ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID ");
		query.append(" and OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE =? ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME = ? ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE,0 \"Yesterday\",count(1) \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,VENDOR_TMP,OM_ORDER_LINE,OM_PRODUCT_CATEGORY_TYPE,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append(" OM_PRODUCT_CATEGORY_LVL1,OM_PRODUCT_CATEGORY_LVL2 ");
		query.append(" where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+) and OM_ORDER_LINE.SYS_ORDER_ID=OM_ORDER.SYS_ORDER_ID  ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID ");
		query.append(" and OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE =? ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME = ?  ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DATE_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE,0 \"Yesterday\",0 \"LstYrSmDay\",count(1) \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,VENDOR_TMP,OM_ORDER_LINE,OM_PRODUCT_CATEGORY_TYPE,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append(" OM_PRODUCT_CATEGORY_LVL1,OM_PRODUCT_CATEGORY_LVL2 ");
		query.append(" where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+) and OM_ORDER_LINE.SYS_ORDER_ID=OM_ORDER.SYS_ORDER_ID  ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID ");
		query.append(" and OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE =?  ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME = ?  ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");
		query.append(" ), ");
		query.append(" ALL_DAYS_TMP AS ( ");
		query.append(" select * from YESTERDAY_TMP ");
		query.append("  union ");
		query.append(" select * from LAST_YR_SAME_DAY_TMP ");
		query.append("  union ");
		query.append(" select * from LAST_YR_SAME_DATE_TMP ");
		query.append(" ), ");
		query.append(" CHANNEL_BREAKUP_TMP AS (   ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\",  ");
		query.append(" 20 \"SORT_ORDER_CHNL\" ");
		query.append(" from ( ");
		query.append(" select ORDER_ORIGIN_TYPE, SYS_VENDOR_ID,VENDOR_NAME,AFFILIATE, sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\" ");
		query.append(" from ALL_DAYS_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE ");
		query.append(" ) order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ), ");
		query.append(" CHANNEL_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID,'-----TOTAL-----' \"VENDOR_NAME\", -1 \"AFFILIATE\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\" ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ),  ");
		query.append(" TOTAL_AGGR_TMP AS (     ");
		query.append(" select '-----TOTAL-----' \"ORDER_ORIGIN_TYPE\",0 SYS_VENDOR_ID,'' \"VENDOR_NAME\", -1 \"AFFILIATE\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" 0 \"SORTORDER2\",5 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_AGGR_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name    ");
		query.append(" ), ");
		query.append(" AFFILIATE_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID, ");
		query.append(" CASE CHANNEL_BREAKUP_TMP.AFFILIATE WHEN 1 THEN '-----TOTAL AFFILIATE-----' ELSE '-----TOTAL WALGREENS-----' END \"VENDOR_NAME\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",15 \"SORT_ORDER_CHNL\", CHANNEL_BREAKUP_TMP.AFFILIATE ");
		query.append(" from CHANNEL_BREAKUP_TMP, OM_VENDOR where CHANNEL_BREAKUP_TMP.SYS_VENDOR_ID=OM_VENDOR.SYS_VENDOR_ID  ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\",CHANNEL_BREAKUP_TMP.AFFILIATE ");
		query.append(" ),     ");
		query.append(" ALL_DISPLAY_TMP AS (               ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from TOTAL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from CHANNEL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from CHANNEL_BREAKUP_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",AFFILIATE from AFFILIATE_AGGR_TMP         ");
		query.append(" ), ");
		query.append(" HIDE_TMP AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'Mobile' and \"SORT_ORDER_CHNL\"=20     ");
		query.append(" ), ");
		query.append(" HIDE_TMP1 AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'Kiosk' and \"SORT_ORDER_CHNL\"<>10     ");
		query.append(" ), ");
		query.append(" HIDE_TMP2 AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'In-Store' and \"SORT_ORDER_CHNL\"<>10     ");
		query.append(" ), ");
		query.append(" DISPLAY_TMP AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP   ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP1   ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP2   ");
		query.append(" )        ");
		query.append(" select ORDER_ORIGIN_TYPE,vendor_name,\"SORTORDER2\",\"SORT_ORDER_CHNL\",\"SORT_ORDER_CHNL2\",\"AFFILIATE\", ");
		query.append(" \"Yesterday\" \"Yesterday\", \"LstYrSmDay\" \"LstYrSmDay\",ROUND(\"SameDayYOY%\", 2) \"SameDayYOY%\", ");
		query.append(" \"LstYrSmDate\" \"LstYrSmDate\",ROUND(\"SameDateYOY%\", 2) \"SameDateYOY%\" from DISPLAY_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"SORT_ORDER_CHNL2\",AFFILIATE,vendor_name ");
		logger.info(" Finish execution getReport5OrderPlaced() method in EmailReportQuery.class ");
		return query.toString();
	}

	public static String getReport5OrderReceived() {
		logger.info(" Start execution getReport5OrderReceived() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" WITH ");
		query.append(" VENDOR_TMP AS (         ");
		query.append(" select sys_vendor_id,DESCRIPTION vendor_name, ACTIVE_CD AFFILIATE from OM_VENDOR where vendor_type='SOURCE' and sub_type_cd IN ('INTERNET','MOBILE','KIOSK')   ");
		query.append(" ),  ");
		query.append(" YESTERDAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE,count(1) \"Yesterday\",0 \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,VENDOR_TMP,OM_ORDER_LINE,OM_PRODUCT_CATEGORY_TYPE,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append(" OM_PRODUCT_CATEGORY_LVL1,OM_PRODUCT_CATEGORY_LVL2 ");
		query.append(" where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+) and OM_ORDER_LINE.SYS_ORDER_ID=OM_ORDER.SYS_ORDER_ID  ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID ");
		query.append(" and OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE=? ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= TO_DATE( ?, 'DD-MON-YYYY')-195 and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and  OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME=? ");
		query.append(" and OM_ORDER.ORDER_COMPLETED_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and OM_ORDER.ORDER_COMPLETED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		//query.append(" and ORDER_COMPLETED_DTTM IS NOT NULL ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE,0 \"Yesterday\",count(1) \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,VENDOR_TMP,OM_ORDER_LINE,OM_PRODUCT_CATEGORY_TYPE,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append(" OM_PRODUCT_CATEGORY_LVL1,OM_PRODUCT_CATEGORY_LVL2 ");
		query.append(" where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+) and OM_ORDER_LINE.SYS_ORDER_ID=OM_ORDER.SYS_ORDER_ID  ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID ");
		query.append(" and OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE =?  ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= TO_DATE( ?, 'DD-MON-YYYY')-195 and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and  OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME =? ");
		query.append(" and OM_ORDER.ORDER_COMPLETED_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and OM_ORDER.ORDER_COMPLETED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		//query.append(" and ORDER_COMPLETED_DTTM IS NOT NULL ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DATE_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE,0 \"Yesterday\",0 \"LstYrSmDay\",count(1) \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,VENDOR_TMP,OM_ORDER_LINE,OM_PRODUCT_CATEGORY_TYPE,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append(" OM_PRODUCT_CATEGORY_LVL1,OM_PRODUCT_CATEGORY_LVL2 ");
		query.append(" where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+) and OM_ORDER_LINE.SYS_ORDER_ID=OM_ORDER.SYS_ORDER_ID  ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID ");
		query.append(" and OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE=?  ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= TO_DATE( ?, 'DD-MON-YYYY')-195 and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and  OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME=? ");
		query.append(" and OM_ORDER.ORDER_COMPLETED_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and OM_ORDER.ORDER_COMPLETED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		//query.append(" and ORDER_COMPLETED_DTTM IS NOT NULL ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");
		query.append(" ), ");
		query.append(" ALL_DAYS_TMP AS ( ");
		query.append(" select * from YESTERDAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DATE_TMP ");
		query.append(" ), ");
		query.append(" CHANNEL_BREAKUP_TMP AS (   ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\",  ");
		query.append(" 20 \"SORT_ORDER_CHNL\" ");
		query.append("  from ( ");
		query.append(" select ORDER_ORIGIN_TYPE, SYS_VENDOR_ID,VENDOR_NAME,AFFILIATE, sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\" ");
		query.append(" from ALL_DAYS_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE ");
		query.append(" ) order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ), ");
		query.append(" CHANNEL_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID,'-----TOTAL-----' \"VENDOR_NAME\", -1 \"AFFILIATE\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\" ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ),  ");
		query.append(" TOTAL_AGGR_TMP AS (     ");
		query.append(" select '-----TOTAL-----' \"ORDER_ORIGIN_TYPE\",0 SYS_VENDOR_ID,'' \"VENDOR_NAME\", -1 \"AFFILIATE\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" 0 \"SORTORDER2\",5 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_AGGR_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name    ");
		query.append(" ), ");
		query.append(" AFFILIATE_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID, ");
		query.append(" CASE CHANNEL_BREAKUP_TMP.AFFILIATE WHEN 1 THEN '-----TOTAL AFFILIATE-----' ELSE '-----TOTAL WALGREENS-----' END \"VENDOR_NAME\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",15 \"SORT_ORDER_CHNL\", CHANNEL_BREAKUP_TMP.AFFILIATE ");
		query.append(" from CHANNEL_BREAKUP_TMP, OM_VENDOR where CHANNEL_BREAKUP_TMP.SYS_VENDOR_ID=OM_VENDOR.SYS_VENDOR_ID  ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\",CHANNEL_BREAKUP_TMP.AFFILIATE ");
		query.append(" ),     ");
		query.append(" ALL_DISPLAY_TMP AS (               ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from TOTAL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from CHANNEL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from CHANNEL_BREAKUP_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",AFFILIATE from AFFILIATE_AGGR_TMP         ");
		query.append(" ), ");
		query.append(" HIDE_TMP AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'Mobile' and \"SORT_ORDER_CHNL\"=20     ");
		query.append(" ), ");
		query.append(" HIDE_TMP1 AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'Kiosk' and \"SORT_ORDER_CHNL\"<>10     ");
		query.append(" ), ");
		query.append(" HIDE_TMP2 AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'In-Store' and \"SORT_ORDER_CHNL\"<>10     ");
		query.append(" ), ");
		query.append(" DISPLAY_TMP AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP   ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP1   ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP2   ");
		query.append(" )        ");
		query.append(" select ORDER_ORIGIN_TYPE,vendor_name,\"SORTORDER2\",\"SORT_ORDER_CHNL\",\"SORT_ORDER_CHNL2\",\"AFFILIATE\", ");
		query.append(" \"Yesterday\" \"Yesterday\", \"LstYrSmDay\" \"LstYrSmDay\",ROUND(\"SameDayYOY%\", 2) \"SameDayYOY%\", ");
		query.append(" \"LstYrSmDate\" \"LstYrSmDate\",ROUND(\"SameDateYOY%\", 2) \"SameDateYOY%\" from DISPLAY_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"SORT_ORDER_CHNL2\",AFFILIATE,vendor_name       ");
		logger.info(" Finish execution getReport5OrderReceived() method in EmailReportQuery.class ");
		return query.toString();
	}

	public static String getReport5OrderCalcelled() {
		logger.info(" Start execution getReport5OrderCalcelled() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" WITH ");
		query.append(" VENDOR_TMP AS (         ");
		query.append(" select sys_vendor_id,DESCRIPTION vendor_name,AFFILIATE_CD AFFILIATE from OM_VENDOR where vendor_type='SOURCE' and sub_type_cd IN ('INTERNET','MOBILE','KIOSK')   ");
		query.append(" ),  ");
		query.append(" YESTERDAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE,count(1) \"Yesterday\",0 \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,VENDOR_TMP,OM_ORDER_LINE,OM_PRODUCT_CATEGORY_TYPE,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append(" OM_PRODUCT_CATEGORY_LVL1,OM_PRODUCT_CATEGORY_LVL2 ");
		query.append(" where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+) and OM_ORDER_LINE.SYS_ORDER_ID=OM_ORDER.SYS_ORDER_ID  ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID ");
		query.append(" and OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE=?  ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= to_date(?, 'DD-MON-YYYY')-195 and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and OM_ORDER.ORDER_CANCELLED_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and OM_ORDER.ORDER_CANCELLED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME=?   ");
		query.append(" and ORDER_COMPLETED_DTTM IS NOT NULL and ORDER_COMPLETED_DTTM != TO_DATE('01-JAN-0001','DD-MON-YYYY') and STATUS =(?) ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE,0 \"Yesterday\",count(1) \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,VENDOR_TMP,OM_ORDER_LINE,OM_PRODUCT_CATEGORY_TYPE,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append(" OM_PRODUCT_CATEGORY_LVL1,OM_PRODUCT_CATEGORY_LVL2 ");
		query.append(" where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+) and OM_ORDER_LINE.SYS_ORDER_ID=OM_ORDER.SYS_ORDER_ID  ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID ");
		query.append(" and OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE=?  ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= to_date(?, 'DD-MON-YYYY')-195 and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and OM_ORDER.ORDER_CANCELLED_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and OM_ORDER.ORDER_CANCELLED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME =?   ");
		query.append(" and ORDER_COMPLETED_DTTM IS NOT NULL and ORDER_COMPLETED_DTTM != TO_DATE('01-JAN-0001','DD-MON-YYYY') and STATUS =(?) ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DATE_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE,0 \"Yesterday\",0 \"LstYrSmDay\",count(1) \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,VENDOR_TMP,OM_ORDER_LINE,OM_PRODUCT_CATEGORY_TYPE,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append("         OM_PRODUCT_CATEGORY_LVL1,OM_PRODUCT_CATEGORY_LVL2 ");
		query.append(" where SYS_SRC_VENDOR_ID=SYS_VENDOR_ID(+) and OM_ORDER_LINE.SYS_ORDER_ID=OM_ORDER.SYS_ORDER_ID  ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID ");
		query.append(" and OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE=?  ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= to_date(?, 'DD-MON-YYYY')-195 and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and OM_ORDER.ORDER_CANCELLED_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and OM_ORDER.ORDER_CANCELLED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME=?   ");
		query.append(" and ORDER_COMPLETED_DTTM IS NOT NULL and ORDER_COMPLETED_DTTM != TO_DATE('01-JAN-0001','DD-MON-YYYY') and STATUS=(?) ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");
		query.append(" ), ");
		query.append(" ALL_DAYS_TMP AS ( ");
		query.append(" select * from YESTERDAY_TMP ");
		query.append("         union ");
		query.append(" select * from LAST_YR_SAME_DAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DATE_TMP ");
		query.append("  ), ");
		query.append(" CHANNEL_BREAKUP_TMP AS (   ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\",  ");
		query.append(" 20 \"SORT_ORDER_CHNL\" ");
		query.append(" from ( ");
		query.append(" select ORDER_ORIGIN_TYPE, SYS_VENDOR_ID,VENDOR_NAME,AFFILIATE, sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\" ");
		query.append(" from ALL_DAYS_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE ");
		query.append(" ) order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ), ");
		query.append("     CHANNEL_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID,'-----TOTAL-----' \"VENDOR_NAME\", -1 \"AFFILIATE\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append("         \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\" ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ),  ");
		query.append(" TOTAL_AGGR_TMP AS (     ");
		query.append(" select '-----TOTAL-----' \"ORDER_ORIGIN_TYPE\",0 SYS_VENDOR_ID,'' \"VENDOR_NAME\", -1 \"AFFILIATE\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" 0 \"SORTORDER2\",5 \"SORT_ORDER_CHNL\" ");
		query.append("         from CHANNEL_AGGR_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name    ");
		query.append(" ), ");
		query.append(" AFFILIATE_AGGR_TMP AS (");
		query.append(" select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID, ");
		query.append(" CASE CHANNEL_BREAKUP_TMP.AFFILIATE WHEN 1 THEN '-----TOTAL AFFILIATE-----' ELSE '-----TOTAL WALGREENS-----' END \"VENDOR_NAME\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",15 \"SORT_ORDER_CHNL\", CHANNEL_BREAKUP_TMP.AFFILIATE ");
		query.append(" from CHANNEL_BREAKUP_TMP, OM_VENDOR where CHANNEL_BREAKUP_TMP.SYS_VENDOR_ID=OM_VENDOR.SYS_VENDOR_ID  ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\",CHANNEL_BREAKUP_TMP.AFFILIATE ");
		query.append(" ),     ");
		query.append(" ALL_DISPLAY_TMP AS (               ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append("         \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from TOTAL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from CHANNEL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from CHANNEL_BREAKUP_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append("         \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",AFFILIATE from AFFILIATE_AGGR_TMP         ");
		query.append(" ), ");
		query.append(" HIDE_TMP AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'Mobile' and \"SORT_ORDER_CHNL\"=20     ");
		query.append(" ), ");
		query.append(" HIDE_TMP1 AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'Kiosk' and \"SORT_ORDER_CHNL\"<>10     ");
		query.append(" ), ");
		query.append(" HIDE_TMP2 AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'In-Store' and \"SORT_ORDER_CHNL\"<>10     ");
		query.append(" ), ");
		query.append(" DISPLAY_TMP AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP   ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP1   ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP2   ");
		query.append(" )        ");
		query.append(" select ORDER_ORIGIN_TYPE,vendor_name,\"SORTORDER2\",\"SORT_ORDER_CHNL\",\"SORT_ORDER_CHNL2\",\"AFFILIATE\", ");
		query.append(" \"Yesterday\" \"Yesterday\", \"LstYrSmDay\" \"LstYrSmDay\",ROUND(\"SameDayYOY%\", 2) \"SameDayYOY%\", ");
		query.append(" \"LstYrSmDate\" \"LstYrSmDate\",ROUND(\"SameDateYOY%\", 2) \"SameDateYOY%\" from DISPLAY_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"SORT_ORDER_CHNL2\",AFFILIATE,vendor_name       ");
		logger.info(" Finish execution getReport5OrderCalcelled() method in EmailReportQuery.class ");
		return query.toString();
	}
	public static String getReport9TotalQuantity() {
		logger.info(" Start execution getReport9TotalQuantity() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" WITH ");
		query.append(" VENDOR_TMP AS ( ");
		query.append(" select sys_vendor_id,DESCRIPTION as vendor_name ,sub_type_cd,affiliate_cd As AFFILIATE from OM_VENDOR where vendor_type='SOURCE' and sub_type_cd IN ('INTERNET','MOBILE','KIOSK') ");
		query.append(" ), ");
		query.append(" LASTWEEK_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE,count(1) \"LastWeek\",0 \"LstYrSmWeek\" ");
		query.append(" from OM_ORDER,VENDOR_TMP, OM_ORDER_ATTRIBUTE  where  om_order.sys_src_vendor_id =SYS_VENDOR_ID(+) and OM_ORDER_ATTRIBUTE.SYS_ORDER_ID=OM_ORDER.SYS_ORDER_ID ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_ATTRIBUTE.ORDER_PLACED_DTTM ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= to_date(?, 'DD-MON-YYYY')-195 and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and OM_ORDER.ORDER_CANCELLED_DTTM >= to_date(?, 'DD-MON-YYYY') and OM_ORDER.ORDER_CANCELLED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_COMPLETED_DTTM IS NOT NULL and ORDER_COMPLETED_DTTM != TO_DATE('01-JAN-0001','DD-MON-YYYY') and STATUS=?  ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_WEEK_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE,0 \"LastWeek\",count(1) \"LstYrSmWeek\" ");
		query.append(" from OM_ORDER,VENDOR_TMP, OM_ORDER_ATTRIBUTE where sys_src_vendor_id=SYS_VENDOR_ID(+) and OM_ORDER_ATTRIBUTE.SYS_ORDER_ID=OM_ORDER.SYS_ORDER_ID ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_ATTRIBUTE.ORDER_PLACED_DTTM ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= to_date(?, 'DD-MON-YYYY')-195 and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and OM_ORDER.ORDER_CANCELLED_DTTM >= to_date(?, 'DD-MON-YYYY') and OM_ORDER.ORDER_CANCELLED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_COMPLETED_DTTM IS NOT NULL and ORDER_COMPLETED_DTTM != TO_DATE('01-JAN-0001','DD-MON-YYYY') and STATUS=?  ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE ");
		query.append(" ), ");
		query.append(" ALL_DAYS_TMP AS ( ");
		query.append(" select * from LASTWEEK_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_WEEK_TMP ");
		query.append(" ), ");
		query.append(" CHANNEL_BREAKUP_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE,\"LastWeek\", \"LstYrSmWeek\",\"SameWeekYOY%\", ");
		query.append(" CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\", ");
		query.append(" 20 \"SORT_ORDER_CHNL\" ");
		query.append(" from ( ");
		query.append(" select ORDER_ORIGIN_TYPE, SYS_VENDOR_ID,VENDOR_NAME,AFFILIATE, sum(\"LastWeek\") \"LastWeek\", sum(\"LstYrSmWeek\") \"LstYrSmWeek\", ");
		query.append(" case sum(\"LstYrSmWeek\") WHEN 0 THEN 0 ELSE (100*(sum(\"LastWeek\") - sum(\"LstYrSmWeek\"))/sum(\"LstYrSmWeek\")) END \"SameWeekYOY%\" ");
		query.append(" from ALL_DAYS_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE ");
		query.append(" ) order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ), ");
		query.append(" CHANNEL_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID,'-----TOTAL-----' \"VENDOR_NAME\", -1 \"AFFILIATE\",sum(\"LastWeek\") \"LastWeek\", sum(\"LstYrSmWeek\") \"LstYrSmWeek\", ");
		query.append(" case sum(\"LstYrSmWeek\") WHEN 0 THEN 0 ELSE (100*(sum(\"LastWeek\") - sum(\"LstYrSmWeek\"))/sum(\"LstYrSmWeek\")) END \"SameWeekYOY%\", ");
		query.append(" \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\" ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ), ");
		query.append(" TOTAL_AGGR_TMP AS ( ");
		query.append(" select '-----TOTAL-----' \"ORDER_ORIGIN_TYPE\",0 SYS_VENDOR_ID,'' \"VENDOR_NAME\", -1 \"AFFILIATE\",sum(\"LastWeek\") \"LastWeek\", sum(\"LstYrSmWeek\") \"LstYrSmWeek\", ");
		query.append(" case sum(\"LstYrSmWeek\") WHEN 0 THEN 0 ELSE (100*(sum(\"LastWeek\") - sum(\"LstYrSmWeek\"))/sum(\"LstYrSmWeek\")) END \"SameWeekYOY%\", ");
		query.append(" 0 \"SORTORDER2\",5 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_AGGR_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ), ");
		query.append(" AFFILIATE_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID, ");
		query.append(" CASE CHANNEL_BREAKUP_TMP.AFFILIATE WHEN 1 THEN '-----TOTAL AFFILIATE-----' ELSE '-----TOTAL WALGREENS-----' END \"VENDOR_NAME\",sum(\"LastWeek\") \"LastWeek\", sum(\"LstYrSmWeek\") \"LstYrSmWeek\", ");
		query.append(" case sum(\"LstYrSmWeek\") WHEN 0 THEN 0 ELSE (100*(sum(\"LastWeek\") - sum(\"LstYrSmWeek\"))/sum(\"LstYrSmWeek\")) END \"SameWeekYOY%\", ");
		query.append(" \"SORTORDER2\",15 \"SORT_ORDER_CHNL\", CHANNEL_BREAKUP_TMP.AFFILIATE ");
		query.append(" from CHANNEL_BREAKUP_TMP, OM_VENDOR where CHANNEL_BREAKUP_TMP.SYS_VENDOR_ID=OM_VENDOR.SYS_VENDOR_ID ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\",CHANNEL_BREAKUP_TMP.AFFILIATE ");
		query.append(" ), ");
		query.append(" ALL_DISPLAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"LastWeek\", \"LstYrSmWeek\",\"SameWeekYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from TOTAL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"LastWeek\", \"LstYrSmWeek\",\"SameWeekYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from CHANNEL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"LastWeek\", \"LstYrSmWeek\",\"SameWeekYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from CHANNEL_BREAKUP_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"LastWeek\", \"LstYrSmWeek\",\"SameWeekYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from AFFILIATE_AGGR_TMP ");
		query.append(" ), ");
		query.append(" HIDE_TMP AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'Mobile' and \"SORT_ORDER_CHNL\"=20 ");
		query.append(" ), ");
		query.append(" HIDE_TMP1 AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'Kiosk' and \"SORT_ORDER_CHNL\"<>10     ");
		query.append(" ), ");
		query.append(" HIDE_TMP2 AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'In-Store' and \"SORT_ORDER_CHNL\"<>10     ");
		query.append(" ), ");
		query.append(" DISPLAY_TMP AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP1   ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP2   ");
		query.append(" ) ");
		query.append(" select ORDER_ORIGIN_TYPE,vendor_name,\"SORTORDER2\",\"SORT_ORDER_CHNL\",\"SORT_ORDER_CHNL2\",\"AFFILIATE\",  ");
		query.append(" \"LastWeek\" \"LastWeek\", \"LstYrSmWeek\" \"LstYrSmWeek\",ROUND(\"SameWeekYOY%\", 2) \"SameWeekYOY%\" ");
		query.append(" from DISPLAY_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"SORT_ORDER_CHNL2\",\"AFFILIATE\",vendor_name");
		logger.info(" Finish execution getReport9TotalQuantity() method in EmailReportQuery.class ");
		return query.toString();
	}

	public static String getReport9TotalLost() {
		logger.info(" Start execution getReport9TotalLost() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" WITH ");
		query.append(" VENDOR_TMP AS ( ");
		query.append(" select sys_vendor_id,DESCRIPTION as vendor_name ,sub_type_cd,affiliate_cd As AFFILIATE from OM_VENDOR where vendor_type='SOURCE' and sub_type_cd IN ('INTERNET','MOBILE','KIOSK') ");
		query.append(" ), ");
		query.append(" LASTWEEK_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE,sum(ORIGINAL_ORDER_PRICE) \"LastWeek\",0 \"LstYrSmWeek\" ");
		query.append(" from OM_ORDER,VENDOR_TMP, OM_ORDER_ATTRIBUTE  where  om_order.sys_src_vendor_id =SYS_VENDOR_ID(+) and OM_ORDER_ATTRIBUTE.SYS_ORDER_ID=OM_ORDER.SYS_ORDER_ID ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_ATTRIBUTE.ORDER_PLACED_DTTM ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= to_date(?, 'DD-MON-YYYY')-195 and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and OM_ORDER.ORDER_CANCELLED_DTTM >= to_date(?, 'DD-MON-YYYY') and OM_ORDER.ORDER_CANCELLED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_COMPLETED_DTTM IS NOT NULL and ORDER_COMPLETED_DTTM != TO_DATE('01-JAN-0001','DD-MON-YYYY') and STATUS=?  ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_WEEK_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE,0 \"LastWeek\",sum(ORIGINAL_ORDER_PRICE) \"LstYrSmWeek\" ");
		query.append(" from OM_ORDER,VENDOR_TMP, OM_ORDER_ATTRIBUTE where sys_src_vendor_id=SYS_VENDOR_ID(+) and OM_ORDER_ATTRIBUTE.SYS_ORDER_ID=OM_ORDER.SYS_ORDER_ID ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_ATTRIBUTE.ORDER_PLACED_DTTM ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= to_date(?, 'DD-MON-YYYY')-195 and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and OM_ORDER.ORDER_CANCELLED_DTTM >= to_date(?, 'DD-MON-YYYY') and OM_ORDER.ORDER_CANCELLED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM')  ");
		query.append(" and ORDER_COMPLETED_DTTM IS NOT NULL and ORDER_COMPLETED_DTTM != TO_DATE('01-JAN-0001','DD-MON-YYYY') and STATUS=?  ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE ");
		query.append(" ), ");
		query.append(" ALL_DAYS_TMP AS ( ");
		query.append(" select * from LASTWEEK_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_WEEK_TMP ");
		query.append(" ), ");
		query.append(" CHANNEL_BREAKUP_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE,\"LastWeek\", \"LstYrSmWeek\",\"SameWeekYOY%\", ");
		query.append(" CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\", ");
		query.append(" 20 \"SORT_ORDER_CHNL\" ");
		query.append(" from ( ");
		query.append(" select ORDER_ORIGIN_TYPE, SYS_VENDOR_ID,VENDOR_NAME,AFFILIATE, sum(\"LastWeek\") \"LastWeek\", sum(\"LstYrSmWeek\") \"LstYrSmWeek\", ");
		query.append(" case sum(\"LstYrSmWeek\") WHEN 0 THEN 0 ELSE (100*(sum(\"LastWeek\") - sum(\"LstYrSmWeek\"))/sum(\"LstYrSmWeek\")) END \"SameWeekYOY%\" ");
		query.append(" from ALL_DAYS_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE ");
		query.append(" ) order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ), ");
		query.append(" CHANNEL_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID,'-----TOTAL-----' \"VENDOR_NAME\", -1 \"AFFILIATE\",sum(\"LastWeek\") \"LastWeek\", sum(\"LstYrSmWeek\") \"LstYrSmWeek\", ");
		query.append(" case sum(\"LstYrSmWeek\") WHEN 0 THEN 0 ELSE (100*(sum(\"LastWeek\") - sum(\"LstYrSmWeek\"))/sum(\"LstYrSmWeek\")) END \"SameWeekYOY%\", ");
		query.append(" \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\" ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ), ");
		query.append(" TOTAL_AGGR_TMP AS ( ");
		query.append(" select '-----TOTAL-----' \"ORDER_ORIGIN_TYPE\",0 SYS_VENDOR_ID,'' \"VENDOR_NAME\", -1 \"AFFILIATE\",sum(\"LastWeek\") \"LastWeek\", sum(\"LstYrSmWeek\") \"LstYrSmWeek\", ");
		query.append(" case sum(\"LstYrSmWeek\") WHEN 0 THEN 0 ELSE (100*(sum(\"LastWeek\") - sum(\"LstYrSmWeek\"))/sum(\"LstYrSmWeek\")) END \"SameWeekYOY%\", ");
		query.append(" 0 \"SORTORDER2\",5 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_AGGR_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ), ");
		query.append(" AFFILIATE_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID, ");
		query.append(" CASE CHANNEL_BREAKUP_TMP.AFFILIATE WHEN 1 THEN '-----TOTAL AFFILIATE-----' ELSE '-----TOTAL WALGREENS-----' END \"VENDOR_NAME\",sum(\"LastWeek\") \"LastWeek\", sum(\"LstYrSmWeek\") \"LstYrSmWeek\", ");
		query.append(" case sum(\"LstYrSmWeek\") WHEN 0 THEN 0 ELSE (100*(sum(\"LastWeek\") - sum(\"LstYrSmWeek\"))/sum(\"LstYrSmWeek\")) END \"SameWeekYOY%\", ");
		query.append(" \"SORTORDER2\",15 \"SORT_ORDER_CHNL\", CHANNEL_BREAKUP_TMP.AFFILIATE ");
		query.append(" from CHANNEL_BREAKUP_TMP, OM_VENDOR where CHANNEL_BREAKUP_TMP.SYS_VENDOR_ID=OM_VENDOR.SYS_VENDOR_ID ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\",CHANNEL_BREAKUP_TMP.AFFILIATE ");
		query.append(" ), ");
		query.append(" ALL_DISPLAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"LastWeek\", \"LstYrSmWeek\",\"SameWeekYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from TOTAL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"LastWeek\", \"LstYrSmWeek\",\"SameWeekYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from CHANNEL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"LastWeek\", \"LstYrSmWeek\",\"SameWeekYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from CHANNEL_BREAKUP_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"LastWeek\", \"LstYrSmWeek\",\"SameWeekYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",AFFILIATE from AFFILIATE_AGGR_TMP ");
		query.append(" ), ");
		query.append(" HIDE_TMP AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'Mobile' and \"SORT_ORDER_CHNL\"=20 ");
		query.append(" ), ");
		query.append(" HIDE_TMP1 AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'Kiosk' and \"SORT_ORDER_CHNL\"<>10     ");
		query.append(" ), ");
		query.append(" HIDE_TMP2 AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'In-Store' and \"SORT_ORDER_CHNL\"<>10     ");
		query.append(" ), ");
		query.append(" DISPLAY_TMP AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP1   ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP2   ");
		query.append(" ) ");
		query.append(" select ORDER_ORIGIN_TYPE,vendor_name,\"SORTORDER2\",\"SORT_ORDER_CHNL\",\"SORT_ORDER_CHNL2\", \"AFFILIATE\",  ");
		query.append(" \"LastWeek\" \"LastWeek\", \"LstYrSmWeek\" \"LstYrSmWeek\",ROUND(\"SameWeekYOY%\", 2) \"SameWeekYOY%\" ");
		query.append(" from DISPLAY_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"SORT_ORDER_CHNL2\", \"AFFILIATE\", vendor_name      ");
		logger.info(" Finish execution getReport9TotalLost() method in EmailReportQuery.class ");
		return query.toString();
	}

	public static String getReport9TotalCost() {
		logger.info(" Start execution getReport9TotalCost() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" WITH ");
		query.append(" VENDOR_TMP AS ( ");
		query.append(" select sys_vendor_id,DESCRIPTION as vendor_name ,sub_type_cd,affiliate_cd As AFFILIATE from OM_VENDOR where vendor_type='SOURCE' and sub_type_cd IN ('INTERNET','MOBILE','KIOSK') ");
		query.append(" ), ");
		query.append(" LASTWEEK_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE,sum(COST) \"LastWeek\",0 \"LstYrSmWeek\" ");
		query.append(" from OM_ORDER,VENDOR_TMP,OM_ORDER_ATTRIBUTE where  om_order.sys_src_vendor_id =SYS_VENDOR_ID(+) and OM_ORDER_ATTRIBUTE.SYS_ORDER_ID=OM_ORDER.SYS_ORDER_ID ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_ATTRIBUTE.ORDER_PLACED_DTTM ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= to_date(?, 'DD-MON-YYYY')-195 and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and OM_ORDER.ORDER_CANCELLED_DTTM >= to_date(?, 'DD-MON-YYYY') and OM_ORDER.ORDER_CANCELLED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_COMPLETED_DTTM IS NOT NULL and ORDER_COMPLETED_DTTM != TO_DATE('01-JAN-0001','DD-MON-YYYY') and STATUS=?  ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_WEEK_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE,0 \"LastWeek\",sum(COST) \"LstYrSmWeek\" ");
		query.append(" from OM_ORDER,VENDOR_TMP,OM_ORDER_ATTRIBUTE where sys_src_vendor_id=SYS_VENDOR_ID(+) and OM_ORDER_ATTRIBUTE.SYS_ORDER_ID=OM_ORDER.SYS_ORDER_ID ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_ATTRIBUTE.ORDER_PLACED_DTTM ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= to_date(?, 'DD-MON-YYYY')-195 and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and OM_ORDER.ORDER_CANCELLED_DTTM >= to_date(?, 'DD-MON-YYYY') and OM_ORDER.ORDER_CANCELLED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_COMPLETED_DTTM IS NOT NULL and ORDER_COMPLETED_DTTM != TO_DATE('01-JAN-0001','DD-MON-YYYY') and STATUS=?  ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE ");
		query.append(" ), ");
		query.append(" ALL_DAYS_TMP AS ( ");
		query.append(" select * from LASTWEEK_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_WEEK_TMP ");
		query.append(" ), ");
		query.append(" CHANNEL_BREAKUP_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE,\"LastWeek\", \"LstYrSmWeek\",\"SameWeekYOY%\", ");
		query.append(" CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\", ");
		query.append(" 20 \"SORT_ORDER_CHNL\" ");
		query.append(" from ( ");
		query.append(" select ORDER_ORIGIN_TYPE, SYS_VENDOR_ID,VENDOR_NAME,AFFILIATE, sum(\"LastWeek\") \"LastWeek\", sum(\"LstYrSmWeek\") \"LstYrSmWeek\", ");
		query.append(" case sum(\"LstYrSmWeek\") WHEN 0 THEN 0 ELSE (100*(sum(\"LastWeek\") - sum(\"LstYrSmWeek\"))/sum(\"LstYrSmWeek\")) END \"SameWeekYOY%\" ");
		query.append(" from ALL_DAYS_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE ");
		query.append(" ) order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ), ");
		query.append(" CHANNEL_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID,'-----TOTAL-----' \"VENDOR_NAME\", -1 \"AFFILIATE\",sum(\"LastWeek\") \"LastWeek\", sum(\"LstYrSmWeek\") \"LstYrSmWeek\", ");
		query.append(" case sum(\"LstYrSmWeek\") WHEN 0 THEN 0 ELSE (100*(sum(\"LastWeek\") - sum(\"LstYrSmWeek\"))/sum(\"LstYrSmWeek\")) END \"SameWeekYOY%\", ");
		query.append(" \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\" ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ), ");
		query.append(" TOTAL_AGGR_TMP AS ( ");
		query.append(" select '-----TOTAL-----' \"ORDER_ORIGIN_TYPE\",0 SYS_VENDOR_ID,'' \"VENDOR_NAME\", -1 \"AFFILIATE\",sum(\"LastWeek\") \"LastWeek\", sum(\"LstYrSmWeek\") \"LstYrSmWeek\", ");
		query.append(" case sum(\"LstYrSmWeek\") WHEN 0 THEN 0 ELSE (100*(sum(\"LastWeek\") - sum(\"LstYrSmWeek\"))/sum(\"LstYrSmWeek\")) END \"SameWeekYOY%\", ");
		query.append(" 0 \"SORTORDER2\",5 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_AGGR_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ), ");
		query.append(" AFFILIATE_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID, ");
		query.append(" CASE CHANNEL_BREAKUP_TMP.AFFILIATE WHEN 1 THEN '-----TOTAL AFFILIATE-----' ELSE '-----TOTAL WALGREENS-----' END \"VENDOR_NAME\",sum(\"LastWeek\") \"LastWeek\", sum(\"LstYrSmWeek\") \"LstYrSmWeek\", ");
		query.append(" case sum(\"LstYrSmWeek\") WHEN 0 THEN 0 ELSE (100*(sum(\"LastWeek\") - sum(\"LstYrSmWeek\"))/sum(\"LstYrSmWeek\")) END \"SameWeekYOY%\", ");
		query.append(" \"SORTORDER2\",15 \"SORT_ORDER_CHNL\", CHANNEL_BREAKUP_TMP.AFFILIATE ");
		query.append(" from CHANNEL_BREAKUP_TMP, OM_VENDOR where CHANNEL_BREAKUP_TMP.SYS_VENDOR_ID=OM_VENDOR.SYS_VENDOR_ID ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\",CHANNEL_BREAKUP_TMP.AFFILIATE ");
		query.append(" ), ");
		query.append(" ALL_DISPLAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"LastWeek\", \"LstYrSmWeek\",\"SameWeekYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from TOTAL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"LastWeek\", \"LstYrSmWeek\",\"SameWeekYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from CHANNEL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"LastWeek\", \"LstYrSmWeek\",\"SameWeekYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from CHANNEL_BREAKUP_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"LastWeek\", \"LstYrSmWeek\",\"SameWeekYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",AFFILIATE from AFFILIATE_AGGR_TMP ");
		query.append(" ), ");
		query.append(" HIDE_TMP AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'Mobile' and \"SORT_ORDER_CHNL\"=20 ");
		query.append(" ), ");
		query.append(" HIDE_TMP1 AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'Kiosk' and \"SORT_ORDER_CHNL\"<>10     ");
		query.append(" ), ");
		query.append(" HIDE_TMP2 AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'In-Store' and \"SORT_ORDER_CHNL\"<>10     ");
		query.append(" ), ");
		query.append(" DISPLAY_TMP AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP1   ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP2   ");
		query.append(" ) ");
		query.append(" select ORDER_ORIGIN_TYPE,vendor_name,\"SORTORDER2\",\"SORT_ORDER_CHNL\",\"SORT_ORDER_CHNL2\", \"AFFILIATE\", ");
		query.append(" \"LastWeek\" \"LastWeek\", \"LstYrSmWeek\" \"LstYrSmWeek\",ROUND(\"SameWeekYOY%\", 2) \"SameWeekYOY%\" ");
		query.append(" from DISPLAY_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"SORT_ORDER_CHNL2\",\"AFFILIATE\", vendor_name      ");
		logger.info(" Finish execution getReport9TotalCost() method in EmailReportQuery.class ");
		return query.toString();
	}


	public static String getReport10TotalQuantity() {
		logger.info(" Start execution getReport10TotalQuantity() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" WITH ");
		query.append(" VENDOR_TMP AS (         ");
		query.append(" select sys_vendor_id,DESCRIPTION as vendor_name ,sub_type_cd,affiliate_cd As AFFILIATE from OM_VENDOR where vendor_type='SOURCE' and sub_type_cd IN ('INTERNET','MOBILE','KIOSK')  ");
		query.append(" ),  ");
		query.append(" LAST_MONTH_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE,count(1) \"LastMonth\",0 \"LstYrSmMonth\" ");
		query.append(" from OM_ORDER,VENDOR_TMP, OM_ORDER_ATTRIBUTE  where  om_order.sys_src_vendor_id =SYS_VENDOR_ID(+) and OM_ORDER_ATTRIBUTE.SYS_ORDER_ID=OM_ORDER.SYS_ORDER_ID  ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_ATTRIBUTE.ORDER_PLACED_DTTM ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= to_date(?, 'DD-MON-YYYY')-195 and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and OM_ORDER.ORDER_CANCELLED_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and OM_ORDER.ORDER_CANCELLED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_COMPLETED_DTTM IS NOT NULL and ORDER_COMPLETED_DTTM != TO_DATE('01-JAN-0001','DD-MON-YYYY') and STATUS=?  ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_MONTH_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE,0 \"LastMonth\",count(1) \"LstYrSmMonth\" ");
		query.append(" from OM_ORDER,VENDOR_TMP, OM_ORDER_ATTRIBUTE where sys_src_vendor_id=SYS_VENDOR_ID(+) and OM_ORDER_ATTRIBUTE.SYS_ORDER_ID=OM_ORDER.SYS_ORDER_ID ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_ATTRIBUTE.ORDER_PLACED_DTTM ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= to_date(?, 'DD-MON-YYYY')-195 and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and OM_ORDER.ORDER_CANCELLED_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and OM_ORDER.ORDER_CANCELLED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_COMPLETED_DTTM IS NOT NULL and ORDER_COMPLETED_DTTM != TO_DATE('01-JAN-0001','DD-MON-YYYY') and STATUS=?  ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");
		query.append(" ), ");
		query.append(" ALL_DAYS_TMP AS ( ");
		query.append(" select * from LAST_MONTH_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_MONTH_TMP ");
		query.append(" ), ");
		query.append(" CHANNEL_BREAKUP_TMP AS (   ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE,\"LastMonth\", \"LstYrSmMonth\",\"SameMonthYOY%\", ");
		query.append(" CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\",  ");
		query.append(" 20 \"SORT_ORDER_CHNL\" ");
		query.append(" from ( ");
		query.append(" select ORDER_ORIGIN_TYPE, SYS_VENDOR_ID,VENDOR_NAME,AFFILIATE, sum(\"LastMonth\") \"LastMonth\", sum(\"LstYrSmMonth\") \"LstYrSmMonth\", ");
		query.append(" case sum(\"LstYrSmMonth\") WHEN 0 THEN 0 ELSE (100*(sum(\"LastMonth\") - sum(\"LstYrSmMonth\"))/sum(\"LstYrSmMonth\")) END \"SameMonthYOY%\" ");
		query.append(" from ALL_DAYS_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE ");
		query.append(" ) order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ), ");
		query.append(" CHANNEL_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID,'-----TOTAL-----' \"VENDOR_NAME\", -1 AFFILIATE ,sum(\"LastMonth\") \"LastMonth\", sum(\"LstYrSmMonth\") \"LstYrSmMonth\", ");
		query.append(" case sum(\"LstYrSmMonth\") WHEN 0 THEN 0 ELSE (100*(sum(\"LastMonth\") - sum(\"LstYrSmMonth\"))/sum(\"LstYrSmMonth\")) END \"SameMonthYOY%\", ");
		query.append(" \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\" ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ),  ");
		query.append(" TOTAL_AGGR_TMP AS (     ");
		query.append(" select '-----TOTAL-----' \"ORDER_ORIGIN_TYPE\",0 SYS_VENDOR_ID,'' \"VENDOR_NAME\", -1 AFFILIATE,sum(\"LastMonth\") \"LastMonth\", sum(\"LstYrSmMonth\") \"LstYrSmMonth\", ");
		query.append(" case sum(\"LstYrSmMonth\") WHEN 0 THEN 0 ELSE (100*(sum(\"LastMonth\") - sum(\"LstYrSmMonth\"))/sum(\"LstYrSmMonth\")) END \"SameMonthYOY%\", ");
		query.append(" 0 \"SORTORDER2\",5 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_AGGR_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name    ");
		query.append(" ), ");
		query.append(" AFFILIATE_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID, ");
		query.append(" CASE CHANNEL_BREAKUP_TMP.AFFILIATE WHEN 1 THEN '-----TOTAL AFFILIATE-----' ELSE '-----TOTAL WALGREENS-----' END \"VENDOR_NAME\",sum(\"LastMonth\") \"LastMonth\", sum(\"LstYrSmMonth\") \"LstYrSmMonth\", ");
		query.append(" case sum(\"LstYrSmMonth\") WHEN 0 THEN 0 ELSE (100*(sum(\"LastMonth\") - sum(\"LstYrSmMonth\"))/sum(\"LstYrSmMonth\")) END \"SameMonthYOY%\", ");
		query.append(" \"SORTORDER2\",15 \"SORT_ORDER_CHNL\", CHANNEL_BREAKUP_TMP.AFFILIATE ");
		query.append(" from CHANNEL_BREAKUP_TMP, OM_VENDOR where CHANNEL_BREAKUP_TMP.SYS_VENDOR_ID=OM_VENDOR.SYS_VENDOR_ID  ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\",CHANNEL_BREAKUP_TMP.AFFILIATE ");
		query.append(" ),     ");
		query.append(" ALL_DISPLAY_TMP AS (               ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"LastMonth\", \"LstYrSmMonth\",\"SameMonthYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",AFFILIATE from TOTAL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"LastMonth\", \"LstYrSmMonth\",\"SameMonthYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",AFFILIATE from CHANNEL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"LastMonth\", \"LstYrSmMonth\",\"SameMonthYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",AFFILIATE from AFFILIATE_AGGR_TMP         ");
		query.append(" ), ");
		query.append(" HIDE_TMP AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'Mobile' and \"SORT_ORDER_CHNL\"=20     ");
		query.append(" ), ");
		query.append(" HIDE_TMP1 AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'Kiosk' and \"SORT_ORDER_CHNL\"<>10     ");
		query.append(" ), ");
		query.append(" HIDE_TMP2 AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'In-Store' and \"SORT_ORDER_CHNL\"<>10     ");
		query.append(" ), ");
		query.append(" DISPLAY_TMP AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP   ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP1   ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP2   ");
		query.append(" )        ");
		query.append(" select ORDER_ORIGIN_TYPE,vendor_name,\"SORTORDER2\",\"SORT_ORDER_CHNL\",\"SORT_ORDER_CHNL2\",AFFILIATE, ");
		query.append(" \"LastMonth\" \"LastMonth\", \"LstYrSmMonth\" \"LstYrSmMonth\",ROUND(\"SameMonthYOY%\", 2) \"SameMonthYOY%\" ");
		query.append(" from DISPLAY_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"SORT_ORDER_CHNL2\",AFFILIATE,vendor_name   ");
		logger.info(" Finish execution getReport10TotalQuantity() method in EmailReportQuery.class ");
		return query.toString();
	}

	public static String getReport10TotalLost() {
		logger.info(" Start execution getReport10TotalLost() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" WITH ");
		query.append(" VENDOR_TMP AS (         ");
		query.append(" select sys_vendor_id,DESCRIPTION as vendor_name ,sub_type_cd,affiliate_cd As AFFILIATE from OM_VENDOR where vendor_type='SOURCE' and sub_type_cd IN ('INTERNET','MOBILE','KIOSK')  ");
		query.append(" ),  ");
		query.append(" LAST_MONTH_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE,sum(ORIGINAL_ORDER_PRICE) \"LastMonth\",0 \"LstYrSmMonth\" ");
		query.append(" from OM_ORDER,VENDOR_TMP,OM_ORDER_ATTRIBUTE  where  om_order.sys_src_vendor_id =SYS_VENDOR_ID(+) and OM_ORDER_ATTRIBUTE.SYS_ORDER_ID=OM_ORDER.SYS_ORDER_ID  ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_ATTRIBUTE.ORDER_PLACED_DTTM ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= to_date(?, 'DD-MON-YYYY')-195 and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and OM_ORDER.ORDER_CANCELLED_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and OM_ORDER.ORDER_CANCELLED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_COMPLETED_DTTM IS NOT NULL and ORDER_COMPLETED_DTTM != TO_DATE('01-JAN-0001','DD-MON-YYYY') and STATUS=?  ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_MONTH_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE,0 \"LastMonth\",sum(ORIGINAL_ORDER_PRICE) \"LstYrSmMonth\" ");
		query.append(" from OM_ORDER,VENDOR_TMP,OM_ORDER_ATTRIBUTE  where  om_order.sys_src_vendor_id =SYS_VENDOR_ID(+) and OM_ORDER_ATTRIBUTE.SYS_ORDER_ID=OM_ORDER.SYS_ORDER_ID ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_ATTRIBUTE.ORDER_PLACED_DTTM ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= to_date(?, 'DD-MON-YYYY')-195 and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and OM_ORDER.ORDER_CANCELLED_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and OM_ORDER.ORDER_CANCELLED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_COMPLETED_DTTM IS NOT NULL and ORDER_COMPLETED_DTTM != TO_DATE('01-JAN-0001','DD-MON-YYYY') and STATUS=?  ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE  ");
		query.append(" ), ");
		query.append(" ALL_DAYS_TMP AS ( ");
		query.append(" select * from LAST_MONTH_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_MONTH_TMP ");
		query.append(" ), ");
		query.append(" CHANNEL_BREAKUP_TMP AS (   ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE,\"LastMonth\", \"LstYrSmMonth\",\"SameMonthYOY%\", ");
		query.append(" CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\",  ");
		query.append(" 20 \"SORT_ORDER_CHNL\" ");
		query.append(" from ( ");
		query.append(" select ORDER_ORIGIN_TYPE, SYS_VENDOR_ID,VENDOR_NAME,AFFILIATE, sum(\"LastMonth\") \"LastMonth\", sum(\"LstYrSmMonth\") \"LstYrSmMonth\", ");
		query.append(" case sum(\"LstYrSmMonth\") WHEN 0 THEN 0 ELSE (100*(sum(\"LastMonth\") - sum(\"LstYrSmMonth\"))/sum(\"LstYrSmMonth\")) END \"SameMonthYOY%\" ");
		query.append(" from ALL_DAYS_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE ");
		query.append(" ) order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ), ");
		query.append(" CHANNEL_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID,'-----TOTAL-----' \"VENDOR_NAME\", -1 AFFILIATE,sum(\"LastMonth\") \"LastMonth\", sum(\"LstYrSmMonth\") \"LstYrSmMonth\", ");
		query.append(" case sum(\"LstYrSmMonth\") WHEN 0 THEN 0 ELSE (100*(sum(\"LastMonth\") - sum(\"LstYrSmMonth\"))/sum(\"LstYrSmMonth\")) END \"SameMonthYOY%\", ");
		query.append(" \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\" ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ),  ");
		query.append(" TOTAL_AGGR_TMP AS (     ");
		query.append(" select '-----TOTAL-----' \"ORDER_ORIGIN_TYPE\",0 SYS_VENDOR_ID,'' \"VENDOR_NAME\", -1 AFFILIATE,sum(\"LastMonth\") \"LastMonth\", sum(\"LstYrSmMonth\") \"LstYrSmMonth\", ");
		query.append(" case sum(\"LstYrSmMonth\") WHEN 0 THEN 0 ELSE (100*(sum(\"LastMonth\") - sum(\"LstYrSmMonth\"))/sum(\"LstYrSmMonth\")) END \"SameMonthYOY%\", ");
		query.append(" 0 \"SORTORDER2\",5 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_AGGR_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name    ");
		query.append(" ), ");
		query.append(" AFFILIATE_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID, ");
		query.append(" CASE CHANNEL_BREAKUP_TMP.AFFILIATE WHEN 1 THEN '-----TOTAL AFFILIATE-----' ELSE '-----TOTAL WALGREENS-----' END \"VENDOR_NAME\",sum(\"LastMonth\") \"LastMonth\", sum(\"LstYrSmMonth\") \"LstYrSmMonth\", ");
		query.append(" case sum(\"LstYrSmMonth\") WHEN 0 THEN 0 ELSE (100*(sum(\"LastMonth\") - sum(\"LstYrSmMonth\"))/sum(\"LstYrSmMonth\")) END \"SameMonthYOY%\", ");
		query.append(" \"SORTORDER2\",15 \"SORT_ORDER_CHNL\", CHANNEL_BREAKUP_TMP.AFFILIATE ");
		query.append(" from CHANNEL_BREAKUP_TMP, OM_VENDOR where CHANNEL_BREAKUP_TMP.SYS_VENDOR_ID=OM_VENDOR.SYS_VENDOR_ID  ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\",CHANNEL_BREAKUP_TMP.AFFILIATE ");
		query.append(" ),     ");
		query.append(" ALL_DISPLAY_TMP AS (               ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"LastMonth\", \"LstYrSmMonth\",\"SameMonthYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from TOTAL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"LastMonth\", \"LstYrSmMonth\",\"SameMonthYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" AFFILIATE from CHANNEL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"LastMonth\", \"LstYrSmMonth\",\"SameMonthYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from CHANNEL_BREAKUP_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"LastMonth\", \"LstYrSmMonth\",\"SameMonthYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",\"AFFILIATE\" from AFFILIATE_AGGR_TMP         ");
		query.append(" ), ");
		query.append(" HIDE_TMP AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'Mobile' and \"SORT_ORDER_CHNL\"=20     ");
		query.append(" ), ");
		query.append(" HIDE_TMP1 AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'Kiosk' and \"SORT_ORDER_CHNL\"<>10     ");
		query.append(" ), ");
		query.append(" HIDE_TMP2 AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'In-Store' and \"SORT_ORDER_CHNL\"<>10     ");
		query.append(" ), ");
		query.append(" DISPLAY_TMP AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP   ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP1   ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP2   ");
		query.append(" )        ");
		query.append(" select ORDER_ORIGIN_TYPE,vendor_name,\"SORTORDER2\",\"SORT_ORDER_CHNL\",\"SORT_ORDER_CHNL2\",\"AFFILIATE\", ");
		query.append(" \"LastMonth\" \"LastMonth\", \"LstYrSmMonth\" \"LstYrSmMonth\",ROUND(\"SameMonthYOY%\", 2) \"SameMonthYOY%\" ");
		query.append(" from DISPLAY_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"SORT_ORDER_CHNL2\",\"AFFILIATE\",vendor_name   ");
		logger.info(" Finish execution getReport10TotalLost() method in EmailReportQuery.class ");
		return query.toString();
	}

	public static String getReport10TotalCost() {
		logger.info(" Start execution getReport10TotalCost() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" WITH ");
		query.append(" VENDOR_TMP AS (         ");
		query.append(" select sys_vendor_id,DESCRIPTION as vendor_name ,sub_type_cd,affiliate_cd As AFFILIATE from OM_VENDOR where vendor_type='SOURCE' and sub_type_cd IN ('INTERNET','MOBILE','KIOSK')  ");
		query.append(" ),  ");
		query.append(" LAST_MONTH_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE,sum(COST) \"LastMonth\",0 \"LstYrSmMonth\" ");
		query.append(" from OM_ORDER,VENDOR_TMP, om_order_attribute where  om_order.sys_src_vendor_id =SYS_VENDOR_ID(+) and om_order_attribute.SYS_ORDER_ID=OM_ORDER.SYS_ORDER_ID  ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_ATTRIBUTE.ORDER_PLACED_DTTM ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= to_date(?, 'DD-MON-YYYY')-195 and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and OM_ORDER.ORDER_CANCELLED_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and OM_ORDER.ORDER_CANCELLED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_COMPLETED_DTTM IS NOT NULL and ORDER_COMPLETED_DTTM != TO_DATE('01-JAN-0001','DD-MON-YYYY') and STATUS=?  ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_MONTH_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,nvl(SYS_VENDOR_ID,(select SYS_VENDOR_ID from OM_VENDOR where vendor_nbr=0)) as SYS_VENDOR_ID,vendor_name,nvl(AFFILIATE,0) as AFFILIATE,0 \"LastMonth\",sum(COST) \"LstYrSmMonth\" ");
		query.append(" from OM_ORDER,VENDOR_TMP , om_order_attribute where sys_src_vendor_id=SYS_VENDOR_ID(+) and om_order_attribute.SYS_ORDER_ID=OM_ORDER.SYS_ORDER_ID ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_ATTRIBUTE.ORDER_PLACED_DTTM ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= to_date(?, 'DD-MON-YYYY')-195 and OM_ORDER.ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and OM_ORDER.ORDER_CANCELLED_DTTM >=  TO_DATE( ?, 'DD-MON-YYYY') and OM_ORDER.ORDER_CANCELLED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_COMPLETED_DTTM IS NOT NULL and ORDER_COMPLETED_DTTM != TO_DATE('01-JAN-0001','DD-MON-YYYY') and STATUS=?  ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE ");
		query.append(" ), ");
		query.append(" ALL_DAYS_TMP AS ( ");
		query.append(" select * from LAST_MONTH_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_MONTH_TMP ");
		query.append(" ), ");
		query.append(" CHANNEL_BREAKUP_TMP AS (   ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE,\"LastMonth\", \"LstYrSmMonth\",\"SameMonthYOY%\", ");
		query.append(" CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\",  ");
		query.append(" 20 \"SORT_ORDER_CHNL\" ");
		query.append(" from ( ");
		query.append(" select ORDER_ORIGIN_TYPE, SYS_VENDOR_ID,VENDOR_NAME,AFFILIATE, sum(\"LastMonth\") \"LastMonth\", sum(\"LstYrSmMonth\") \"LstYrSmMonth\", ");
		query.append(" case sum(\"LstYrSmMonth\") WHEN 0 THEN 0 ELSE (100*(sum(\"LastMonth\") - sum(\"LstYrSmMonth\"))/sum(\"LstYrSmMonth\")) END \"SameMonthYOY%\" ");
		query.append(" from ALL_DAYS_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,AFFILIATE ");
		query.append(" ) order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ), ");
		query.append(" CHANNEL_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID,'-----TOTAL-----' \"VENDOR_NAME\", -1 \"AFFILIATE\",sum(\"LastMonth\") \"LastMonth\", sum(\"LstYrSmMonth\") \"LstYrSmMonth\", ");
		query.append(" case sum(\"LstYrSmMonth\") WHEN 0 THEN 0 ELSE (100*(sum(\"LastMonth\") - sum(\"LstYrSmMonth\"))/sum(\"LstYrSmMonth\")) END \"SameMonthYOY%\", ");
		query.append(" \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\" ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name ");
		query.append(" ),  ");
		query.append(" TOTAL_AGGR_TMP AS (     ");
		query.append(" select '-----TOTAL-----' \"ORDER_ORIGIN_TYPE\",0 SYS_VENDOR_ID,'' \"VENDOR_NAME\", -1 \"AFFILIATE\",sum(\"LastMonth\") \"LastMonth\", sum(\"LstYrSmMonth\") \"LstYrSmMonth\", ");
		query.append(" case sum(\"LstYrSmMonth\") WHEN 0 THEN 0 ELSE (100*(sum(\"LastMonth\") - sum(\"LstYrSmMonth\"))/sum(\"LstYrSmMonth\")) END \"SameMonthYOY%\", ");
		query.append(" 0 \"SORTORDER2\",5 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_AGGR_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name    ");
		query.append(" ), ");
		query.append(" AFFILIATE_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 SYS_VENDOR_ID, ");
		query.append(" CASE CHANNEL_BREAKUP_TMP.AFFILIATE WHEN 1 THEN '-----TOTAL AFFILIATE-----' ELSE '-----TOTAL WALGREENS-----' END \"VENDOR_NAME\",sum(\"LastMonth\") \"LastMonth\", sum(\"LstYrSmMonth\") \"LstYrSmMonth\", ");
		query.append(" case sum(\"LstYrSmMonth\") WHEN 0 THEN 0 ELSE (100*(sum(\"LastMonth\") - sum(\"LstYrSmMonth\"))/sum(\"LstYrSmMonth\")) END \"SameMonthYOY%\", ");
		query.append(" \"SORTORDER2\",15 \"SORT_ORDER_CHNL\", CHANNEL_BREAKUP_TMP.AFFILIATE ");
		query.append(" from CHANNEL_BREAKUP_TMP, OM_VENDOR where CHANNEL_BREAKUP_TMP.SYS_VENDOR_ID=OM_VENDOR.SYS_VENDOR_ID  ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\",CHANNEL_BREAKUP_TMP.AFFILIATE ");
		query.append(" ),     ");
		query.append(" ALL_DISPLAY_TMP AS (               ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"LastMonth\", \"LstYrSmMonth\",\"SameMonthYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",AFFILIATE from TOTAL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"LastMonth\", \"LstYrSmMonth\",\"SameMonthYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",AFFILIATE from CHANNEL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"LastMonth\", \"LstYrSmMonth\",\"SameMonthYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",AFFILIATE from CHANNEL_BREAKUP_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,SYS_VENDOR_ID,vendor_name,\"LastMonth\", \"LstYrSmMonth\",\"SameMonthYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",AFFILIATE from AFFILIATE_AGGR_TMP         ");
		query.append(" ), ");
		query.append(" HIDE_TMP AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'Mobile' and \"SORT_ORDER_CHNL\"=20     ");
		query.append(" ), ");
		query.append(" HIDE_TMP1 AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'Kiosk' and \"SORT_ORDER_CHNL\"<>10     ");
		query.append(" ), ");
		query.append(" HIDE_TMP2 AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP where ORDER_ORIGIN_TYPE = 'In-Store' and \"SORT_ORDER_CHNL\"<>10     ");
		query.append(" ), ");
		query.append(" DISPLAY_TMP AS ( ");
		query.append(" select * from ALL_DISPLAY_TMP ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP   ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP1   ");
		query.append(" MINUS ");
		query.append(" select * from HIDE_TMP2   ");
		query.append(" )        ");
		query.append(" select ORDER_ORIGIN_TYPE,vendor_name,\"SORTORDER2\",\"SORT_ORDER_CHNL\",\"SORT_ORDER_CHNL2\",AFFILIATE,  ");
		query.append(" \"LastMonth\" \"LastMonth\", \"LstYrSmMonth\" \"LstYrSmMonth\",ROUND(\"SameMonthYOY%\", 2) \"SameMonthYOY%\" ");
		query.append(" from DISPLAY_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"SORT_ORDER_CHNL2\",AFFILIATE, vendor_name ");
		logger.info(" Finish execution getReport10TotalCost() method in EmailReportQuery.class ");
		return query.toString();
	}

	public static String getReport7AggregateOrderPlaced() {
		logger.info(" Start execution getReport7AggregateOrderPlaced() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" with ");
		query.append(" YESTERDAY_STEP1_TMP AS ( ");
		// query.append(" -- Get records from yesterday same hour to  tomorrow same hour. This ensures we consider all timezones ");
		query.append(" select OM_ORDER.SYS_ORDER_ID,SYS_OWNING_LOC_ID,ORDER_PLACED_DTTM,ORDER_ORIGIN_TYPE,FINAL_PRICE, ((6+OWNING_LOC_TZ_OFFSET)*60) \"CST_OFF_SET\" from OM_ORDER ");
		query.append(" where ORDER_PLACED_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" ), ");
		query.append(" YESTERDAY_STEP2_TMP AS (  ");
		// query.append(" -- Get CST offset from OM_LOCATION table and convert ORDER_PLACED_DTTM to CST ");
		query.append(" select SYS_ORDER_ID,ORDER_ORIGIN_TYPE,FINAL_PRICE, ");
		query.append(" (YESTERDAY_STEP1_TMP.ORDER_PLACED_DTTM - NUMTODSINTERVAL(YESTERDAY_STEP1_TMP.CST_OFF_SET , 'MINUTE')) ");
		query.append(" \"ORDER_PLACED_CST_DTTM\" from YESTERDAY_STEP1_TMP ");
		query.append(" ), ");
		query.append("    ");
		query.append(" YESTERDAY_TMP AS ( ");
		query.append(" select YESTERDAY_STEP2_TMP.ORDER_ORIGIN_TYPE,sum(YESTERDAY_STEP2_TMP.FINAL_PRICE) \"Yesterday\",0 \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from YESTERDAY_STEP2_TMP  ");
		query.append(" where ORDER_PLACED_CST_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_CST_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE  ");
		query.append(" ), ");

		query.append(" LAST_YR_SAME_DAY_STEP1_TMP AS ( ");
		// query.append(" -- Get records from last year same day - 1 same hour to  tomorrow same hour. This ensures we consider all timezones ");
		query.append(" select OM_ORDER.SYS_ORDER_ID,SYS_OWNING_LOC_ID,ORDER_PLACED_DTTM,ORDER_ORIGIN_TYPE,FINAL_PRICE, ((6+OWNING_LOC_TZ_OFFSET)*60) \"CST_OFF_SET\" from OM_ORDER ");
		query.append(" where ORDER_PLACED_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DAY_STEP2_TMP AS ( ");
		// query.append(" -- Get CST offset from OM_LOCATION table and convert ORDER_PLACED_DTTM to CST ");
		query.append(" select SYS_ORDER_ID,ORDER_ORIGIN_TYPE,FINAL_PRICE, ");
		query.append(" (LAST_YR_SAME_DAY_STEP1_TMP.ORDER_PLACED_DTTM - NUMTODSINTERVAL(LAST_YR_SAME_DAY_STEP1_TMP.CST_OFF_SET , 'MINUTE')) ");
		query.append(" \"ORDER_PLACED_CST_DTTM\" ");
		query.append(" from LAST_YR_SAME_DAY_STEP1_TMP ");

		query.append(" ),     ");
		query.append(" LAST_YR_SAME_DAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 \"Yesterday\",sum(LAST_YR_SAME_DAY_STEP2_TMP.FINAL_PRICE) \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from LAST_YR_SAME_DAY_STEP2_TMP ");
		query.append(" where ORDER_PLACED_CST_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_CST_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DATE_STEP1_TMP AS ( ");
		// query.append(" -- Get records from last year same day - 1 same hour to  tomorrow same hour. This ensures we consider all timezones ");
		query.append(" select OM_ORDER.SYS_ORDER_ID,SYS_OWNING_LOC_ID,ORDER_PLACED_DTTM,ORDER_ORIGIN_TYPE,FINAL_PRICE, ((6+OWNING_LOC_TZ_OFFSET)*60) \"CST_OFF_SET\"  from OM_ORDER ");
		query.append(" where ORDER_PLACED_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DATE_STEP2_TMP AS ( ");
		// query.append(" -- Get CST offset from OM_LOCATION table and convert ORDER_PLACED_DTTM to CST ");
		query.append(" select SYS_ORDER_ID,ORDER_ORIGIN_TYPE,FINAL_PRICE, ");
		query.append(" (LAST_YR_SAME_DATE_STEP1_TMP.ORDER_PLACED_DTTM - NUMTODSINTERVAL(LAST_YR_SAME_DATE_STEP1_TMP.CST_OFF_SET , 'MINUTE')) \"ORDER_PLACED_CST_DTTM\" ");
		query.append(" from LAST_YR_SAME_DATE_STEP1_TMP ");
		query.append(" ),    ");
		query.append(" LAST_YR_SAME_DATE_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 \"Yesterday\",0 \"LstYrSmDay\",sum(LAST_YR_SAME_DATE_STEP2_TMP.FINAL_PRICE) \"LstYrSmDate\" ");
		query.append(" from LAST_YR_SAME_DATE_STEP2_TMP ");
		query.append(" where ORDER_PLACED_CST_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_CST_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" ALL_DAYS_TMP AS ( ");
		query.append(" select * from YESTERDAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DATE_TMP ");
		query.append(" ), ");
		query.append(" CHANNEL_BREAKUP_TMP AS (   ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\",  ");
		query.append(" 20 \"SORT_ORDER_CHNL\" ");
		query.append(" from ( ");
		query.append(" select ORDER_ORIGIN_TYPE, sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\" ");
		query.append(" from ALL_DAYS_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE ");
		query.append(" ) order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" CHANNEL_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\" ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ");
		query.append(" ),  ");
		query.append(" TOTAL_AGGR_TMP AS (     ");
		query.append(" select 'TOTAL' \"ORDER_ORIGIN_TYPE\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" 0 \"SORTORDER2\",5 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_AGGR_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" ALL_DISPLAY_TMP AS (               ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",'AFFILIATE' from TOTAL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",'AFFILIATE' from CHANNEL_AGGR_TMP ");
		query.append(" ) ");
		query.append(" select ORDER_ORIGIN_TYPE,\"SORTORDER2\",\"SORT_ORDER_CHNL\",\"SORT_ORDER_CHNL2\", ");
		query.append(" \"Yesterday\" \"Yesterday\", \"LstYrSmDay\" \"LstYrSmDay\",ROUND(\"SameDayYOY%\", 2) \"SameDayYOY%\", ");
		query.append(" \"LstYrSmDate\" \"LstYrSmDate\",ROUND(\"SameDateYOY%\", 2) \"SameDateYOY%\" from ALL_DISPLAY_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"SORT_ORDER_CHNL2\" ");
		logger.info(" Finish execution getReport7AggregateOrderPlaced() method in EmailReportQuery.class ");
		return query.toString();
	}

	
	
	public static String getReport7AggregateOrderPlacedGifts() {
		logger.info(" Start execution getReport7AggregateOrderPlaced() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" with ");
		query.append(" YESTERDAY_STEP1_TMP AS ( ");
		// query.append(" -- Get records from yesterday same hour to  tomorrow same hour. This ensures we consider all timezones ");
		query.append(" select OM_ORDER.SYS_ORDER_ID,SYS_OWNING_LOC_ID,ORDER_PLACED_DTTM,ORDER_ORIGIN_TYPE, ((6+OWNING_LOC_TZ_OFFSET)*60) \"CST_OFF_SET\" from OM_ORDER ");
		query.append(" where ORDER_PLACED_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" ), ");
		query.append(" YESTERDAY_STEP2_TMP AS (  ");
		// query.append(" -- Get CST offset from OM_LOCATION table and convert ORDER_PLACED_DTTM to CST ");
		query.append(" select SYS_ORDER_ID,ORDER_ORIGIN_TYPE, ORDER_PLACED_DTTM, ");
		query.append(" (YESTERDAY_STEP1_TMP.ORDER_PLACED_DTTM - NUMTODSINTERVAL(YESTERDAY_STEP1_TMP.CST_OFF_SET , 'MINUTE')) ");
		query.append(" \"ORDER_PLACED_CST_DTTM\" from YESTERDAY_STEP1_TMP ");
		query.append(" ), ");
		query.append("    ");
		query.append(" YESTERDAY_TMP AS ( ");
		query.append(" select YESTERDAY_STEP2_TMP.ORDER_ORIGIN_TYPE,sum(OM_ORDER_LINE.FINAL_PRICE) \"Yesterday\",0 \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from YESTERDAY_STEP2_TMP ,OM_ORDER_LINE ,OM_PRODUCT_CATEGORY_TYPE ,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append(" OM_PRODUCT_CATEGORY_LVL1 ,OM_PRODUCT_CATEGORY_LVL2  ");
		query.append(" where OM_ORDER_LINE.SYS_ORDER_ID=YESTERDAY_STEP2_TMP.SYS_ORDER_ID   ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID  ");
		query.append(" and YESTERDAY_STEP2_TMP.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID  ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID  ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID  ");
		query.append(" and OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE = ? ");
		query.append(" and OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME= ?   ");
		query.append(" and ORDER_PLACED_CST_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_CST_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE  ");
		query.append(" ), ");

		query.append(" LAST_YR_SAME_DAY_STEP1_TMP AS ( ");
		// query.append(" -- Get records from last year same day - 1 same hour to  tomorrow same hour. This ensures we consider all timezones ");
		query.append(" select OM_ORDER.SYS_ORDER_ID,SYS_OWNING_LOC_ID,ORDER_PLACED_DTTM,ORDER_ORIGIN_TYPE, ((6+OWNING_LOC_TZ_OFFSET)*60) \"CST_OFF_SET\" from OM_ORDER ");
		query.append(" where ORDER_PLACED_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DAY_STEP2_TMP AS ( ");
		// query.append(" -- Get CST offset from OM_LOCATION table and convert ORDER_PLACED_DTTM to CST ");
		query.append(" select SYS_ORDER_ID,ORDER_ORIGIN_TYPE, ORDER_PLACED_DTTM, ");
		query.append(" (LAST_YR_SAME_DAY_STEP1_TMP.ORDER_PLACED_DTTM - NUMTODSINTERVAL(LAST_YR_SAME_DAY_STEP1_TMP.CST_OFF_SET , 'MINUTE')) ");
		query.append(" \"ORDER_PLACED_CST_DTTM\" ");
		query.append(" from LAST_YR_SAME_DAY_STEP1_TMP ");

		query.append(" ),     ");
		query.append(" LAST_YR_SAME_DAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 \"Yesterday\",sum(OM_ORDER_LINE.FINAL_PRICE) \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from LAST_YR_SAME_DAY_STEP2_TMP,OM_ORDER_LINE,OM_PRODUCT_CATEGORY_TYPE,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append(" OM_PRODUCT_CATEGORY_LVL1,OM_PRODUCT_CATEGORY_LVL2 ");
		query.append(" where OM_ORDER_LINE.sys_ORDER_ID=LAST_YR_SAME_DAY_STEP2_TMP.SYS_ORDER_ID  ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID ");
		query.append(" and LAST_YR_SAME_DAY_STEP2_TMP.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID ");
		query.append(" and OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE = ? ");
		query.append(" and OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME=?   ");
		query.append(" and ORDER_PLACED_CST_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_CST_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DATE_STEP1_TMP AS ( ");
		// query.append(" -- Get records from last year same day - 1 same hour to  tomorrow same hour. This ensures we consider all timezones ");
		query.append(" select OM_ORDER.SYS_ORDER_ID,SYS_OWNING_LOC_ID,ORDER_PLACED_DTTM,ORDER_ORIGIN_TYPE, ((6+OWNING_LOC_TZ_OFFSET)*60) \"CST_OFF_SET\"  from OM_ORDER ");
		query.append(" where ORDER_PLACED_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DATE_STEP2_TMP AS ( ");
		// query.append(" -- Get CST offset from OM_LOCATION table and convert ORDER_PLACED_DTTM to CST ");
		query.append(" select SYS_ORDER_ID,ORDER_ORIGIN_TYPE, ORDER_PLACED_DTTM, ");
		query.append(" (LAST_YR_SAME_DATE_STEP1_TMP.ORDER_PLACED_DTTM - NUMTODSINTERVAL(LAST_YR_SAME_DATE_STEP1_TMP.CST_OFF_SET , 'MINUTE')) \"ORDER_PLACED_CST_DTTM\" ");
		query.append(" from LAST_YR_SAME_DATE_STEP1_TMP ");
		query.append(" ),    ");
		query.append(" LAST_YR_SAME_DATE_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 \"Yesterday\",0 \"LstYrSmDay\",sum(OM_ORDER_LINE.FINAL_PRICE) \"LstYrSmDate\" ");
		query.append(" from LAST_YR_SAME_DATE_STEP2_TMP,OM_ORDER_LINE,OM_PRODUCT_CATEGORY_TYPE,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append(" OM_PRODUCT_CATEGORY_LVL1,OM_PRODUCT_CATEGORY_LVL2 ");
		query.append(" where OM_ORDER_LINE.sys_ORDER_ID=LAST_YR_SAME_DATE_STEP2_TMP.SYS_ORDER_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID ");
		query.append(" and LAST_YR_SAME_DATE_STEP2_TMP.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID ");
		query.append(" and OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE = ? ");
		query.append(" and OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME=? ");
		query.append(" and ORDER_PLACED_CST_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_CST_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" ALL_DAYS_TMP AS ( ");
		query.append(" select * from YESTERDAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DATE_TMP ");
		query.append(" ), ");
		query.append(" CHANNEL_BREAKUP_TMP AS (   ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\",  ");
		query.append(" 20 \"SORT_ORDER_CHNL\" ");
		query.append(" from ( ");
		query.append(" select ORDER_ORIGIN_TYPE, sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\" ");
		query.append(" from ALL_DAYS_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE ");
		query.append(" ) order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" CHANNEL_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\" ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ");
		query.append(" ),  ");
		query.append(" TOTAL_AGGR_TMP AS (     ");
		query.append(" select 'TOTAL' \"ORDER_ORIGIN_TYPE\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" 0 \"SORTORDER2\",5 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_AGGR_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" ALL_DISPLAY_TMP AS (               ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",'AFFILIATE' from TOTAL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",'AFFILIATE' from CHANNEL_AGGR_TMP ");
		query.append(" ) ");
		query.append(" select ORDER_ORIGIN_TYPE,\"SORTORDER2\",\"SORT_ORDER_CHNL\",\"SORT_ORDER_CHNL2\", ");
		query.append(" \"Yesterday\" \"Yesterday\", \"LstYrSmDay\" \"LstYrSmDay\",ROUND(\"SameDayYOY%\", 2) \"SameDayYOY%\", ");
		query.append(" \"LstYrSmDate\" \"LstYrSmDate\",ROUND(\"SameDateYOY%\", 2) \"SameDateYOY%\" from ALL_DISPLAY_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"SORT_ORDER_CHNL2\" ");
		logger.info(" Finish execution getReport7AggregateOrderPlaced() method in EmailReportQuery.class ");
		return query.toString();
	}
	
	public static String getReport7AggregateOrderSold() {
		logger.info(" Start execution getReport7AggregateOrderSold() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" WITH ");
		query.append(" YESTERDAY_STEP1_TMP AS ( ");
		// query.append(" -- Get records from 195 days since orders placed 6 months back can be cancelled today ");
		query.append(" select OM_ORDER.SYS_ORDER_ID,SYS_OWNING_LOC_ID,ORDER_SOLD_DTTM, ORDER_ORIGIN_TYPE,SOLD_AMOUNT, ((6+OWNING_LOC_TZ_OFFSET)*60) \"CST_OFF_SET\" from OM_ORDER ");
		query.append(" where ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY')-195 and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_SOLD_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_SOLD_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ), ");
		query.append(" YESTERDAY_STEP2_TMP AS ( ");
		// query.append(" -- Get CST offset from OM_LOCATION table and convert ORDER_SOLD_DTTM to CST ");
		query.append(" select SYS_ORDER_ID,ORDER_ORIGIN_TYPE,SOLD_AMOUNT, ");
		query.append(" (YESTERDAY_STEP1_TMP.ORDER_SOLD_DTTM - NUMTODSINTERVAL(YESTERDAY_STEP1_TMP.CST_OFF_SET , 'MINUTE')) ");
		query.append(" \"ORDER_SOLD_CST_DTTM\" from YESTERDAY_STEP1_TMP ");
		query.append(" ),     ");
		query.append(" YESTERDAY_TMP AS ( ");
		query.append(" select YESTERDAY_STEP2_TMP.ORDER_ORIGIN_TYPE,sum(SOLD_AMOUNT) \"Yesterday\",0 \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from YESTERDAY_STEP2_TMP  ");
		query.append(" where  ORDER_SOLD_CST_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_SOLD_CST_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE  ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DAY_STEP1_TMP AS ( ");
		// query.append(" -- Get records from 195 days since orders placed 6 months back can be cancelled today ");
		query.append(" select OM_ORDER.SYS_ORDER_ID,SYS_OWNING_LOC_ID,ORDER_SOLD_DTTM,ORDER_ORIGIN_TYPE,SOLD_AMOUNT, ((6+OWNING_LOC_TZ_OFFSET)*60) \"CST_OFF_SET\" from OM_ORDER ");
		query.append(" where ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY')-195 and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_SOLD_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_SOLD_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM')), ");
		query.append(" LAST_YR_SAME_DAY_STEP2_TMP AS ( ");
		// query.append(" -- Get CST offset from OM_LOCATION table and convert ORDER_SOLD_DTTM to CST ");
		query.append(" select SYS_ORDER_ID,ORDER_ORIGIN_TYPE,SOLD_AMOUNT, ");
		query.append(" (LAST_YR_SAME_DAY_STEP1_TMP.ORDER_SOLD_DTTM - NUMTODSINTERVAL(LAST_YR_SAME_DAY_STEP1_TMP.CST_OFF_SET , 'MINUTE')) ");
		query.append(" \"ORDER_SOLD_CST_DTTM\" ");
		query.append(" from LAST_YR_SAME_DAY_STEP1_TMP ");
		query.append(" ),     ");
		query.append(" LAST_YR_SAME_DAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 \"Yesterday\",sum(SOLD_AMOUNT) \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from LAST_YR_SAME_DAY_STEP2_TMP ");
		query.append(" where ORDER_SOLD_CST_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_SOLD_CST_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DATE_STEP1_TMP AS ( ");
		// query.append(" -- Get records from 195 days since orders placed 6 months back can be cancelled today ");
		query.append(" select OM_ORDER.SYS_ORDER_ID,SYS_OWNING_LOC_ID,ORDER_SOLD_DTTM,ORDER_ORIGIN_TYPE,SOLD_AMOUNT ,((6+OWNING_LOC_TZ_OFFSET)*60) \"CST_OFF_SET\"  from OM_ORDER ");
		query.append(" where ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY')-195 and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_SOLD_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_SOLD_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM')), ");
		query.append(" LAST_YR_SAME_DATE_STEP2_TMP AS ( ");
		// query.append(" -- Get CST offset from OM_LOCATION table and convert ORDER_SOLD_DTTM to CST ");
		query.append(" select SYS_ORDER_ID,ORDER_ORIGIN_TYPE,SOLD_AMOUNT, ");
		query.append(" (LAST_YR_SAME_DATE_STEP1_TMP.ORDER_SOLD_DTTM - NUMTODSINTERVAL(LAST_YR_SAME_DATE_STEP1_TMP.CST_OFF_SET , 'MINUTE')) \"ORDER_SOLD_CST_DTTM\" ");
		query.append(" from LAST_YR_SAME_DATE_STEP1_TMP ");
		query.append(" ),    ");
		query.append("     LAST_YR_SAME_DATE_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 \"Yesterday\",0 \"LstYrSmDay\",sum(SOLD_AMOUNT) \"LstYrSmDate\" ");
		query.append(" from LAST_YR_SAME_DATE_STEP2_TMP ");
		query.append(" where ORDER_SOLD_CST_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_SOLD_CST_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" ALL_DAYS_TMP AS ( ");
		query.append(" select * from YESTERDAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DATE_TMP ");
		query.append(" ), ");
		query.append(" CHANNEL_BREAKUP_TMP AS (   ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\",  ");
		query.append(" 20 \"SORT_ORDER_CHNL\" ");
		query.append(" from ( ");
		query.append(" select ORDER_ORIGIN_TYPE, sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\" ");
		query.append(" from ALL_DAYS_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE ");
		query.append(" ) order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" CHANNEL_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\" ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ");
		query.append(" ),  ");
		query.append(" TOTAL_AGGR_TMP AS (     ");
		query.append(" select 'TOTAL' \"ORDER_ORIGIN_TYPE\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" 0 \"SORTORDER2\",5 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_AGGR_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" ALL_DISPLAY_TMP AS (               ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",'AFFILIATE' from TOTAL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",'AFFILIATE' from CHANNEL_AGGR_TMP ");
		query.append(" ) ");
		query.append(" select ORDER_ORIGIN_TYPE,\"SORTORDER2\",\"SORT_ORDER_CHNL\",\"SORT_ORDER_CHNL2\", ");
		query.append(" \"Yesterday\" \"Yesterday\", \"LstYrSmDay\" \"LstYrSmDay\",ROUND(\"SameDayYOY%\", 2) \"SameDayYOY%\", ");
		query.append(" \"LstYrSmDate\" \"LstYrSmDate\",ROUND(\"SameDateYOY%\", 2) \"SameDateYOY%\" from ALL_DISPLAY_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"SORT_ORDER_CHNL2\" ");
		logger.info(" Finish execution getReport7AggregateOrderSold() method in EmailReportQuery.class ");
		return query.toString();
	}

	public static String getReport7AggregateOrderSoldGifts() {
		logger.info(" Start execution getReport7AggregateOrderSold() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" WITH ");
		query.append(" YESTERDAY_STEP1_TMP AS ( ");
		// query.append(" -- Get records from 195 days since orders placed 6 months back can be cancelled today ");
		query.append(" select OM_ORDER.SYS_ORDER_ID,SYS_OWNING_LOC_ID,ORDER_SOLD_DTTM, ORDER_ORIGIN_TYPE,ORDER_PLACED_DTTM, ((6+OWNING_LOC_TZ_OFFSET)*60) \"CST_OFF_SET\" from OM_ORDER ");
		query.append(" where ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY')-195 and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_SOLD_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_SOLD_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ), ");
		query.append(" YESTERDAY_STEP2_TMP AS ( ");
		// query.append(" -- Get CST offset from OM_LOCATION table and convert ORDER_SOLD_DTTM to CST ");
		query.append(" select SYS_ORDER_ID,ORDER_ORIGIN_TYPE,ORDER_PLACED_DTTM, ");
		query.append(" (YESTERDAY_STEP1_TMP.ORDER_SOLD_DTTM - NUMTODSINTERVAL(YESTERDAY_STEP1_TMP.CST_OFF_SET , 'MINUTE')) ");
		query.append(" \"ORDER_SOLD_CST_DTTM\" from YESTERDAY_STEP1_TMP ");
		query.append(" ),     ");
		query.append(" YESTERDAY_TMP AS ( ");
		query.append(" select YESTERDAY_STEP2_TMP.ORDER_ORIGIN_TYPE,sum(OM_ORDER_LINE.LINE_SOLD_AMOUNT) \"Yesterday\",0 \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from YESTERDAY_STEP2_TMP ,OM_ORDER_LINE ,OM_PRODUCT_CATEGORY_TYPE ,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append(" OM_PRODUCT_CATEGORY_LVL1 ,OM_PRODUCT_CATEGORY_LVL2  ");
		query.append(" where OM_ORDER_LINE.SYS_ORDER_ID=YESTERDAY_STEP2_TMP.SYS_ORDER_ID   ");
		query.append(" and YESTERDAY_STEP2_TMP.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID  ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID  ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID  ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID  ");
		query.append(" and OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE =?  ");
			query.append(" and OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME= ?  ");
		query.append(" and ORDER_SOLD_CST_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_SOLD_CST_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE  ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DAY_STEP1_TMP AS ( ");
		// query.append(" -- Get records from 195 days since orders placed 6 months back can be cancelled today ");
		query.append(" select OM_ORDER.SYS_ORDER_ID,SYS_OWNING_LOC_ID,ORDER_SOLD_DTTM,ORDER_ORIGIN_TYPE,ORDER_PLACED_DTTM, ((6+OWNING_LOC_TZ_OFFSET)*60) \"CST_OFF_SET\" from OM_ORDER ");
		query.append(" where ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY')-195 and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_SOLD_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_SOLD_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM')), ");
		query.append(" LAST_YR_SAME_DAY_STEP2_TMP AS ( ");
		// query.append(" -- Get CST offset from OM_LOCATION table and convert ORDER_SOLD_DTTM to CST ");
		query.append(" select SYS_ORDER_ID,ORDER_ORIGIN_TYPE,ORDER_PLACED_DTTM, ");
		query.append(" (LAST_YR_SAME_DAY_STEP1_TMP.ORDER_SOLD_DTTM - NUMTODSINTERVAL(LAST_YR_SAME_DAY_STEP1_TMP.CST_OFF_SET , 'MINUTE')) ");
		query.append(" \"ORDER_SOLD_CST_DTTM\" ");
		query.append(" from LAST_YR_SAME_DAY_STEP1_TMP ");
		query.append(" ),     ");
		query.append(" LAST_YR_SAME_DAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 \"Yesterday\",sum(OM_ORDER_LINE.LINE_SOLD_AMOUNT) \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from LAST_YR_SAME_DAY_STEP2_TMP,OM_ORDER_LINE,OM_PRODUCT_CATEGORY_TYPE,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append(" OM_PRODUCT_CATEGORY_LVL1,OM_PRODUCT_CATEGORY_LVL2 ");
		query.append(" where OM_ORDER_LINE.sys_ORDER_ID=LAST_YR_SAME_DAY_STEP2_TMP.SYS_ORDER_ID  ");
		query.append(" and  LAST_YR_SAME_DAY_STEP2_TMP.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID ");
		query.append(" and OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE =?  ");
			query.append(" and OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME=? ");
		query.append(" and ORDER_SOLD_CST_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_SOLD_CST_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DATE_STEP1_TMP AS ( ");
		// query.append(" -- Get records from 195 days since orders placed 6 months back can be cancelled today ");
		query.append(" select OM_ORDER.SYS_ORDER_ID,SYS_OWNING_LOC_ID,ORDER_SOLD_DTTM,ORDER_ORIGIN_TYPE,ORDER_PLACED_DTTM ,((6+OWNING_LOC_TZ_OFFSET)*60) \"CST_OFF_SET\"  from OM_ORDER ");
		query.append(" where ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY')-195 and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_SOLD_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_SOLD_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM')), ");
		query.append(" LAST_YR_SAME_DATE_STEP2_TMP AS ( ");
		// query.append(" -- Get CST offset from OM_LOCATION table and convert ORDER_SOLD_DTTM to CST ");
		query.append(" select SYS_ORDER_ID,ORDER_ORIGIN_TYPE,ORDER_PLACED_DTTM, ");
		query.append(" (LAST_YR_SAME_DATE_STEP1_TMP.ORDER_SOLD_DTTM - NUMTODSINTERVAL(LAST_YR_SAME_DATE_STEP1_TMP.CST_OFF_SET , 'MINUTE')) \"ORDER_SOLD_CST_DTTM\" ");
		query.append(" from LAST_YR_SAME_DATE_STEP1_TMP ");
		query.append(" ),    ");
		query.append("     LAST_YR_SAME_DATE_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 \"Yesterday\",0 \"LstYrSmDay\",sum(OM_ORDER_LINE.LINE_SOLD_AMOUNT) \"LstYrSmDate\" ");
		query.append(" from LAST_YR_SAME_DATE_STEP2_TMP,OM_ORDER_LINE,OM_PRODUCT_CATEGORY_TYPE,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append(" OM_PRODUCT_CATEGORY_LVL1,OM_PRODUCT_CATEGORY_LVL2 ");
		query.append(" where OM_ORDER_LINE.sys_ORDER_ID=LAST_YR_SAME_DATE_STEP2_TMP.SYS_ORDER_ID ");
		query.append(" and LAST_YR_SAME_DATE_STEP2_TMP.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM  ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID ");
		query.append(" and OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE =?  ");
		query.append(" and OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME=? ");
		query.append(" and ORDER_SOLD_CST_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_SOLD_CST_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" ALL_DAYS_TMP AS ( ");
		query.append(" select * from YESTERDAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DATE_TMP ");
		query.append(" ), ");
		query.append(" CHANNEL_BREAKUP_TMP AS (   ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\",  ");
		query.append(" 20 \"SORT_ORDER_CHNL\" ");
		query.append(" from ( ");
		query.append(" select ORDER_ORIGIN_TYPE, sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\" ");
		query.append(" from ALL_DAYS_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE ");
		query.append(" ) order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" CHANNEL_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\" ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ");
		query.append(" ),  ");
		query.append(" TOTAL_AGGR_TMP AS (     ");
		query.append(" select 'TOTAL' \"ORDER_ORIGIN_TYPE\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" 0 \"SORTORDER2\",5 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_AGGR_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" ALL_DISPLAY_TMP AS (               ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",'AFFILIATE' from TOTAL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",'AFFILIATE' from CHANNEL_AGGR_TMP ");
		query.append(" ) ");
		query.append(" select ORDER_ORIGIN_TYPE,\"SORTORDER2\",\"SORT_ORDER_CHNL\",\"SORT_ORDER_CHNL2\", ");
		query.append(" \"Yesterday\" \"Yesterday\", \"LstYrSmDay\" \"LstYrSmDay\",ROUND(\"SameDayYOY%\", 2) \"SameDayYOY%\", ");
		query.append(" \"LstYrSmDate\" \"LstYrSmDate\",ROUND(\"SameDateYOY%\", 2) \"SameDateYOY%\" from ALL_DISPLAY_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"SORT_ORDER_CHNL2\" ");
		logger.info(" Finish execution getReport7AggregateOrderSold() method in EmailReportQuery.class ");
		return query.toString();
	}

	public static String getReport7AggregateOrderPlacedCount() {
		logger.info(" Start execution getReport7AggregateOrderPlacedCount() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" with  ");
		query.append(" YESTERDAY_STEP1_TMP AS ( ");
		// query.append(" -- Get records from yesterday same hour to  tomorrow same hour. This ensures we consider all timezones ");
		query.append("   select OM_ORDER.SYS_ORDER_ID,SYS_OWNING_LOC_ID,ORDER_PLACED_DTTM,ORDER_ORIGIN_TYPE, ((6+OWNING_LOC_TZ_OFFSET)*60) \"CST_OFF_SET\" from OM_ORDER ");
		query.append(" where ORDER_PLACED_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" ), ");
		query.append(" YESTERDAY_STEP2_TMP AS (  ");
		// query.append(" -- Get CST offset from OM_LOCATION table and convert ORDER_PLACED_DTTM to CST ");
		query.append(" select SYS_ORDER_ID,ORDER_ORIGIN_TYPE, ");
		query.append(" (YESTERDAY_STEP1_TMP.ORDER_PLACED_DTTM - NUMTODSINTERVAL(YESTERDAY_STEP1_TMP.CST_OFF_SET , 'MINUTE')) ");
		query.append(" \"ORDER_PLACED_CST_DTTM\" from YESTERDAY_STEP1_TMP ");
		query.append(" ),    ");
		query.append(" YESTERDAY_TMP AS ( ");
		query.append(" select YESTERDAY_STEP2_TMP.ORDER_ORIGIN_TYPE,count(1) \"Yesterday\",0 \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from YESTERDAY_STEP2_TMP ");
		query.append(" where ORDER_PLACED_CST_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_CST_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE  ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DAY_STEP1_TMP AS ( ");
		// query.append(" -- Get records from last year same day - 1 same hour to  tomorrow same hour. This ensures we consider all timezones ");
		query.append(" select OM_ORDER.SYS_ORDER_ID,SYS_OWNING_LOC_ID,ORDER_PLACED_DTTM,ORDER_ORIGIN_TYPE, ((6+OWNING_LOC_TZ_OFFSET)*60) \"CST_OFF_SET\" from OM_ORDER ");
		query.append(" where ORDER_PLACED_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DAY_STEP2_TMP AS ( ");
		// query.append(" -- Get CST offset from OM_LOCATION table and convert ORDER_PLACED_DTTM to CST ");
		query.append(" select SYS_ORDER_ID,ORDER_ORIGIN_TYPE, ");
		query.append(" (LAST_YR_SAME_DAY_STEP1_TMP.ORDER_PLACED_DTTM - NUMTODSINTERVAL(LAST_YR_SAME_DAY_STEP1_TMP.CST_OFF_SET , 'MINUTE')) ");
		query.append(" \"ORDER_PLACED_CST_DTTM\" ");
		query.append(" from LAST_YR_SAME_DAY_STEP1_TMP ");

		query.append(" ),    ");
		query.append(" LAST_YR_SAME_DAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 \"Yesterday\",count(1) \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from LAST_YR_SAME_DAY_STEP2_TMP  ");
		query.append(" where ORDER_PLACED_CST_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_CST_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DATE_STEP1_TMP AS ( ");
		// query.append(" -- Get records from last year same day - 1 same hour to  tomorrow same hour. This ensures we consider all timezones ");
		query.append(" select OM_ORDER.SYS_ORDER_ID,SYS_OWNING_LOC_ID,ORDER_PLACED_DTTM,ORDER_ORIGIN_TYPE, ((6+OWNING_LOC_TZ_OFFSET)*60) \"CST_OFF_SET\"  from OM_ORDER ");
		query.append(" where ORDER_PLACED_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DATE_STEP2_TMP AS ( ");
		// query.append(" -- Get CST offset from OM_LOCATION table and convert ORDER_PLACED_DTTM to CST ");
		query.append(" select SYS_ORDER_ID,ORDER_ORIGIN_TYPE, ");
		query.append(" (LAST_YR_SAME_DATE_STEP1_TMP.ORDER_PLACED_DTTM - NUMTODSINTERVAL(LAST_YR_SAME_DATE_STEP1_TMP.CST_OFF_SET , 'MINUTE')) \"ORDER_PLACED_CST_DTTM\" ");
		query.append(" from LAST_YR_SAME_DATE_STEP1_TMP ");
		query.append(" ),   ");
		query.append(" LAST_YR_SAME_DATE_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 \"Yesterday\",0 \"LstYrSmDay\",count(1) \"LstYrSmDate\" ");
		query.append(" from LAST_YR_SAME_DATE_STEP2_TMP ");
		query.append(" where ORDER_PLACED_CST_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_CST_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" ALL_DAYS_TMP AS ( ");
		query.append(" select * from YESTERDAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DATE_TMP ");
		query.append(" ), ");
		query.append(" CHANNEL_BREAKUP_TMP AS (   ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\",  ");
		query.append(" 20 \"SORT_ORDER_CHNL\" ");
		query.append(" from ( ");
		query.append(" select ORDER_ORIGIN_TYPE, sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\" ");
		query.append(" from ALL_DAYS_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE ");
		query.append(" ) order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" CHANNEL_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\" ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ");
		query.append(" ),  ");
		query.append(" TOTAL_AGGR_TMP AS (     ");
		query.append(" select 'TOTAL' \"ORDER_ORIGIN_TYPE\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" 0 \"SORTORDER2\",5 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_AGGR_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" ALL_DISPLAY_TMP AS (               ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",'AFFILIATE' from TOTAL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",'AFFILIATE' from CHANNEL_AGGR_TMP     ");
		query.append(" ) ");
		query.append(" select ORDER_ORIGIN_TYPE,\"SORTORDER2\",\"SORT_ORDER_CHNL\",\"SORT_ORDER_CHNL2\", ");
		query.append(" \"Yesterday\" \"Yesterday\", \"LstYrSmDay\" \"LstYrSmDay\",ROUND(\"SameDayYOY%\", 2) \"SameDayYOY%\", ");
		query.append(" \"LstYrSmDate\" \"LstYrSmDate\",ROUND(\"SameDateYOY%\", 2) \"SameDateYOY%\" from ALL_DISPLAY_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"SORT_ORDER_CHNL2\" ");
		logger.info(" Finish execution getReport7AggregateOrderPlacedCount() method in EmailReportQuery.class ");
		return query.toString();
	}

	
	public static String getReport7AggregateOrderPlacedCountGifts() {
		logger.info(" Start execution getReport7AggregateOrderPlacedCount() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" with  ");
		query.append(" YESTERDAY_STEP1_TMP AS ( ");
		// query.append(" -- Get records from yesterday same hour to  tomorrow same hour. This ensures we consider all timezones ");
		query.append("   select OM_ORDER.SYS_ORDER_ID,SYS_OWNING_LOC_ID,ORDER_PLACED_DTTM,ORDER_ORIGIN_TYPE, ((6+OWNING_LOC_TZ_OFFSET)*60) \"CST_OFF_SET\" from OM_ORDER ");
		query.append(" where ORDER_PLACED_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" ), ");
		query.append(" YESTERDAY_STEP2_TMP AS (  ");
		// query.append(" -- Get CST offset from OM_LOCATION table and convert ORDER_PLACED_DTTM to CST ");
		query.append(" select SYS_ORDER_ID,ORDER_ORIGIN_TYPE, ORDER_PLACED_DTTM, ");
		query.append(" (YESTERDAY_STEP1_TMP.ORDER_PLACED_DTTM - NUMTODSINTERVAL(YESTERDAY_STEP1_TMP.CST_OFF_SET , 'MINUTE')) ");
		query.append(" \"ORDER_PLACED_CST_DTTM\" from YESTERDAY_STEP1_TMP ");
		query.append(" ),    ");
		query.append(" YESTERDAY_TMP AS ( ");
		query.append(" select YESTERDAY_STEP2_TMP.ORDER_ORIGIN_TYPE,count( distinct YESTERDAY_STEP2_TMP.SYS_ORDER_ID) \"Yesterday\",0 \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from YESTERDAY_STEP2_TMP ,OM_ORDER_LINE ,OM_PRODUCT_CATEGORY_TYPE ,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append(" OM_PRODUCT_CATEGORY_LVL1 ,OM_PRODUCT_CATEGORY_LVL2  ");
		query.append(" where OM_ORDER_LINE.SYS_ORDER_ID=YESTERDAY_STEP2_TMP.SYS_ORDER_ID   ");
		query.append(" and YESTERDAY_STEP2_TMP.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID  ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID  ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID  ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID  ");
		query.append(" and OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE = ? ");
		query.append(" and OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME= ?  ");
		query.append(" and ORDER_PLACED_CST_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_CST_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE  ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DAY_STEP1_TMP AS ( ");
		// query.append(" -- Get records from last year same day - 1 same hour to  tomorrow same hour. This ensures we consider all timezones ");
		query.append(" select OM_ORDER.SYS_ORDER_ID,SYS_OWNING_LOC_ID,ORDER_PLACED_DTTM,ORDER_ORIGIN_TYPE, ((6+OWNING_LOC_TZ_OFFSET)*60) \"CST_OFF_SET\" from OM_ORDER ");
		query.append(" where ORDER_PLACED_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DAY_STEP2_TMP AS ( ");
		// query.append(" -- Get CST offset from OM_LOCATION table and convert ORDER_PLACED_DTTM to CST ");
		query.append(" select SYS_ORDER_ID,ORDER_ORIGIN_TYPE, ORDER_PLACED_DTTM , ");
		query.append(" (LAST_YR_SAME_DAY_STEP1_TMP.ORDER_PLACED_DTTM - NUMTODSINTERVAL(LAST_YR_SAME_DAY_STEP1_TMP.CST_OFF_SET , 'MINUTE')) ");
		query.append(" \"ORDER_PLACED_CST_DTTM\" ");
		query.append(" from LAST_YR_SAME_DAY_STEP1_TMP ");

		query.append(" ),    ");
		query.append(" LAST_YR_SAME_DAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 \"Yesterday\",count(distinct LAST_YR_SAME_DAY_STEP2_TMP.SYS_ORDER_ID) \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from LAST_YR_SAME_DAY_STEP2_TMP,OM_ORDER_LINE,OM_PRODUCT_CATEGORY_TYPE,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append(" OM_PRODUCT_CATEGORY_LVL1,OM_PRODUCT_CATEGORY_LVL2 ");
		query.append(" where OM_ORDER_LINE.sys_ORDER_ID=LAST_YR_SAME_DAY_STEP2_TMP.SYS_ORDER_ID  ");
		query.append(" and LAST_YR_SAME_DAY_STEP2_TMP.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID ");
		query.append(" and OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE = ? ");
		query.append(" and OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME= ?  ");
		query.append(" and ORDER_PLACED_CST_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_CST_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DATE_STEP1_TMP AS ( ");
		// query.append(" -- Get records from last year same day - 1 same hour to  tomorrow same hour. This ensures we consider all timezones ");
		query.append(" select OM_ORDER.SYS_ORDER_ID,SYS_OWNING_LOC_ID,ORDER_PLACED_DTTM,ORDER_ORIGIN_TYPE, ((6+OWNING_LOC_TZ_OFFSET)*60) \"CST_OFF_SET\"  from OM_ORDER ");
		query.append(" where ORDER_PLACED_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DATE_STEP2_TMP AS ( ");
		// query.append(" -- Get CST offset from OM_LOCATION table and convert ORDER_PLACED_DTTM to CST ");
		query.append(" select SYS_ORDER_ID,ORDER_ORIGIN_TYPE, ORDER_PLACED_DTTM , ");
		query.append(" (LAST_YR_SAME_DATE_STEP1_TMP.ORDER_PLACED_DTTM - NUMTODSINTERVAL(LAST_YR_SAME_DATE_STEP1_TMP.CST_OFF_SET , 'MINUTE')) \"ORDER_PLACED_CST_DTTM\" ");
		query.append(" from LAST_YR_SAME_DATE_STEP1_TMP ");
		query.append(" ),   ");
		query.append(" LAST_YR_SAME_DATE_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 \"Yesterday\",0 \"LstYrSmDay\",count(distinct LAST_YR_SAME_DATE_STEP2_TMP.SYS_ORDER_ID ) \"LstYrSmDate\" ");
		query.append(" from LAST_YR_SAME_DATE_STEP2_TMP,OM_ORDER_LINE,OM_PRODUCT_CATEGORY_TYPE,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append(" OM_PRODUCT_CATEGORY_LVL1,OM_PRODUCT_CATEGORY_LVL2 ");
		query.append(" where OM_ORDER_LINE.sys_ORDER_ID=LAST_YR_SAME_DATE_STEP2_TMP.SYS_ORDER_ID ");
		query.append(" and LAST_YR_SAME_DATE_STEP2_TMP.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID ");
		query.append(" and OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE = ? ");
			query.append(" and OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME= ?   ");
		query.append(" and ORDER_PLACED_CST_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_CST_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" ALL_DAYS_TMP AS ( ");
		query.append(" select * from YESTERDAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DATE_TMP ");
		query.append(" ), ");
		query.append(" CHANNEL_BREAKUP_TMP AS (   ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\",  ");
		query.append(" 20 \"SORT_ORDER_CHNL\" ");
		query.append(" from ( ");
		query.append(" select ORDER_ORIGIN_TYPE, sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\" ");
		query.append(" from ALL_DAYS_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE ");
		query.append(" ) order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" CHANNEL_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\" ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ");
		query.append(" ),  ");
		query.append(" TOTAL_AGGR_TMP AS (     ");
		query.append(" select 'TOTAL' \"ORDER_ORIGIN_TYPE\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" 0 \"SORTORDER2\",5 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_AGGR_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" ALL_DISPLAY_TMP AS (               ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",'AFFILIATE' from TOTAL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",'AFFILIATE' from CHANNEL_AGGR_TMP     ");
		query.append(" ) ");
		query.append(" select ORDER_ORIGIN_TYPE,\"SORTORDER2\",\"SORT_ORDER_CHNL\",\"SORT_ORDER_CHNL2\", ");
		query.append(" \"Yesterday\" \"Yesterday\", \"LstYrSmDay\" \"LstYrSmDay\",ROUND(\"SameDayYOY%\", 2) \"SameDayYOY%\", ");
		query.append(" \"LstYrSmDate\" \"LstYrSmDate\",ROUND(\"SameDateYOY%\", 2) \"SameDateYOY%\" from ALL_DISPLAY_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"SORT_ORDER_CHNL2\" ");
		logger.info(" Finish execution getReport7AggregateOrderPlacedCount() method in EmailReportQuery.class ");
		return query.toString();
	}

	public static String getReport7AggregateOrderSoldCount() {
		logger.info(" Start execution getReport7AggregateOrderSoldCount() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" WITH ");
		query.append(" YESTERDAY_STEP1_TMP AS ( ");
		// query.append(" -- Get records from 195 days since orders placed 6 months back can be cancelled today ");
		query.append(" select OM_ORDER.SYS_ORDER_ID,SYS_OWNING_LOC_ID,ORDER_SOLD_DTTM ,ORDER_ORIGIN_TYPE,SOLD_AMOUNT, ((6+OWNING_LOC_TZ_OFFSET)*60) \"CST_OFF_SET\" from OM_ORDER ");
		query.append(" where ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY')-195 and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_SOLD_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_SOLD_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM')), ");
		query.append(" YESTERDAY_STEP2_TMP AS ( ");
		// query.append(" -- Get CST offset from OM_LOCATION table and convert ORDER_SOLD_DTTM to CST ");
		query.append(" select SYS_ORDER_ID,ORDER_ORIGIN_TYPE,SOLD_AMOUNT, ");
		query.append(" (YESTERDAY_STEP1_TMP.ORDER_SOLD_DTTM - NUMTODSINTERVAL(YESTERDAY_STEP1_TMP.CST_OFF_SET , 'MINUTE')) ");
		query.append(" \"ORDER_SOLD_CST_DTTM\" from YESTERDAY_STEP1_TMP ");
		query.append(" ),     ");
		query.append(" YESTERDAY_TMP AS ( ");
		query.append(" select YESTERDAY_STEP2_TMP.ORDER_ORIGIN_TYPE,count(1) \"Yesterday\",0 \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from YESTERDAY_STEP2_TMP  ");
		query.append(" where ORDER_SOLD_CST_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_SOLD_CST_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE  ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DAY_STEP1_TMP AS ( ");
		// query.append(" -- Get records from 195 days since orders placed 6 months back can be cancelled today ");
		query.append("  select OM_ORDER.SYS_ORDER_ID,SYS_OWNING_LOC_ID,ORDER_SOLD_DTTM,ORDER_ORIGIN_TYPE,SOLD_AMOUNT, ((6+OWNING_LOC_TZ_OFFSET)*60) \"CST_OFF_SET\" from OM_ORDER ");
		query.append(" where ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY')-195 and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_SOLD_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_SOLD_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM')), ");
		query.append(" LAST_YR_SAME_DAY_STEP2_TMP AS ( ");
		// query.append(" -- Get CST offset from OM_LOCATION table and convert ORDER_SOLD_DTTM to CST ");
		query.append(" select SYS_ORDER_ID,ORDER_ORIGIN_TYPE,SOLD_AMOUNT, ");
		query.append(" (LAST_YR_SAME_DAY_STEP1_TMP.ORDER_SOLD_DTTM - NUMTODSINTERVAL(LAST_YR_SAME_DAY_STEP1_TMP.CST_OFF_SET , 'MINUTE')) ");
		query.append(" \"ORDER_SOLD_CST_DTTM\" ");
		query.append(" from LAST_YR_SAME_DAY_STEP1_TMP ");
		query.append(" ),     ");
		query.append(" LAST_YR_SAME_DAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 \"Yesterday\",count(1) \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from LAST_YR_SAME_DAY_STEP2_TMP ");
		query.append(" where ORDER_SOLD_CST_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_SOLD_CST_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DATE_STEP1_TMP AS ( ");
		// query.append(" -- Get records from 195 days since orders placed 6 months back can be cancelled today ");
		query.append(" select OM_ORDER.SYS_ORDER_ID,SYS_OWNING_LOC_ID,ORDER_SOLD_DTTM,ORDER_ORIGIN_TYPE,SOLD_AMOUNT ,((6+OWNING_LOC_TZ_OFFSET)*60) \"CST_OFF_SET\"  from OM_ORDER ");
		query.append(" where ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY')-195 and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_SOLD_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_SOLD_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM')), ");
		query.append(" LAST_YR_SAME_DATE_STEP2_TMP AS ( ");
		// query.append(" -- Get CST offset from OM_LOCATION table and convert ORDER_SOLD_DTTM to CST ");
		query.append(" select SYS_ORDER_ID,ORDER_ORIGIN_TYPE,SOLD_AMOUNT, ");
		query.append(" (LAST_YR_SAME_DATE_STEP1_TMP.ORDER_SOLD_DTTM - NUMTODSINTERVAL(LAST_YR_SAME_DATE_STEP1_TMP.CST_OFF_SET , 'MINUTE')) \"ORDER_SOLD_CST_DTTM\" ");
		query.append(" from LAST_YR_SAME_DATE_STEP1_TMP ");
		query.append(" ),    ");
		query.append(" LAST_YR_SAME_DATE_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 \"Yesterday\",0 \"LstYrSmDay\",count(1) \"LstYrSmDate\" ");
		query.append(" from LAST_YR_SAME_DATE_STEP2_TMP ");
		query.append(" where ORDER_SOLD_CST_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_SOLD_CST_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" ALL_DAYS_TMP AS ( ");
		query.append(" select * from YESTERDAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DATE_TMP ");
		query.append(" ), ");
		query.append(" CHANNEL_BREAKUP_TMP AS (   ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\",  ");
		query.append(" 20 \"SORT_ORDER_CHNL\" ");
		query.append(" from ( ");
		query.append(" select ORDER_ORIGIN_TYPE, sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\" ");
		query.append(" from ALL_DAYS_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE ");
		query.append(" ) order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" CHANNEL_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\" ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ");
		query.append(" ),  ");
		query.append(" TOTAL_AGGR_TMP AS (     ");
		query.append(" select 'TOTAL' \"ORDER_ORIGIN_TYPE\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" 0 \"SORTORDER2\",5 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_AGGR_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" ALL_DISPLAY_TMP AS (               ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",'AFFILIATE' from TOTAL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",'AFFILIATE' from CHANNEL_AGGR_TMP ");

		query.append("     ) ");
		query.append(" select ORDER_ORIGIN_TYPE,\"SORTORDER2\",\"SORT_ORDER_CHNL\",\"SORT_ORDER_CHNL2\", ");
		query.append(" \"Yesterday\" \"Yesterday\", \"LstYrSmDay\" \"LstYrSmDay\",ROUND(\"SameDayYOY%\", 2) \"SameDayYOY%\", ");
		query.append(" \"LstYrSmDate\" \"LstYrSmDate\",ROUND(\"SameDateYOY%\", 2) \"SameDateYOY%\" from ALL_DISPLAY_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"SORT_ORDER_CHNL2\" ");
		logger.info(" Finish execution getReport7AggregateOrderSoldCount() method in EmailReportQuery.class ");
		return query.toString();
	}

	
	public static String getReport7AggregateOrderSoldCountGifts() {
		logger.info(" Start execution getReport7AggregateOrderSoldCount() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" WITH ");
		query.append(" YESTERDAY_STEP1_TMP AS ( ");
		// query.append(" -- Get records from 195 days since orders placed 6 months back can be cancelled today ");
		query.append(" select OM_ORDER.SYS_ORDER_ID,SYS_OWNING_LOC_ID,ORDER_SOLD_DTTM ,ORDER_ORIGIN_TYPE,ORDER_PLACED_DTTM, ((6+OWNING_LOC_TZ_OFFSET)*60) \"CST_OFF_SET\" from OM_ORDER ");
		query.append(" where ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY')-195 and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_SOLD_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_SOLD_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM')), ");
		query.append(" YESTERDAY_STEP2_TMP AS ( ");
		// query.append(" -- Get CST offset from OM_LOCATION table and convert ORDER_SOLD_DTTM to CST ");
		query.append(" select SYS_ORDER_ID,ORDER_ORIGIN_TYPE,ORDER_PLACED_DTTM, ");
		query.append(" (YESTERDAY_STEP1_TMP.ORDER_SOLD_DTTM - NUMTODSINTERVAL(YESTERDAY_STEP1_TMP.CST_OFF_SET , 'MINUTE')) ");
		query.append(" \"ORDER_SOLD_CST_DTTM\" from YESTERDAY_STEP1_TMP ");
		query.append(" ),     ");
		query.append(" YESTERDAY_TMP AS ( ");
		query.append(" select YESTERDAY_STEP2_TMP.ORDER_ORIGIN_TYPE,count(distinct YESTERDAY_STEP2_TMP.SYS_ORDER_ID) \"Yesterday\",0 \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from YESTERDAY_STEP2_TMP ,OM_ORDER_LINE ,OM_PRODUCT_CATEGORY_TYPE ,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append(" OM_PRODUCT_CATEGORY_LVL1 ,OM_PRODUCT_CATEGORY_LVL2  ");
		query.append(" where OM_ORDER_LINE.SYS_ORDER_ID=YESTERDAY_STEP2_TMP.SYS_ORDER_ID   ");
		query.append(" and YESTERDAY_STEP2_TMP.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID  ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID  ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID  ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID  ");
		query.append(" and OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE =? ");
			query.append(" and OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME=?  ");
		query.append(" and ORDER_SOLD_CST_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_SOLD_CST_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE  ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DAY_STEP1_TMP AS ( ");
		// query.append(" -- Get records from 195 days since orders placed 6 months back can be cancelled today ");
		query.append("  select OM_ORDER.SYS_ORDER_ID,SYS_OWNING_LOC_ID,ORDER_SOLD_DTTM,ORDER_ORIGIN_TYPE,ORDER_PLACED_DTTM, ((6+OWNING_LOC_TZ_OFFSET)*60) \"CST_OFF_SET\" from OM_ORDER ");
		query.append(" where ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY')-195 and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_SOLD_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_SOLD_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM')), ");
		query.append(" LAST_YR_SAME_DAY_STEP2_TMP AS ( ");
		// query.append(" -- Get CST offset from OM_LOCATION table and convert ORDER_SOLD_DTTM to CST ");
		query.append(" select SYS_ORDER_ID,ORDER_ORIGIN_TYPE,ORDER_PLACED_DTTM, ");
		query.append(" (LAST_YR_SAME_DAY_STEP1_TMP.ORDER_SOLD_DTTM - NUMTODSINTERVAL(LAST_YR_SAME_DAY_STEP1_TMP.CST_OFF_SET , 'MINUTE')) ");
		query.append(" \"ORDER_SOLD_CST_DTTM\" ");
		query.append(" from LAST_YR_SAME_DAY_STEP1_TMP ");
		query.append(" ),     ");
		query.append(" LAST_YR_SAME_DAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 \"Yesterday\",count(distinct LAST_YR_SAME_DAY_STEP2_TMP.SYS_ORDER_ID) \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from LAST_YR_SAME_DAY_STEP2_TMP,OM_ORDER_LINE,OM_PRODUCT_CATEGORY_TYPE,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append(" OM_PRODUCT_CATEGORY_LVL1,OM_PRODUCT_CATEGORY_LVL2 ");
		query.append(" where OM_ORDER_LINE.sys_ORDER_ID=LAST_YR_SAME_DAY_STEP2_TMP.SYS_ORDER_ID  ");
		query.append(" and LAST_YR_SAME_DAY_STEP2_TMP.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID ");
		query.append(" and OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE =? ");
			query.append(" and OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME= ?  ");
		query.append(" and ORDER_SOLD_CST_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_SOLD_CST_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DATE_STEP1_TMP AS ( ");
		// query.append(" -- Get records from 195 days since orders placed 6 months back can be cancelled today ");
		query.append(" select OM_ORDER.SYS_ORDER_ID,SYS_OWNING_LOC_ID,ORDER_SOLD_DTTM,ORDER_ORIGIN_TYPE,ORDER_PLACED_DTTM ,((6+OWNING_LOC_TZ_OFFSET)*60) \"CST_OFF_SET\"  from OM_ORDER ");
		query.append(" where ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY')-195 and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_SOLD_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_SOLD_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM')), ");
		query.append(" LAST_YR_SAME_DATE_STEP2_TMP AS ( ");
		// query.append(" -- Get CST offset from OM_LOCATION table and convert ORDER_SOLD_DTTM to CST ");
		query.append(" select SYS_ORDER_ID,ORDER_ORIGIN_TYPE,ORDER_PLACED_DTTM, ");
		query.append(" (LAST_YR_SAME_DATE_STEP1_TMP.ORDER_SOLD_DTTM - NUMTODSINTERVAL(LAST_YR_SAME_DATE_STEP1_TMP.CST_OFF_SET , 'MINUTE')) \"ORDER_SOLD_CST_DTTM\" ");
		query.append(" from LAST_YR_SAME_DATE_STEP1_TMP ");
		query.append(" ),    ");
		query.append(" LAST_YR_SAME_DATE_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 \"Yesterday\",0 \"LstYrSmDay\",count(distinct LAST_YR_SAME_DATE_STEP2_TMP.SYS_ORDER_ID) \"LstYrSmDate\" ");
		query.append(" from LAST_YR_SAME_DATE_STEP2_TMP,OM_ORDER_LINE,OM_PRODUCT_CATEGORY_TYPE,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append(" OM_PRODUCT_CATEGORY_LVL1,OM_PRODUCT_CATEGORY_LVL2 ");
		query.append(" where OM_ORDER_LINE.sys_ORDER_ID=LAST_YR_SAME_DATE_STEP2_TMP.SYS_ORDER_ID ");
		query.append(" and LAST_YR_SAME_DATE_STEP2_TMP.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID ");
		query.append(" and OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE =? ");
			query.append(" and OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME=?  ");
		query.append(" and ORDER_SOLD_CST_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_SOLD_CST_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" ALL_DAYS_TMP AS ( ");
		query.append(" select * from YESTERDAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DATE_TMP ");
		query.append(" ), ");
		query.append(" CHANNEL_BREAKUP_TMP AS (   ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\",  ");
		query.append(" 20 \"SORT_ORDER_CHNL\" ");
		query.append(" from ( ");
		query.append(" select ORDER_ORIGIN_TYPE, sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\" ");
		query.append(" from ALL_DAYS_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE ");
		query.append(" ) order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" CHANNEL_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\" ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ");
		query.append(" ),  ");
		query.append(" TOTAL_AGGR_TMP AS (     ");
		query.append(" select 'TOTAL' \"ORDER_ORIGIN_TYPE\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" 0 \"SORTORDER2\",5 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_AGGR_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" ALL_DISPLAY_TMP AS (               ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",'AFFILIATE' from TOTAL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",'AFFILIATE' from CHANNEL_AGGR_TMP ");

		query.append("     ) ");
		query.append(" select ORDER_ORIGIN_TYPE,\"SORTORDER2\",\"SORT_ORDER_CHNL\",\"SORT_ORDER_CHNL2\", ");
		query.append(" \"Yesterday\" \"Yesterday\", \"LstYrSmDay\" \"LstYrSmDay\",ROUND(\"SameDayYOY%\", 2) \"SameDayYOY%\", ");
		query.append(" \"LstYrSmDate\" \"LstYrSmDate\",ROUND(\"SameDateYOY%\", 2) \"SameDateYOY%\" from ALL_DISPLAY_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"SORT_ORDER_CHNL2\" ");
		logger.info(" Finish execution getReport7AggregateOrderSoldCount() method in EmailReportQuery.class ");
		return query.toString();
	}

	public static String getReport8OrderPlaced(String category) {
		logger.info(" Start execution getReport8OrderPlaced() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" WITH ");
		query.append(" YESTERDAY_STEP1_TMP AS ( ");
		// query.append(" -- Get records from yesterday same hour to  tomorrow same hour. This ensures we consider all timezones");
		query.append(" select OM_ORDER.SYS_ORDER_ID,SYS_OWNING_LOC_ID,ORDER_PLACED_DTTM,ORDER_ORIGIN_TYPE, ((6+OWNING_LOC_TZ_OFFSET)*60) \"CST_OFF_SET\" from OM_ORDER ");
		query.append(" where ORDER_PLACED_DTTM >= TO_DATE( ?,  'DD-MON-YYYY') and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" ), ");
		query.append(" YESTERDAY_STEP2_TMP AS ( ");
		// query.append("     -- Get CST offset from OM_LOCATION table and convert ORDER_PLACED_DTTM to CST");
		query.append(" select SYS_ORDER_ID,ORDER_ORIGIN_TYPE, ORDER_PLACED_DTTM,  ");
		query.append(" (YESTERDAY_STEP1_TMP.ORDER_PLACED_DTTM - NUMTODSINTERVAL(YESTERDAY_STEP1_TMP.CST_OFF_SET , 'MINUTE')) \"ORDER_PLACED_CST_DTTM\" ");
		query.append(" from YESTERDAY_STEP1_TMP ");
		query.append(" ),     ");
		query.append(" YESTERDAY_TMP AS ( ");
		query.append(" select YESTERDAY_STEP2_TMP.ORDER_ORIGIN_TYPE,sum(OM_ORDER_LINE.FINAL_PRICE) \"Yesterday\",0 \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" ,OM_PRODUCT_CATEGORY_LVL1.CATEGORY_NAME from YESTERDAY_STEP2_TMP,OM_ORDER_LINE,OM_PRODUCT_CATEGORY_TYPE,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append(" OM_PRODUCT_CATEGORY_LVL1,OM_PRODUCT_CATEGORY_LVL2 ");
		query.append(" where OM_ORDER_LINE.SYS_ORDER_ID=YESTERDAY_STEP2_TMP.SYS_ORDER_ID   ");
		query.append(" and YESTERDAY_STEP2_TMP.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID  ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID  ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID  ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID  ");
		query.append(" and OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE =? ");
		query.append(" and OM_PRODUCT_CATEGORY_LVL1.CATEGORY_NAME='" + category
				+ "'  ");
		query.append(" and ORDER_PLACED_CST_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_CST_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE  , OM_PRODUCT_CATEGORY_LVL1.CATEGORY_NAME ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DAY_STEP1_TMP AS ( ");
		// query.append("     -- Get records from last year same day - 1 same hour to  tomorrow same hour. This ensures we consider all timezones");
		query.append(" select OM_ORDER.SYS_ORDER_ID,SYS_OWNING_LOC_ID,ORDER_PLACED_DTTM,ORDER_ORIGIN_TYPE, ((6+OWNING_LOC_TZ_OFFSET)*60) \"CST_OFF_SET\" from OM_ORDER ");
		query.append(" where ORDER_PLACED_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DAY_STEP2_TMP AS ( ");
		// query.append(" -- Get CST offset from OM_LOCATION table and convert ORDER_PLACED_DTTM to CST");
		query.append(" select SYS_ORDER_ID,ORDER_ORIGIN_TYPE,ORDER_PLACED_DTTM, ");
		query.append(" (LAST_YR_SAME_DAY_STEP1_TMP.ORDER_PLACED_DTTM - NUMTODSINTERVAL(LAST_YR_SAME_DAY_STEP1_TMP.CST_OFF_SET , 'MINUTE')) ");
		query.append(" \"ORDER_PLACED_CST_DTTM\" ");
		query.append(" from LAST_YR_SAME_DAY_STEP1_TMP ");
		query.append(" ),     ");
		query.append(" LAST_YR_SAME_DAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 \"Yesterday\",sum(OM_ORDER_LINE.FINAL_PRICE) \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" ,OM_PRODUCT_CATEGORY_LVL1.CATEGORY_NAME  from LAST_YR_SAME_DAY_STEP2_TMP,OM_ORDER_LINE,OM_PRODUCT_CATEGORY_TYPE,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append(" OM_PRODUCT_CATEGORY_LVL1,OM_PRODUCT_CATEGORY_LVL2 ");
		query.append(" where OM_ORDER_LINE.sys_ORDER_ID=LAST_YR_SAME_DAY_STEP2_TMP.SYS_ORDER_ID  ");
		query.append(" and LAST_YR_SAME_DAY_STEP2_TMP.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID  ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID ");
		query.append(" and OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE =? ");
		query.append(" and OM_PRODUCT_CATEGORY_LVL1.CATEGORY_NAME='" + category
				+ "' ");
		query.append(" and ORDER_PLACED_CST_DTTM >= TO_DATE( ? , 'DD-MON-YYYY') and ORDER_PLACED_CST_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE , OM_PRODUCT_CATEGORY_LVL1.CATEGORY_NAME ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DATE_STEP1_TMP AS ( ");
		// query.append(" -- Get records from last year same day - 1 same hour to  tomorrow same hour. This ensures we consider all timezones");
		query.append(" select OM_ORDER.SYS_ORDER_ID,SYS_OWNING_LOC_ID,ORDER_PLACED_DTTM,ORDER_ORIGIN_TYPE,((6+OWNING_LOC_TZ_OFFSET)*60) \"CST_OFF_SET\"  from OM_ORDER ");
		query.append(" where ORDER_PLACED_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DATE_STEP2_TMP AS ( ");
		// query.append(" -- Get CST offset from OM_LOCATION table and convert ORDER_PLACED_DTTM to CST");
		query.append(" select SYS_ORDER_ID,ORDER_ORIGIN_TYPE,ORDER_PLACED_DTTM, ");
		query.append(" (LAST_YR_SAME_DATE_STEP1_TMP.ORDER_PLACED_DTTM - NUMTODSINTERVAL(LAST_YR_SAME_DATE_STEP1_TMP.CST_OFF_SET , 'MINUTE')) \"ORDER_PLACED_CST_DTTM\" ");
		query.append(" from LAST_YR_SAME_DATE_STEP1_TMP ");
		query.append(" ),    ");
		query.append(" LAST_YR_SAME_DATE_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 \"Yesterday\",0 \"LstYrSmDay\",sum(OM_ORDER_LINE.FINAL_PRICE) \"LstYrSmDate\" ");
		query.append(" ,OM_PRODUCT_CATEGORY_LVL1.CATEGORY_NAME  from LAST_YR_SAME_DATE_STEP2_TMP,OM_ORDER_LINE,OM_PRODUCT_CATEGORY_TYPE,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append(" OM_PRODUCT_CATEGORY_LVL1,OM_PRODUCT_CATEGORY_LVL2 ");
		query.append(" where OM_ORDER_LINE.sys_ORDER_ID=LAST_YR_SAME_DATE_STEP2_TMP.SYS_ORDER_ID ");
		query.append(" and LAST_YR_SAME_DATE_STEP2_TMP.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID ");
		query.append(" and  OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE =?  ");
		query.append(" and OM_PRODUCT_CATEGORY_LVL1.CATEGORY_NAME='" + category
				+ "' ");
		query.append(" and ORDER_PLACED_CST_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_PLACED_CST_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE , OM_PRODUCT_CATEGORY_LVL1.CATEGORY_NAME ");
		query.append(" ), ");
		query.append(" ALL_DAYS_TMP AS ( ");
		query.append(" select * from YESTERDAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DATE_TMP ");
		query.append(" ), ");
		query.append(" CHANNEL_BREAKUP_TMP AS (   ");
		query.append(" select ORDER_ORIGIN_TYPE,CATEGORY_NAME, \"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\",  ");
		query.append(" 20 \"SORT_ORDER_CHNL\" ");
		query.append(" from ( ");
		query.append(" select ORDER_ORIGIN_TYPE, CATEGORY_NAME, sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\" ");
		query.append(" from ALL_DAYS_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE , CATEGORY_NAME");
		query.append(" ) order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" CHANNEL_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE, 'TOTAL' CATEGORY_NAME, sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\" ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ");
		query.append(" ),  ");
		query.append(" CATEGORY_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE, CATEGORY_NAME, sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\", CATEGORY_NAME ");
		query.append(" order by \"SORTORDER2\",CATEGORY_NAME ");
		query.append(" ),  ");
		query.append(" TOTAL_AGGR_TMP AS (     ");
		query.append(" select '-----TOTAL-----' \"ORDER_ORIGIN_TYPE\",'---CATEGORY BREAKUP---' CATEGORY_NAME ,sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" 0 \"SORTORDER2\",5 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_AGGR_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE , CATEGORY_NAME ");
		query.append(" ), ");
		query.append(" ALL_DISPLAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,CATEGORY_NAME, \"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",'AFFILIATE' from TOTAL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,CATEGORY_NAME, \"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",'AFFILIATE' from CATEGORY_AGGR_TMP ");
		query.append(" ) ");
		query.append(" select ORDER_ORIGIN_TYPE,CATEGORY_NAME, \"SORTORDER2\",\"SORT_ORDER_CHNL\",\"SORT_ORDER_CHNL2\", ");
		query.append(" \"Yesterday\" \"Yesterday\", \"LstYrSmDay\" \"LstYrSmDay\",ROUND(\"SameDayYOY%\", 2) \"SameDayYOY%\", ");
		query.append(" \"LstYrSmDate\" \"LstYrSmDate\",ROUND(\"SameDateYOY%\", 2) \"SameDateYOY%\" from ALL_DISPLAY_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"SORT_ORDER_CHNL2\" ");
		logger.info(" Finish execution getReport8OrderPlaced() method in EmailReportQuery.class ");
		return query.toString();
	}

	public static String getReport8OrderSold(String category) {
		logger.info(" Start execution getReport8OrderSold() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" WITH ");
		query.append(" YESTERDAY_STEP1_TMP AS ( ");
		// query.append("     -- Get records from 195 days since orders placed 6 months back can be cancelled today");
		query.append(" select OM_ORDER.SYS_ORDER_ID,SYS_OWNING_LOC_ID,ORDER_SOLD_DTTM,ORDER_ORIGIN_TYPE,ORDER_PLACED_DTTM , ((6+OWNING_LOC_TZ_OFFSET)*60) \"CST_OFF_SET\" from OM_ORDER ");
		query.append(" where ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY')-195  and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_SOLD_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_SOLD_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ), ");
		query.append(" YESTERDAY_STEP2_TMP AS ( ");
		// query.append(" -- Get CST offset from OM_LOCATION table and convert ORDER_SOLD_DTTM to CST");
		query.append(" select SYS_ORDER_ID,ORDER_ORIGIN_TYPE,ORDER_PLACED_DTTM, ");
		query.append(" (YESTERDAY_STEP1_TMP.ORDER_SOLD_DTTM - NUMTODSINTERVAL(YESTERDAY_STEP1_TMP.CST_OFF_SET , 'MINUTE')) \"ORDER_SOLD_CST_DTTM\" ");
		query.append(" from YESTERDAY_STEP1_TMP ");
		query.append(" ),     ");
		query.append(" YESTERDAY_TMP AS ( ");
		query.append(" select YESTERDAY_STEP2_TMP.ORDER_ORIGIN_TYPE,sum(OM_ORDER_LINE.LINE_SOLD_AMOUNT) \"Yesterday\",0 \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" ,OM_PRODUCT_CATEGORY_LVL1.CATEGORY_NAME  from YESTERDAY_STEP2_TMP,OM_ORDER_LINE,OM_PRODUCT_CATEGORY_TYPE,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append(" OM_PRODUCT_CATEGORY_LVL1,OM_PRODUCT_CATEGORY_LVL2 ");
		query.append(" where OM_ORDER_LINE.SYS_ORDER_ID=YESTERDAY_STEP2_TMP.SYS_ORDER_ID   ");
		query.append(" and YESTERDAY_STEP2_TMP.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID  ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID  ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID  ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID  ");
		query.append(" and OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE =? ");
		query.append(" and OM_PRODUCT_CATEGORY_LVL1.CATEGORY_NAME='" + category
				+ "'  ");
		query.append(" and ORDER_SOLD_CST_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_SOLD_CST_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE ,OM_PRODUCT_CATEGORY_LVL1.CATEGORY_NAME  ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DAY_STEP1_TMP AS ( ");
		// query.append(" -- Get records from 195 days since orders placed 6 months back can be cancelled today ");
		query.append(" select OM_ORDER.SYS_ORDER_ID,SYS_OWNING_LOC_ID,ORDER_SOLD_DTTM,ORDER_ORIGIN_TYPE,ORDER_PLACED_DTTM , ((6+OWNING_LOC_TZ_OFFSET)*60) \"CST_OFF_SET\" from OM_ORDER ");
		query.append(" where ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY')-195 and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_SOLD_DTTM >=TO_DATE( ?, 'DD-MON-YYYY') and ORDER_SOLD_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ), ");
		query.append(" LAST_YR_SAME_DAY_STEP2_TMP AS ( ");
		// query.append(" -- Get CST offset from OM_LOCATION table and convert
		// ORDER_SOLD_DTTM to CST
		query.append(" select SYS_ORDER_ID,ORDER_ORIGIN_TYPE,ORDER_PLACED_DTTM, ");
		query.append(" (LAST_YR_SAME_DAY_STEP1_TMP.ORDER_SOLD_DTTM - NUMTODSINTERVAL(LAST_YR_SAME_DAY_STEP1_TMP.CST_OFF_SET , 'MINUTE')) ");
		query.append(" \"ORDER_SOLD_CST_DTTM\" ");
		query.append(" from LAST_YR_SAME_DAY_STEP1_TMP ");
		query.append(" ),     ");
		query.append(" LAST_YR_SAME_DAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 \"Yesterday\",sum(OM_ORDER_LINE.LINE_SOLD_AMOUNT) \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" ,OM_PRODUCT_CATEGORY_LVL1.CATEGORY_NAME  from LAST_YR_SAME_DAY_STEP2_TMP,OM_ORDER_LINE,OM_PRODUCT_CATEGORY_TYPE,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append(" OM_PRODUCT_CATEGORY_LVL1,OM_PRODUCT_CATEGORY_LVL2 ");
		query.append(" where OM_ORDER_LINE.sys_ORDER_ID=LAST_YR_SAME_DAY_STEP2_TMP.SYS_ORDER_ID  ");
		query.append(" and LAST_YR_SAME_DAY_STEP2_TMP.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID  ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID ");
		query.append(" and OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE =? ");
		query.append(" and OM_PRODUCT_CATEGORY_LVL1.CATEGORY_NAME='" + category
				+ "' ");
		query.append(" and ORDER_SOLD_CST_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_SOLD_CST_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE ,OM_PRODUCT_CATEGORY_LVL1.CATEGORY_NAME  ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DATE_STEP1_TMP AS ( ");
		// query.append("  -- Get records from 195 days since orders placed 6 months back can be cancelled today ");
		query.append(" select OM_ORDER.SYS_ORDER_ID,SYS_OWNING_LOC_ID,ORDER_SOLD_DTTM,ORDER_ORIGIN_TYPE,ORDER_PLACED_DTTM ,((6+OWNING_LOC_TZ_OFFSET)*60) \"CST_OFF_SET\"  from OM_ORDER ");
		query.append(" where ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY')-195 and ORDER_PLACED_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_SOLD_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_SOLD_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ), ");
		query.append(" LAST_YR_SAME_DATE_STEP2_TMP AS ( ");
		// query.append("  -- Get CST offset from OM_LOCATION table and convert ORDER_SOLD_DTTM to CST ");
		query.append(" select SYS_ORDER_ID,ORDER_ORIGIN_TYPE,ORDER_PLACED_DTTM, ");
		query.append(" (LAST_YR_SAME_DATE_STEP1_TMP.ORDER_SOLD_DTTM - NUMTODSINTERVAL(LAST_YR_SAME_DATE_STEP1_TMP.CST_OFF_SET , 'MINUTE')) \"ORDER_SOLD_CST_DTTM\" ");
		query.append(" from LAST_YR_SAME_DATE_STEP1_TMP ");
		query.append(" ),    ");
		query.append(" LAST_YR_SAME_DATE_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 \"Yesterday\",0 \"LstYrSmDay\",sum(OM_ORDER_LINE.LINE_SOLD_AMOUNT) \"LstYrSmDate\" ");
		query.append(" ,OM_PRODUCT_CATEGORY_LVL1.CATEGORY_NAME  from LAST_YR_SAME_DATE_STEP2_TMP,OM_ORDER_LINE,OM_PRODUCT_CATEGORY_TYPE,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append(" OM_PRODUCT_CATEGORY_LVL1,OM_PRODUCT_CATEGORY_LVL2 ");
		query.append(" where OM_ORDER_LINE.sys_ORDER_ID=LAST_YR_SAME_DATE_STEP2_TMP.SYS_ORDER_ID ");
		query.append(" and LAST_YR_SAME_DATE_STEP2_TMP.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID ");
		query.append(" and OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE =? ");
		query.append(" and OM_PRODUCT_CATEGORY_LVL1.CATEGORY_NAME='" + category
				+ "' ");
		query.append(" and ORDER_SOLD_CST_DTTM >= TO_DATE( ?, 'DD-MON-YYYY') and ORDER_SOLD_CST_DTTM <= TO_DATE( ?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE ,OM_PRODUCT_CATEGORY_LVL1.CATEGORY_NAME  ");
		query.append(" ), ");
		query.append(" ALL_DAYS_TMP AS ( ");
		query.append(" select * from YESTERDAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DATE_TMP ");
		query.append(" ), ");
		query.append(" CHANNEL_BREAKUP_TMP AS (   ");
		query.append(" select ORDER_ORIGIN_TYPE,CATEGORY_NAME, \"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\",  ");
		query.append(" 20 \"SORT_ORDER_CHNL\" ");
		query.append(" from ( ");
		query.append(" select ORDER_ORIGIN_TYPE, CATEGORY_NAME, sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\" ");
		query.append(" from ALL_DAYS_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE , CATEGORY_NAME");
		query.append(" ) order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" CHANNEL_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE, 'TOTAL' CATEGORY_NAME , sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\" ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ");
		query.append(" ),  ");
		query.append(" CATEGORY_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE, CATEGORY_NAME, sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\", CATEGORY_NAME ");
		query.append(" order by \"SORTORDER2\",CATEGORY_NAME ");
		query.append(" ),  ");
		query.append(" TOTAL_AGGR_TMP AS (     ");
		query.append(" select '-----TOTAL-----' \"ORDER_ORIGIN_TYPE\", '---CATEGORY BREAKUP---' CATEGORY_NAME, sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" 0 \"SORTORDER2\",5 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_AGGR_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE , CATEGORY_NAME");
		query.append(" ), ");
		query.append(" ALL_DISPLAY_TMP AS (               ");
		query.append(" select ORDER_ORIGIN_TYPE,CATEGORY_NAME, \"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",'AFFILIATE' from TOTAL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,CATEGORY_NAME, \"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",5 \"SORT_ORDER_CHNL2\",'AFFILIATE' from CHANNEL_BREAKUP_TMP       ");
		query.append(" ) ");
		query.append(" select ORDER_ORIGIN_TYPE,CATEGORY_NAME, \"SORTORDER2\",\"SORT_ORDER_CHNL\",\"SORT_ORDER_CHNL2\", ");
		query.append(" \"Yesterday\" \"Yesterday\", \"LstYrSmDay\" \"LstYrSmDay\",ROUND(\"SameDayYOY%\", 2) \"SameDayYOY%\", ");
		query.append(" \"LstYrSmDate\" \"LstYrSmDate\",ROUND(\"SameDateYOY%\", 2) \"SameDateYOY%\" from ALL_DISPLAY_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"SORT_ORDER_CHNL2\" ");
		logger.info(" Finish execution getReport8OrderSold() method in EmailReportQuery.class ");
		return query.toString();
	}

	public static String getReport2OrderPlaced() {
		logger.info(" Start execution getReport2OrderPlaced() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" WITH ");
		query.append(" YESTERDAY_TMP AS ( ");
		query.append("  select ORDER_ORIGIN_TYPE,sum(FINAL_PRICE) \"Yesterday\",0 \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from OM_ORDER where ORDER_PLACED_DTTM >= to_date( ? , 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= to_date(?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append("  group by ORDER_ORIGIN_TYPE ");
		query.append("  ), ");
		query.append("  LAST_YR_SAME_DAY_TMP AS ( ");
		query.append("  select ORDER_ORIGIN_TYPE,0 \"Yesterday\",sum(FINAL_PRICE) \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append("  from OM_ORDER where ORDER_PLACED_DTTM >= to_date( ? , 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= to_date(?, 'DD-MON-YYYY HH:MI:SS AM')  ");
		query.append("  group by ORDER_ORIGIN_TYPE ");
		query.append("  ), ");
		query.append("  LAST_YR_SAME_DATE_TMP AS ( ");
		query.append("  select ORDER_ORIGIN_TYPE,0 \"Yesterday\",0 \"LstYrSmDay\",sum(FINAL_PRICE) \"LstYrSmDate\" ");
		query.append("  from OM_ORDER where ORDER_PLACED_DTTM >= to_date( ?, 'DD-MON-YYYY' ) and ORDER_PLACED_DTTM <= to_date(?, 'DD-MON-YYYY HH:MI:SS AM')  ");
		query.append("  group by ORDER_ORIGIN_TYPE  ");
		query.append("  ), ");
		query.append("  ALL_DAYS_TMP AS ( ");
		query.append("  select * from YESTERDAY_TMP ");
		query.append("  union ");
		query.append("  select * from LAST_YR_SAME_DAY_TMP ");
		query.append("  union ");
		query.append("  select * from LAST_YR_SAME_DATE_TMP ");
		query.append("  ), ");
		query.append("  CHANNEL_BREAKUP_TMP AS (  ");
		query.append("      select ORDER_ORIGIN_TYPE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append("  CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\" ");
		query.append("  from ( ");
		query.append("  select ORDER_ORIGIN_TYPE,sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append("  case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append("  sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append("  case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\" ");
		query.append("  from ALL_DAYS_TMP ");
		query.append("  group by ORDER_ORIGIN_TYPE ");
		query.append("  ) order by \"SORTORDER2\" ");
		query.append("  ), ");
		query.append("  TOTAL_AGGR_TMP AS ( ");
		query.append("  select '-----TOTAL-----' \"ORDER_ORIGIN_TYPE\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append("  case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append("  sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append("  case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append("  0 \"SORTORDER2\" ");
		query.append("  from CHANNEL_BREAKUP_TMP ");
		query.append("  order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ");
		query.append("  ), ");
		query.append("  ALL_DISPLAY_TMP AS ( ");
		query.append("  select * from TOTAL_AGGR_TMP ");
		query.append("  union ");
		query.append("  select * from CHANNEL_BREAKUP_TMP ");
		query.append("  ) ");
		query.append("  select * from ALL_DISPLAY_TMP order by \"SORTORDER2\" ");
		logger.info(" Finish execution getReport2OrderPlaced() method in EmailReportQuery.class ");
		return query.toString();
	}

	public static String getReport2SoldRevenue() {
		logger.info(" Start execution getReport2SoldRevenue() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" WITH ");
		query.append(" YESTERDAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,sum(SOLD_AMOUNT) \"Yesterday\",0 \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from OM_ORDER where ORDER_PLACED_DTTM >= TO_DATE(? , 'DD-MON-YYYY')-195 and ORDER_PLACED_DTTM <= to_date(?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_SOLD_DTTM >= to_date( ? , 'DD-MON-YYYY' ) and ORDER_SOLD_DTTM <= to_date(?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 \"Yesterday\",sum(SOLD_AMOUNT) \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from OM_ORDER where ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY')-195 and ORDER_PLACED_DTTM <= to_date(?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_SOLD_DTTM >= to_date( ?, 'DD-MON-YYYY' ) and ORDER_SOLD_DTTM <= to_date(?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DATE_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 \"Yesterday\",0 \"LstYrSmDay\",sum(SOLD_AMOUNT) \"LstYrSmDate\" ");
		query.append(" from OM_ORDER where  ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY')-195 and ORDER_PLACED_DTTM <= to_date(?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_SOLD_DTTM >= to_date( ? , 'DD-MON-YYYY') and ORDER_SOLD_DTTM <= to_date(?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE  ");
		query.append(" ), ");
		query.append(" ALL_DAYS_TMP AS ( ");
		query.append(" select * from YESTERDAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DATE_TMP ");
		query.append(" ), ");
		query.append(" CHANNEL_BREAKUP_TMP AS (  ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\" ");
		query.append(" from ( ");
		query.append(" select ORDER_ORIGIN_TYPE,sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\" ");
		query.append(" from ALL_DAYS_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE ");
		query.append(" ) order by \"SORTORDER2\" ");
		query.append(" ), ");
		query.append(" TOTAL_AGGR_TMP AS ( ");
		query.append(" select '-----TOTAL-----' \"ORDER_ORIGIN_TYPE\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" 0 \"SORTORDER2\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" ALL_DISPLAY_TMP AS ( ");
		query.append(" select * from TOTAL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select * from CHANNEL_BREAKUP_TMP ");
		query.append(" ) ");
		query.append(" select * from ALL_DISPLAY_TMP order by \"SORTORDER2\" ");
		logger.info(" Finish execution getReport2SoldRevenue() method in EmailReportQuery.class ");
		return query.toString();
	}

	public static String getReport2OrderPlacedCount() {
		logger.info(" Start execution getReport2OrderPlacedCount() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" WITH ");
		query.append(" YESTERDAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,count(1) \"Yesterday\",0 \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from OM_ORDER where  ORDER_PLACED_DTTM >= to_date( ?, 'DD-MON-YYYY' ) and ORDER_PLACED_DTTM <= to_date(?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 \"Yesterday\",count(1) \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from OM_ORDER where ORDER_PLACED_DTTM >= to_date( ? , 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= to_date(?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DATE_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,0 \"Yesterday\",0 \"LstYrSmDay\",count(1) \"LstYrSmDate\" ");
		query.append(" from OM_ORDER where ORDER_PLACED_DTTM >= to_date( ? , 'DD-MON-YYYY') and ORDER_PLACED_DTTM <= to_date(?, 'DD-MON-YYYY HH:MI:SS AM')  ");
		query.append(" group by ORDER_ORIGIN_TYPE  ");
		query.append(" ), ");
		query.append(" ALL_DAYS_TMP AS ( ");
		query.append(" select * from YESTERDAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DATE_TMP ");
		query.append(" ), ");
		query.append(" CHANNEL_BREAKUP_TMP AS (  ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\" ");
		query.append(" from ( ");
		query.append(" select ORDER_ORIGIN_TYPE,sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\" ");
		query.append(" from ALL_DAYS_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE ");
		query.append(" ) order by \"SORTORDER2\" ");
		query.append(" ), ");
		query.append(" TOTAL_AGGR_TMP AS ( ");
		query.append(" select '-----TOTAL-----' \"ORDER_ORIGIN_TYPE\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" 0 \"SORTORDER2\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" ALL_DISPLAY_TMP AS ( ");
		query.append(" select * from TOTAL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select * from CHANNEL_BREAKUP_TMP ");
		query.append(" ) ");
		query.append(" select * from ALL_DISPLAY_TMP order by \"SORTORDER2\"");
		logger.info(" Finish execution getReport2OrderPlacedCount() method in EmailReportQuery.class ");
		return query.toString();
	}

	public static String getReport2GiftOrderPlaced() {
		logger.info(" Start execution getReport2GiftOrderPlaced() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" WITH ");
		query.append(" YESTERDAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME \"Category\",sum(OM_ORDER_LINE.FINAL_PRICE) \"Yesterday\",0 \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,OM_ORDER_LINE,OM_PRODUCT_CATEGORY_TYPE,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append(" OM_PRODUCT_CATEGORY_LVL1,OM_PRODUCT_CATEGORY_LVL2 ");
		query.append(" where OM_ORDER_LINE.SYS_ORDER_ID=OM_ORDER.SYS_ORDER_ID  ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID ");
		query.append(" and OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE=? ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= to_date( ? , 'DD-MON-YYYY') and OM_ORDER.ORDER_PLACED_DTTM <= to_date(?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE,OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME   ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME \"Category\",0 \"Yesterday\",sum(OM_ORDER_LINE.FINAL_PRICE) \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,OM_ORDER_LINE,OM_PRODUCT_CATEGORY_TYPE,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append(" OM_PRODUCT_CATEGORY_LVL1,OM_PRODUCT_CATEGORY_LVL2 ");
		query.append(" where OM_ORDER_LINE.SYS_ORDER_ID=OM_ORDER.SYS_ORDER_ID  ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID ");
		query.append(" and OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE=?   ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= to_date( ? , 'DD-MON-YYYY') and OM_ORDER.ORDER_PLACED_DTTM <= to_date(?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE,OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DATE_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME \"Category\",0 \"Yesterday\",0 \"LstYrSmDay\",sum(OM_ORDER_LINE.FINAL_PRICE) \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,OM_ORDER_LINE,OM_PRODUCT_CATEGORY_TYPE,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append(" OM_PRODUCT_CATEGORY_LVL1,OM_PRODUCT_CATEGORY_LVL2 ");
		query.append(" where OM_ORDER_LINE.SYS_ORDER_ID=OM_ORDER.SYS_ORDER_ID  ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID ");
		query.append(" and OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE=?   ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >=to_date( ? , 'DD-MON-YYYY') and OM_ORDER.ORDER_PLACED_DTTM <= to_date(?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE,OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME ");
		query.append(" ), ");
		query.append(" ALL_DAYS_TMP AS ( ");
		query.append(" select * from YESTERDAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DATE_TMP ");
		query.append(" ), ");
		query.append(" CHANNEL_BREAKUP_TMP AS (   ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Category\",\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\",  ");
		query.append(" 20 \"SORT_ORDER_CHNL\" ");
		query.append(" from ( ");
		query.append(" select ORDER_ORIGIN_TYPE, \"Category\", sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\" ");
		query.append(" from ALL_DAYS_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"Category\" ");
		query.append(" ) order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"Category\" ");
		query.append(" ), ");
		query.append(" CHANNEL_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE ,'-----TOTAL-----' \"Category\" ,sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\" ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ");
		query.append(" ),  ");
		query.append(" CATEGORY_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE ,\"Category\",  sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" group by \"SORTORDER2\", \"Category\" , ORDER_ORIGIN_TYPE ");
		query.append(" order by \"SORTORDER2\",\"Category\"  ");
		query.append(" ),  ");
		query.append(" TOTAL_AGGR_TMP AS (     ");
		query.append(" select '-----TOTAL-----' \"ORDER_ORIGIN_TYPE\",'---CATEGORY BREAKUP---' \"Category\" ,sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" 0 \"SORTORDER2\",5 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_AGGR_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"Category\"    ");
		query.append(" ), ");
		query.append(" ALL_DISPLAY_TMP AS (               ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Category\",\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",'AFFILIATE' from TOTAL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Category\",\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",'AFFILIATE' from CHANNEL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Category\", \"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",'AFFILIATE' from CATEGORY_AGGR_TMP  			 ");
		query.append(" ) ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Category\",\"SORTORDER2\",\"SORT_ORDER_CHNL\",\"SORT_ORDER_CHNL2\", ");
		query.append(" \"Yesterday\" \"Yesterday\", \"LstYrSmDay\" \"LstYrSmDay\",ROUND(\"SameDayYOY%\", 2) \"SameDayYOY%\", ");
		query.append(" \"LstYrSmDate\" \"LstYrSmDate\",ROUND(\"SameDateYOY%\", 2) \"SameDateYOY%\" from ALL_DISPLAY_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"SORT_ORDER_CHNL2\",\"Category\"  ");
		logger.info(" Finish execution getReport2GiftOrderPlaced() method in EmailReportQuery.class ");
		return query.toString();
	}

	public static String getReport2GiftOrderSold() {
		logger.info(" Start execution getReport2GiftOrderSold() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" WITH ");
		query.append(" YESTERDAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME \"Category\",sum(OM_ORDER_LINE.LINE_SOLD_AMOUNT) \"Yesterday\",0 \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,OM_ORDER_LINE,OM_PRODUCT_CATEGORY_TYPE,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append(" OM_PRODUCT_CATEGORY_LVL1,OM_PRODUCT_CATEGORY_LVL2 ");
		query.append(" where OM_ORDER_LINE.sys_ORDER_ID=OM_ORDER.SYS_ORDER_ID  ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID ");
		query.append(" and OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE=?  ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY')-195 and OM_ORDER.ORDER_PLACED_DTTM <= to_date(?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_SOLD_DTTM >= to_date( ? , 'DD-MON-YYYY') and ORDER_SOLD_DTTM <= to_date(?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE,OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME  ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME \"Category\",0 \"Yesterday\",sum(OM_ORDER_LINE.LINE_SOLD_AMOUNT) \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,OM_ORDER_LINE,OM_PRODUCT_CATEGORY_TYPE,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append(" OM_PRODUCT_CATEGORY_LVL1,OM_PRODUCT_CATEGORY_LVL2 ");
		query.append(" where OM_ORDER_LINE.sys_ORDER_ID=OM_ORDER.SYS_ORDER_ID  ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID ");
		query.append(" and OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE=? ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY')-195 and OM_ORDER.ORDER_PLACED_DTTM <= to_date(?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_SOLD_DTTM >= to_date( ? , 'DD-MON-YYYY') and ORDER_SOLD_DTTM <= to_date(?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE,OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME  ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DATE_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME \"Category\",0 \"Yesterday\",0 \"LstYrSmDay\",sum(OM_ORDER_LINE.LINE_SOLD_AMOUNT) \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,OM_ORDER_LINE,OM_PRODUCT_CATEGORY_TYPE,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append(" OM_PRODUCT_CATEGORY_LVL1,OM_PRODUCT_CATEGORY_LVL2 ");
		query.append(" where OM_ORDER_LINE.sys_ORDER_ID=OM_ORDER.SYS_ORDER_ID  ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID ");
		query.append(" and OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE=?  ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= TO_DATE(?, 'DD-MON-YYYY')-195 and OM_ORDER.ORDER_PLACED_DTTM <= to_date(?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" and ORDER_SOLD_DTTM >= to_date( ?, 'DD-MON-YYYY' ) and ORDER_SOLD_DTTM <= to_date(?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE,OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME  ");
		query.append(" ), ");
		query.append(" ALL_DAYS_TMP AS ( ");
		query.append(" select * from YESTERDAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DATE_TMP ");
		query.append(" ), ");
		query.append(" CHANNEL_BREAKUP_TMP AS (   ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Category\",\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\",  ");
		query.append(" 20 \"SORT_ORDER_CHNL\" ");
		query.append(" from ( ");
		query.append(" select ORDER_ORIGIN_TYPE, \"Category\", sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\" ");
		query.append(" from ALL_DAYS_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"Category\" ");
		query.append(" ) order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"Category\" ");
		query.append(" ), ");
		query.append(" CHANNEL_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE, '-----TOTAL-----' \"Category\" , sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\" ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ");
		query.append(" ),  ");
		query.append(" CATEGORY_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE ,\"Category\",  sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" group by \"SORTORDER2\", \"Category\" , ORDER_ORIGIN_TYPE ");
		query.append(" order by \"SORTORDER2\",\"Category\"  ");
		query.append(" ),   ");
		query.append(" TOTAL_AGGR_TMP AS (     ");
		query.append(" select '-----TOTAL-----' \"ORDER_ORIGIN_TYPE\",'---CATEGORY BREAKUP---' \"Category\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" 0 \"SORTORDER2\",5 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_AGGR_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"Category\"    ");
		query.append(" ), ");
		query.append(" ALL_DISPLAY_TMP AS (               ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Category\",\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",'AFFILIATE' from TOTAL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Category\",\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",'AFFILIATE' from CHANNEL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Category\", \"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",'AFFILIATE' from CATEGORY_AGGR_TMP       ");
		query.append(" ) ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Category\",\"SORTORDER2\",\"SORT_ORDER_CHNL\",\"SORT_ORDER_CHNL2\", ");
		query.append(" \"Yesterday\" \"Yesterday\", \"LstYrSmDay\" \"LstYrSmDay\",ROUND(\"SameDayYOY%\", 2) \"SameDayYOY%\", ");
		query.append(" \"LstYrSmDate\" \"LstYrSmDate\",ROUND(\"SameDateYOY%\", 2) \"SameDateYOY%\" from ALL_DISPLAY_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"SORT_ORDER_CHNL2\",\"Category\"  ");
		logger.info(" Finish execution getReport2GiftOrderSold() method in EmailReportQuery.class ");
		return query.toString();
	}

	public static String getReport2GiftOrderPlacedCount() {
		logger.info(" Start execution getReport2GiftOrderPlacedCount() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" WITH ");
		query.append(" YESTERDAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME \"Category\",count(1) \"Yesterday\",0 \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,OM_ORDER_LINE,OM_PRODUCT_CATEGORY_TYPE,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append(" OM_PRODUCT_CATEGORY_LVL1,OM_PRODUCT_CATEGORY_LVL2 ");
		query.append(" where OM_ORDER_LINE.SYS_ORDER_ID=OM_ORDER.SYS_ORDER_ID  ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID ");
		query.append(" and OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE=?  ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= to_date( ?, 'DD-MON-YYYY' ) and OM_ORDER.ORDER_PLACED_DTTM <= to_date(?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE,OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME  ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DAY_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME \"Category\",0 \"Yesterday\",count(1) \"LstYrSmDay\",0 \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,OM_ORDER_LINE,OM_PRODUCT_CATEGORY_TYPE,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append(" OM_PRODUCT_CATEGORY_LVL1,OM_PRODUCT_CATEGORY_LVL2 ");
		query.append(" where OM_ORDER_LINE.SYS_ORDER_ID=OM_ORDER.SYS_ORDER_ID  ");
		query.append("	and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID ");
		query.append(" and OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE=?  ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= to_date( ? , 'DD-MON-YYYY') and OM_ORDER.ORDER_PLACED_DTTM <= to_date(?, 'DD-MON-YYYY HH:MI:SS AM')");
		query.append(" group by ORDER_ORIGIN_TYPE,OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME  ");
		query.append(" ), ");
		query.append(" LAST_YR_SAME_DATE_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME \"Category\",0 \"Yesterday\",0 \"LstYrSmDay\",count(1) \"LstYrSmDate\" ");
		query.append(" from OM_ORDER,OM_ORDER_LINE,OM_PRODUCT_CATEGORY_TYPE,OM_PRODUCT_PROD_CAT_ASSOC, ");
		query.append(" OM_PRODUCT_CATEGORY_LVL1,OM_PRODUCT_CATEGORY_LVL2 ");
		query.append(" where OM_ORDER_LINE.SYS_ORDER_ID=OM_ORDER.SYS_ORDER_ID  ");
		query.append("	 and OM_ORDER.ORDER_PLACED_DTTM = OM_ORDER_LINE.ORDER_PLACED_DTTM ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_ID=OM_ORDER_LINE.SYS_PRODUCT_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_CATEGORY_TYPE_ID=OM_PRODUCT_CATEGORY_TYPE.SYS_PRODUCT_CATEGORY_TYPE_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL1_ID=OM_PRODUCT_CATEGORY_LVL1.SYS_PRODUCT_CATEGORY_LVL1_ID ");
		query.append(" and OM_PRODUCT_PROD_CAT_ASSOC.SYS_PRODUCT_CATEGORY_LVL2_ID=OM_PRODUCT_CATEGORY_LVL2.SYS_PRODUCT_CATEGORY_LVL2_ID ");
		query.append(" and OM_PRODUCT_CATEGORY_TYPE.PRODUCT_CATEGORY_TYPE=?  ");
		query.append(" and OM_ORDER.ORDER_PLACED_DTTM >= to_date( ? , 'DD-MON-YYYY') and OM_ORDER.ORDER_PLACED_DTTM <= to_date(?, 'DD-MON-YYYY HH:MI:SS AM') ");
		query.append(" group by ORDER_ORIGIN_TYPE,OM_PRODUCT_CATEGORY_LVL2.CATEGORY_NAME  ");
		query.append(" ), ");
		query.append(" ALL_DAYS_TMP AS ( ");
		query.append(" select * from YESTERDAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DAY_TMP ");
		query.append(" union ");
		query.append(" select * from LAST_YR_SAME_DATE_TMP ");
		query.append(" ), ");
		query.append(" CHANNEL_BREAKUP_TMP AS (   ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Category\",\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" CASE ORDER_ORIGIN_TYPE WHEN 'Kiosk' THEN 5 WHEN 'Internet' THEN 10 WHEN 'Mobile' THEN 15 ELSE 20 END \"SORTORDER2\",  ");
		query.append(" 20 \"SORT_ORDER_CHNL\" ");
		query.append(" from ( ");
		query.append(" select ORDER_ORIGIN_TYPE, \"Category\", sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\" ");
		query.append(" from ALL_DAYS_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"Category\" ");
		query.append(" ) order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"Category\" ");
		query.append(" ), ");
		query.append(" CHANNEL_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE,'-----TOTAL-----' \"Category\" , sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" group by ORDER_ORIGIN_TYPE,\"SORTORDER2\" ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE ");
		query.append(" ), ");
		query.append(" CATEGORY_AGGR_TMP AS ( ");
		query.append(" select ORDER_ORIGIN_TYPE ,\"Category\",  sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\", 10 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_BREAKUP_TMP ");
		query.append(" group by \"SORTORDER2\", \"Category\" , ORDER_ORIGIN_TYPE ");
		query.append(" order by \"SORTORDER2\",\"Category\"  ");
		query.append(" ),  	 ");
		query.append(" TOTAL_AGGR_TMP AS (     ");
		query.append(" select '-----TOTAL-----' \"ORDER_ORIGIN_TYPE\",'---CATEGORY BREAKUP---' \"Category\",sum(\"Yesterday\") \"Yesterday\", sum(\"LstYrSmDay\") \"LstYrSmDay\", ");
		query.append(" case sum(\"LstYrSmDay\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDay\"))/sum(\"LstYrSmDay\")) END \"SameDayYOY%\", ");
		query.append(" sum(\"LstYrSmDate\") \"LstYrSmDate\", ");
		query.append(" case sum(\"LstYrSmDate\") WHEN 0 THEN 0 ELSE (100*(sum(\"Yesterday\") - sum(\"LstYrSmDate\"))/sum(\"LstYrSmDate\")) END \"SameDateYOY%\", ");
		query.append(" 0 \"SORTORDER2\",5 \"SORT_ORDER_CHNL\" ");
		query.append(" from CHANNEL_AGGR_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"Category\"    ");
		query.append(" ), ");
		query.append(" ALL_DISPLAY_TMP AS (               ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Category\",\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",'AFFILIATE' from TOTAL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Category\",\"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",'AFFILIATE' from CHANNEL_AGGR_TMP ");
		query.append(" union ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Category\", \"Yesterday\", \"LstYrSmDay\",\"SameDayYOY%\",\"LstYrSmDate\",\"SameDateYOY%\", ");
		query.append(" \"SORTORDER2\",\"SORT_ORDER_CHNL\",0 \"SORT_ORDER_CHNL2\",'AFFILIATE' from CATEGORY_AGGR_TMP      ");
		query.append(" ) ");
		query.append(" select ORDER_ORIGIN_TYPE,\"Category\",\"SORTORDER2\",\"SORT_ORDER_CHNL\",\"SORT_ORDER_CHNL2\", ");
		query.append(" \"Yesterday\" \"Yesterday\", \"LstYrSmDay\" \"LstYrSmDay\",round(\"SameDayYOY%\", 2) \"SameDayYOY%\", ");
		query.append(" \"LstYrSmDate\" \"LstYrSmDate\",ROUND(\"SameDateYOY%\", 2) \"SameDateYOY%\" from ALL_DISPLAY_TMP ");
		query.append(" order by \"SORTORDER2\",ORDER_ORIGIN_TYPE,\"SORT_ORDER_CHNL2\",\"Category\"  ");
		logger.info(" Finish execution getReport2GiftOrderPlacedCount() method in EmailReportQuery.class ");
		return query.toString();
	}
	
	public static String getEmailReportData() {
		logger.info(" Start execution getEmailReportData() method in EmailReportQuery.class ");
		StringBuffer query = new StringBuffer();
		query.append(" SELECT R.SYS_REPORT_ID,R.REPORT_NAME,E.EMAIL_ID,E.EMAIL_TYPE,E.SYS_REPORT_EMAIL_CONFIG_ID FROM");
		query.append(" OM_REPORT R INNER JOIN OM_REPORT_EMAIL_CONFIG E ON R.SYS_REPORT_ID=E.SYS_REPORT_ID");
		query.append(" WHERE R.ACTIVE_CD=1 AND E.ACTIVE_CD =1 AND R.REPORT_NAME = ?");
		logger.info(" Finish execution getEmailReportData() method in EmailReportQuery.class ");
		return query.toString();
	}

}
